<!DOCTYPE html>
<html>
<head>
<title>JZZ.input.Kbd</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<style type="text/css">
span {display:inline-block;}
.center {text-align:center;}
.middle {vertical-align:middle;}
.inner {position:absolute; bottom:0; left:0; width:100%;}
</style>
<script src="../javascript/JZZ.js"></script>
<script src="../javascript/JZZ.synth.OSC.js"></script>
<script src="../javascript/JZZ.input.Kbd.js"></script>
</head>

<body>
<h1>JZZ.input.Kbd</h1>

<div id=resp class=center></div>

<div class=center>
<span id=left class=middle></span>
<span class=middle>
<div id=top></div>
<div id=bottom></div>
</span>
<span id=right class=middle></span>
</div>

<div class=center>
<svg width="400" height="200" viewBox="0 0 400 200" stroke="#000" stroke-width="1" fill="#fff">
<polygon id="c5" points="140 10, 5 170, 63 197, 160 20" />
<polygon id="d5" points="160 20, 78 170, 137 182, 180 22" />
<polygon id="e5" points="180 22, 142 165, 194 167, 204 28" />
<polygon id="f5" points="204 28, 195 151, 248 145, 227 33" />
<polygon id="g5" points="227 33, 246 136, 303 122, 253 34" />
<polygon id="a5" points="253 34, 297 111, 346 88, 282 28" />
<polygon id="b5" points="282 28, 340 83, 390 56, 303 22" />
<polygon id="db5" points="160 9, 92 109, 123 119, 169 14" />
<polygon id="eb5" points="175 20, 140 117, 168 120, 187 22" />
<polygon id="gb5" points="221 28, 222 94, 252 88, 231 29"  />
<polygon id="ab5" points="242 27, 266 82, 286 71, 255 26" />
<polygon id="bb5" points="275 28, 301 62, 324 50, 285 24" />
This browser does not support SVG!
</svg>
</div>

<script><!--
JZZ.synth.OSC.register('Web Audio');
var output = JZZ().openMidiOut(/^((?!Midi Through).)*$/i);
JZZ.input.Kbd.register('kbd', {parent:'resp', from:'C5', 0:{to:'B6'}, 740:{to:'E7'}, 900:{to:'B7'} });
JZZ().openMidiIn('kbd')
     .or(function(){ alert('Cannot open MIDI In!\n' + this.err()); })
     .connect(output);
JZZ.input.Kbd({parent:'left', pos:'E', wl:100, bl:60, from:'C5', to:'B5'})
     .or(function(){ alert('Cannot open MIDI In!\n' + this.err()); })
     .and(function(){
       this.getKeys().setStyle({borderColor:'#00f', borderTopLeftRadius:'8px', borderBottomLeftRadius:'8px'});
       this.getWhiteKeys().setStyle({backgroundColor:'#fed'}, {backgroundColor:'#dbf'});
       this.getBlackKeys().setStyle({backgroundColor:'#d0f'}, {backgroundColor:'#dbf'});
      })
     .connect(output);
JZZ.input.Kbd({parent:'right', pos:'W', ww:21, bw:12, from:'C5', to:'B6'})
     .or(function(){ alert('Cannot open MIDI In!\n' + this.err()); })
     .and(function(){
       this.getKeys().setStyle({borderColor:'#888', borderTopRightRadius:'5px', borderBottomRightRadius:'5px'});
       this.getWhiteKeys('C5', 'B5').setStyle({backgroundColor:'#e00'}, {});
       this.getBlackKeys('C5', 'B5').setStyle({backgroundColor:'#fff'}, {});
      })
     .connect(output);
JZZ.input.Kbd({parent:'top', pos:'N', from:'C5', to:'B5', rev:true})
     .or(function(){ alert('Cannot open MIDI In!\n' + this.err()); })
     .and(function() {
       this.getKey('C5').setInnerHTML('<span class=inner>C</span>');
       this.getKey('D5').setInnerHTML('<span class=inner>D</span>');
       this.getKey('E5').setInnerHTML('<span class=inner>E</span>');
       this.getKey('F5').setInnerHTML('<span class=inner>F</span>');
       this.getKey('G5').setInnerHTML('<span class=inner>G</span>');
       this.getKey('A5').setInnerHTML('<span class=inner>A</span>');
       this.getKey('B5').setInnerHTML('<span class=inner>B</span>');
       this.getKey('C#5').setStyle({backgroundColor:'#f00'}, {});
       this.getKey('D#5').setStyle({backgroundColor:'#ff0'}, {});
       this.getKey('F#5').setStyle({backgroundColor:'#0f0'}, {});
       this.getKey('G#5').setStyle({backgroundColor:'#00f'}, {});
       this.getKey('A#5').setStyle({backgroundColor:'#a0c'}, {});
     })
     .connect(output);
JZZ.input.Kbd({parent:'bottom', pos:'S', wl:126, bl:80, from:'C5', to:'B5'})
     .or(function(){ alert('Cannot open MIDI In!\n' + this.err()); })
     .and(function() {
       this.getWhiteKeys().setStyle({backgroundImage:'url("bgw.png")'}, {backgroundImage:'url("bg1.png")'});
       this.getBlackKeys().setStyle({backgroundImage:'url("bgb.png")'}, {backgroundImage:'url("bg1.png")'});
       this.getKey('B5').setStyle({ backgroundPosition:'-1px'});
       this.getKey('A5').setStyle({ backgroundPosition:'-43px'});
       this.getKey('G5').setStyle({ backgroundPosition:'-85px'});
       this.getKey('F5').setStyle({ backgroundPosition:'-127px'});
       this.getKey('E5').setStyle({ backgroundPosition:'-169px'});
       this.getKey('D5').setStyle({ backgroundPosition:'-211px'});
       this.getKey('C5').setStyle({ backgroundPosition:'-253px'});
       this.getKey('Bb5').setStyle({ backgroundPosition:'-24px -46px'});
       this.getKey('Ab5').setStyle({ backgroundPosition:'-72px -46px'});
       this.getKey('F#5').setStyle({ backgroundPosition:'-120px -46px'});
       this.getKey('Eb5').setStyle({ backgroundPosition:'-195px -46px'});
       this.getKey('C#5').setStyle({ backgroundPosition:'-243px -46px'});
     })
     .connect(output);
JZZ.input.Kbd({keys:[
  ['c5', 'c5'], ['db5', 'db5'], ['d5', 'd5'], ['eb5', 'eb5'], ['e5', 'e5'], ['f5', 'f5'],
  ['gb5', 'gb5'], ['g5', 'g5'], ['ab5', 'ab5'], ['a5', 'a5'], ['bb5', 'bb5'], ['b5', 'b5']
], onCreate:function(){
  this.getWhiteKeys().setStyle({fill:'#fff'}, {fill:'#ccc'});
  this.getBlackKeys().setStyle({fill:'#000'}, {fill:'#ccc'});
}}).or(function(){ alert('Cannot open MIDI In!\n' + this.err()); }).connect(output);

--></script>

</body>
</html>
