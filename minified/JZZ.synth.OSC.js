!function(){function a(){this.channels=[],this.channel=function(a){return this.channels[a]||(this.channels[a]=new b),this.channels[a]},this.play=function(a){var b=a[0],c=a[1],d=a[2];if(!(0>b||b>255)){var e=15&b,f=b>>4;9==f?this.channel(e).play(c,d):8==f?this.channel(e).play(c,0):11==f&&(120==c||123==c?this.channel(e).allSoundOff():64==c&&this.channel(e).damper(!!d))}}}function b(){this.notes=[],this.sustain=!1,this.note=function(a){return this.notes[a]||(this.notes[a]=new c(a,this)),this.notes[a]},this.play=function(a,b){this.note(a).play(b)},this.allSoundOff=function(){for(var a=0;a<this.notes.length;a++)this.notes[a]&&this.notes[a].stop()},this.damper=function(a){if(!a&&this.sustain!=a)for(var b=0;b<this.notes.length;b++)this.notes[b]&&this.notes[b].sustain&&this.notes[b].stop();this.sustain=a}}function c(a,b){this.note=a,this.channel=b,this.freq=440*Math.pow(2,(a-69)/12),this.stop=function(){try{this.oscillator&&this.oscillator.stop(0),this.oscillator=void 0,this.sustain=!1}catch(a){}},this.play=function(a){if(!a&&this.channel.sustain||this.stop(),!a)return void(this.sustain=this.channel.sustain);var b=a/127;this.oscillator=d.createOscillator(),this.oscillator.type="sawtooth",this.oscillator.frequency.setTargetAtTime(this.freq,d.currentTime,.01),this.oscillator.start||(this.oscillator.start=this.oscillator.noteOn),this.oscillator.stop||(this.oscillator.stop=this.oscillator.noteOff),this.gain=d.createGain();var c=2,e=d.currentTime;this.gain.gain.setValueAtTime(b,e),this.gain.gain.exponentialRampToValueAtTime(.01*b,e+c),this.oscillator.connect(this.gain),this.gain.connect(d.destination),this.oscillator.start(0)}}if(JZZ){JZZ.synth||(JZZ.synth={});var d=JZZ.lib.getAudioContext(),e={},f={};f._info=function(a){return a||(a="JZZ.synth.OSC"),{type:"Web Audo",name:a,manufacturer:"virtual",version:"0.4"}},f._openOut=function(b,c){return d?(e[c]||(e[c]=new a),b._info=f._info(c),b._receive=function(a){e[c].play(a)},void b._resume()):void b._crash("AudioContext not supported")},JZZ.synth.OSC=function(a){return JZZ.lib.openMidiOut(a,f)},JZZ.synth.OSC.register=function(a){return d?JZZ.lib.registerMidiOut(a,f):!1}}}();