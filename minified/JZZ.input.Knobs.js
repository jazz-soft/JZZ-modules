!function(){function a(a,b){return a?a:b}function b(a){var b={};for(var c in a)b[c]=a[c];return b}function c(a){return void 0===a.buttons?!a.button:1&a.buttons}function d(a){return void 0===a.buttons?!a.button:!(1&a.buttons)}function e(){return!1}function f(a,b){for(var c in b)a.style[c]=b[c]}function g(a){var c=this;this.bins=[],this.params={0:{}};var d={from:"C4",to:"E6",ww:42,bw:24,wl:150,bl:100,pos:"N"};void 0===a&&(a={}),this.channel=r[a.channel],void 0===this.channel&&(this.channel=0);var e;for(e in a)if(e==parseInt(e))this.params[e]=b(a[e]);else{if("channel"==e)continue;if(("from"==e||"to"==e)&&void 0===_keyNum(a[e]))continue;d[e]=a[e]}for(e in this.params){this.bins.push(e);for(var f in d)"from"!=f&&"to"!=f||void 0!==_keyNum(this.params[e][f])||(this.params[e][f]=d[f]),f in this.params[e]||(this.params[e][f]=d[f]);var g=this.params[e].from,h=this.params[e].to;_keyNum(g)>_keyNum(h)&&(this.params[e].from=h,this.params[e].to=g)}this.bins.sort(function(a,b){return a-b}),this._close=function(){for(var a in c.playing)"M"!=c.playing[a]&&"T"!=c.playing[a]||c.noteOff(a);c.parent&&(c.parent.innerHTML=""),window.removeEventListener("mouseup",c.mouseUpHandler)}}function h(a){this.piano=a,this.keys=[]}function i(a){if(this.base=.5,this.val=.5,this["int"]=8192,this.msb=0,this.lsb=0,this.chan=0,a instanceof Array){if(1!=a.length&&2!=a.length)return;if(2==a.length){if(a[1]!=parseInt(a[1])||a[1]<1||a[1]>127)return;this.msb=a[0],a[1]!=a[0]&&(this.lsb=a[1])}else this.msb=a[0]}else if(a==parseInt(a)){if(1>a||a>127)return;this.msb=a}else{var b={mod:[1,33],breath:[2,34],foot:[4,36],portamento:[5,37],volume:[7,39],balance:[8,40],pan:[10,42],expression:[11,43],effect1:[12,44],effect2:[13,45]}[a];b&&(this.msb=b[0],this.lsb=b[1])}this.msb&&7!=this.msb&&8!=this.msb&&10!=this.msb&&(this.base=0),this.val=-1,this.setValue(this.base)}function j(){}function k(a,c){this.bins=[],this.params={0:{}},void 0===a&&(a={}),void 0===c&&(c={}),this.channel=r[a.channel],void 0===this.channel&&(this.channel=0);var d;for(d in a)if(d==parseInt(d))this.params[d]=b(a[d]);else{if("channel"==d)continue;c[d]=a[d]}for(d in this.params){this.bins.push(d);for(var e in c)"from"!=e&&"to"!=e||void 0!==_keyNum(this.params[d][e])||(this.params[d][e]=c[e]),e in this.params[d]||(this.params[d][e]=c[e])}this.bins.sort(function(a,b){return a-b})}function l(a){return function(b){c(b)&&a.onMouseDown(b)}}function m(a){return function(b){a.onMouseMove(b)}}function n(a){return function(b){d(b)&&(window.removeEventListener("mousemove",a.mouseMove),window.removeEventListener("mouseup",a.mouseUp),a.dragX=void 0,a.onMouseUp(b))}}function o(a){k.call(this,a,{pos:"N",rw:2,rh:128,kw:24,kh:16})}function p(){}if(JZZ){JZZ.input||(JZZ.input={});for(var q="0.1",r={a:10,b:11,c:12,d:13,e:14,f:15,A:10,B:11,C:12,D:13,E:14,F:15},s=0;16>s;s++)r[s]=s;g.prototype.onResize=function(){for(var a=0,b=0;b<this.bins.length&&this.bins[b]<=window.innerWidth;b++)a=this.bins[b];this.current!=this.params[a]&&(this.current=this.params[a],this.createCurrent())},g.prototype.getKey=function(a){var b=new h(this),c=JZZ.MIDI.noteValue(a);return void 0!==this.keys[c]&&b.keys.push(c),b},g.prototype.getKeys=function(a,b){var c=new h(this),d=void 0===a?void 0:JZZ.MIDI.noteValue(a),e=void 0===b?void 0:JZZ.MIDI.noteValue(b);if(void 0!==d&&void 0!==e&&d>e){var f=d;d=e,e=f}for(var g in this.keys)void 0!==d&&d>g||void 0!==e&&g>e||c.keys.push(g);return c},h.prototype.setInnerHTML=function(a){for(var b in this.keys)this.piano.keys[this.keys[b]].innerHTML=a;return this},h.prototype.setStyle=function(a,b){void 0===b&&(b=a);for(var c in this.keys){var d=this.keys[c];for(var e in a)this.piano.stl0[d][e]=a[e];for(var e in b)this.piano.stl1[d][e]=b[e];f(this.piano.keys[d],this.piano.playing[d]?this.piano.stl1[d]:this.piano.stl0[d]),f(this.piano.keys[d],this.piano.locs[d])}return this},i.prototype.setBase=function(a){a=parseFloat(a),!isNaN(a)&&isFinite(a)&&a>=0&&1>=a&&(this.base=a)},i.prototype.setValue=function(a){return a=parseFloat(a),isNaN(a)||!isFinite(a)||0>a||a>1||a==this.val?void 0:(this.val=a,this.num=Math.round(a*(this.lsb||!this.msb?16383:127)),!0)},i.prototype.emit=function(a){this.msb?this.lsb?(a.emit([176+this.chan,this.msb,this.num>>7]),a.emit([176+this.chan,this.lsb,127&this.num])):a.emit([176+this.chan,this.msb,this.num]):a.emit([224+this.chan,127&this.num,this.num>>7])},i.prototype.read=function(a){if(!this.msb&&a[0]==224+this.chan&&a[1]==parseInt(a[1])&&a[2]==parseInt(a[2]))return this.num=a[2]<<7|127&a[1],this.val=this.num/16383,!0;if(this.msb&&a[0]==176+this.chan&&a[2]==parseInt(a[2])){if(a[1]==this.msb)return this.lsb?(this.num=a[2]<<7|127&this.num,this.val=this.num/16383):(this.num=127&a[2],this.val=this.num/127),!0;if(a[1]==this.lsb)return this.num=16256&this.num|127&a[2],this.val=this.num/16383,!0;out.emit([176+this.chan,this.msb,this.num>>7]),out.emit([176+this.chan,this.lsb,127&this.num])}},j.prototype._close=function(){this.parent&&(this.parent.innerHTML=""),this.mouseUpHandler&&window.removeEventListener("mouseup",this.mouseUpHandler)},j.prototype.create=function(){for(var a=0,b=0;b<this.bins.length&&this.bins[b]<=window.innerWidth;b++)a=this.bins[b];this.current=this.params[a],this.createCurrent()},j.prototype.createCurrent=function(){this.parent&&(this.parent.innerHTML=""),"string"==typeof this.current.parent&&(this.current.parent=document.getElementById(this.current.parent));try{this.createAt(this.current.parent)}catch(a){this.bottom||(this.bottom=document.createElement("div"),document.body.appendChild(this.bottom)),this.createAt(this.bottom)}},j.prototype.onMouseDown=function(a){void 0===this.dragX&&(this.dragX=a.clientX,this.dragY=a.clientY,this.mouseMove=m(this),this.mouseUp=n(this),window.addEventListener("mousemove",this.mouseMove),window.addEventListener("mouseup",this.mouseUp))},j.prototype.onMouseUp=function(a){},o.prototype=new j,o.prototype.createAt=function(a){a.innerHTML="";var b=parseInt(this.current.bh),c=parseInt(this.current.bw),d=parseInt(this.current.rh);d||(d=127),this.rh=d;var f=parseInt(this.current.rw);f||(f=2);var g=parseInt(this.current.kh);g||(g=24);var h=parseInt(this.current.kw);h||(h=16);var j=this.current.pos.toUpperCase();this.pos=j,this.data||(this.data=new i(this.current.data),this.data.setBase(this.current.base),this.data.setValue(this.current.val)),this.dx=-(h/2),this.dy=-(g/2+1),b||(b=g+d),c||(c=h>f?h:f);var k=document.createElement("span");k.style.display="inline-block",k.style.position="relative",k.style.margin="0px",k.style.padding="0px",k.style.borderStyle="none",k.style.userSelect="none",k.style.KhtmlUserSelect="none",k.style.MozUserSelect="none",k.style.MsUserSelect="none",k.style.OUserSelect="none",k.style.WebkitUserSelect="none";var m=document.createElement("span");m.style.display="inline-block",m.style.position="absolute",m.style.margin="0px",m.style.padding="0px",m.style.borderStyle="solid",m.style.borderWidth="1px",m.style.backgroundColor="#aaa";var n=document.createElement("span");n.style.display="inline-block",n.style.position="absolute",n.style.margin="0px",n.style.padding="0px",n.style.borderStyle="solid",n.style.borderWidth="1px",n.style.backgroundColor="#ddd",this.knob=n,n.addEventListener("mousedown",l(this)),"E"==j||"W"==j?(k.style.width=b+"px",k.style.height=c+"px",m.style.width=d+"px",m.style.height=f+"px",m.style.left=(b-d)/2-1+"px",m.style.top=(c-f)/2-1+"px",n.style.width=g+"px",n.style.height=h+"px",n.style.top=this.dx+"px"):(k.style.width=c+"px",k.style.height=b+"px",m.style.width=f+"px",m.style.height=d+"px",m.style.top=(b-d)/2-1+"px",m.style.left=(c-f)/2-1+"px",n.style.width=h+"px",n.style.height=g+"px",n.style.left=this.dx+"px"),this.setValue(this.value),this.current.onCreate&&this.current.onCreate.apply(this),m.appendChild(n),k.appendChild(m),k.ondragstart=e,k.onselectstart=e,m.ondragstart=e,m.onselectstart=e,n.ondragstart=e,n.onselectstart=e,a.appendChild(k),this.current.parent=a,this.parent=a,this.setValue()},o.prototype.setValue=function(a){if(void 0===a)a=this.data.val;else if(!this.data.setValue(a))return;a=this.data.val,"N"!=this.pos&&"W"!=this.pos||(a=1-a),a*=this.rh,this.coord=a,a+=this.dy,"N"==this.pos||"S"==this.pos?this.knob.style.top=a+"px":this.knob.style.left=a+"px"},o.prototype.onMouseMove=function(a){var b;b="N"==this.pos||"S"==this.pos?this.coord+a.clientY-this.dragY:this.coord+a.clientX-this.dragX,0>b&&(b=0),b>this.rh&&(b=this.rh),this.move(b)},o.prototype.move=function(a){if(this.coord!=a){"N"==this.pos||"S"==this.pos?(this.knob.style.top=a+this.dy+"px",this.dragY+=a-this.coord):(this.knob.style.left=a+this.dy+"px",this.dragX+=a-this.coord);var b=a/this.rh;"N"!=this.pos&&"W"!=this.pos||(b=1-b),this.data.setValue(b)&&this.data.emit(this),this.coord=a}},o.prototype.forward=function(a){this.emit(a),this.data.read(a)&&this.setValue()},p.prototype._info=function(b){return{type:"html/javascript",name:a(b,"Slider"),manufacturer:"virtual",version:q}},p.prototype._openIn=function(a,b){var c=new o(this._arg);c.create(),c.emit=function(b){a._emit(b)},a._info=this._info(b),a._receive=function(a){c.forward(a)},a._close=function(){c._close()},a.setValue=function(a){c.setValue(a)},a._resume()},JZZ.input.Slider=function(){var a,b;1==arguments.length?"string"==typeof arguments[0]?a=arguments[0]:b=arguments[0]:(a=arguments[0],b=arguments[1]);var c=new p;return c._arg=b,JZZ.lib.openMidiIn(a,c)},JZZ.input.Slider.register=function(){var a,b;1==arguments.length?"string"==typeof arguments[0]?a=arguments[0]:b=arguments[0]:(a=arguments[0],b=arguments[1]);var c=new p;return c._arg=b,JZZ.lib.registerMidiIn(a,c)}}}();