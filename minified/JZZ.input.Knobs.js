!function(){function a(a,b){return a?a:b}function b(a){var b={};for(var c in a)b[c]=a[c];return b}function c(a){return void 0===a.buttons?!a.button:1&a.buttons}function d(a){return void 0===a.buttons?!a.button:!(1&a.buttons)}function e(){return!1}function f(a){if(this.base=.5,this.val=.5,this["int"]=8192,this.msb=0,this.lsb=0,this.chan=0,a instanceof Array){if(1!=a.length&&2!=a.length)return;if(2==a.length){if(a[1]!=parseInt(a[1])||a[1]<1||a[1]>127)return;this.msb=a[0],a[1]!=a[0]&&(this.lsb=a[1])}else this.msb=a[0]}else if(a==parseInt(a)){if(1>a||a>127)return;this.msb=a}else{var b={mod:[1,33],breath:[2,34],foot:[4,36],portamento:[5,37],volume:[7,39],balance:[8,40],pan:[10,42],expression:[11,43],effect1:[12,44],effect2:[13,45]}[a];b&&(this.msb=b[0],this.lsb=b[1])}this.msb&&7!=this.msb&&8!=this.msb&&10!=this.msb&&(this.base=0),this.val=-1,this.setValue(this.base)}function g(){}function h(a,c){this.bins=[],this.params={0:{}},void 0===a&&(a={}),void 0===c&&(c={}),this.channel=s[a.channel],void 0===this.channel&&(this.channel=0);var d;for(d in a)if(d==parseInt(d))this.params[d]=b(a[d]);else{if("channel"==d)continue;c[d]=a[d]}for(d in this.params){this.bins.push(d);for(var e in c)"from"!=e&&"to"!=e||void 0!==_keyNum(this.params[d][e])||(this.params[d][e]=c[e]),e in this.params[d]||(this.params[d][e]=c[e])}this.bins.sort(function(a,b){return a-b})}function i(a){return function(b){c(b)&&a.onMouseDown(b)}}function j(a){return function(b){a.onMouseMove(b)}}function k(a){return function(b){d(b)&&(window.removeEventListener("mousemove",a.mouseMove),window.removeEventListener("mouseup",a.mouseUp),a.dragX=void 0,a.onMouseUp(b))}}function l(a){return function(b){a.onTouchStart(b)}}function m(a){return function(b){a.onTouchMove(b)}}function n(a){return function(b){a.onTouchEnd(b)}}function o(a){a.preventDefault()}function p(a){h.call(this,a,{pos:"N",rw:2,rh:128,kw:24,kh:16})}function q(){}if(JZZ){JZZ.input||(JZZ.input={});for(var r="0.1",s={a:10,b:11,c:12,d:13,e:14,f:15,A:10,B:11,C:12,D:13,E:14,F:15},t=0;16>t;t++)s[t]=t;f.prototype.setBase=function(a){a=parseFloat(a),!isNaN(a)&&isFinite(a)&&a>=0&&1>=a&&(this.base=a)},f.prototype.setValue=function(a){return a=parseFloat(a),isNaN(a)||!isFinite(a)||0>a||a>1||a==this.val?void 0:(this.val=a,this.num=Math.round(a*(this.lsb||!this.msb?16383:127)),!0)},f.prototype.emit=function(a){this.msb?this.lsb?(a.emit([176+this.chan,this.msb,this.num>>7]),a.emit([176+this.chan,this.lsb,127&this.num])):a.emit([176+this.chan,this.msb,this.num]):a.emit([224+this.chan,127&this.num,this.num>>7])},f.prototype.read=function(a){if(!this.msb&&a[0]==224+this.chan&&a[1]==parseInt(a[1])&&a[2]==parseInt(a[2]))return this.num=a[2]<<7|127&a[1],this.val=this.num/16383,!0;if(this.msb&&a[0]==176+this.chan&&a[2]==parseInt(a[2])){if(a[1]==this.msb)return this.lsb?(this.num=a[2]<<7|127&this.num,this.val=this.num/16383):(this.num=127&a[2],this.val=this.num/127),!0;if(a[1]==this.lsb)return this.num=16256&this.num|127&a[2],this.val=this.num/16383,!0;out.emit([176+this.chan,this.msb,this.num>>7]),out.emit([176+this.chan,this.lsb,127&this.num])}},g.prototype._close=function(){this.parent&&(this.parent.innerHTML=""),this.mouseUpHandler&&window.removeEventListener("mouseup",this.mouseUpHandler)},g.prototype.create=function(){for(var a=0,b=0;b<this.bins.length&&this.bins[b]<=window.innerWidth;b++)a=this.bins[b];this.current=this.params[a],this.createCurrent()},g.prototype.createCurrent=function(){this.parent&&(this.parent.innerHTML=""),"string"==typeof this.current.parent&&(this.current.parent=document.getElementById(this.current.parent));try{this.createAt(this.current.parent)}catch(a){this.bottom||(this.bottom=document.createElement("div"),document.body.appendChild(this.bottom)),this.createAt(this.bottom)}},g.prototype.onResize=function(){for(var a=0,b=0;b<this.bins.length&&this.bins[b]<=window.innerWidth;b++)a=this.bins[b];this.current!=this.params[a]&&(this.current=this.params[a],this.createCurrent())},g.prototype.onMouseDown=function(a){void 0===this.dragX&&(this.dragX=a.clientX,this.dragY=a.clientY,this.mouseMove=j(this),this.mouseUp=k(this),window.addEventListener("mousemove",this.mouseMove),window.addEventListener("mouseup",this.mouseUp))},g.prototype.onMouseMove=function(a){void 0!==this.dragX&&this.onMove(a.clientX,a.clientY)},g.prototype.onMouseUp=function(a){},g.prototype.onTouchStart=function(a){a.preventDefault(),void 0===this.dragX&&(this.touch=a.targetTouches[0].identifier,this.dragX=a.targetTouches[0].clientX,this.dragY=a.targetTouches[0].clientY)},g.prototype.onTouchMove=function(a){if(a.preventDefault(),void 0!==this.dragX&&void 0!==this.touch)for(var b in a.targetTouches)if(a.targetTouches[0].identifier==this.touch)return void this.onMove(a.targetTouches[b].clientX,a.targetTouches[b].clientY)},g.prototype.onTouchEnd=function(a){a.preventDefault(),this.touch=void 0,this.dragX=void 0,this.onMouseUp(a)},p.prototype=new g,p.prototype.createAt=function(a){a.innerHTML="";var b=parseInt(this.current.bh),c=parseInt(this.current.bw),d=parseInt(this.current.rh);d||(d=127),this.rh=d;var g=parseInt(this.current.rw);g||(g=2);var h=parseInt(this.current.kh);h||(h=24);var j=parseInt(this.current.kw);j||(j=16);var k=this.current.pos.toUpperCase();this.pos=k,this.data||(this.data=new f(this.current.data),this.data.setBase(this.current.base),this.data.setValue(this.current.val)),this.dx=-(j/2),this.dy=-(h/2+1),b||(b=h+d),c||(c=j>g?j:g);var p=document.createElement("span");p.style.display="inline-block",p.style.position="relative",p.style.margin="0px",p.style.padding="0px",p.style.borderStyle="none",p.style.userSelect="none",p.style.KhtmlUserSelect="none",p.style.MozUserSelect="none",p.style.MsUserSelect="none",p.style.OUserSelect="none",p.style.WebkitUserSelect="none",p.addEventListener("touchstart",o);var q=document.createElement("span");q.style.display="inline-block",q.style.position="absolute",q.style.margin="0px",q.style.padding="0px",q.style.borderStyle="solid",q.style.borderWidth="1px",q.style.backgroundColor="#aaa";var r=document.createElement("span");r.style.display="inline-block",r.style.position="absolute",r.style.margin="0px",r.style.padding="0px",r.style.borderStyle="solid",r.style.borderWidth="1px",r.style.backgroundColor="#ddd",this.knob=r,r.addEventListener("mousedown",i(this)),r.addEventListener("touchstart",l(this)),r.addEventListener("touchmove",m(this)),r.addEventListener("touchend",n(this)),"E"==k||"W"==k?(p.style.width=b+"px",p.style.height=c+"px",q.style.width=d+"px",q.style.height=g+"px",q.style.left=(b-d)/2-1+"px",q.style.top=(c-g)/2-1+"px",r.style.width=h+"px",r.style.height=j+"px",r.style.top=this.dx+"px"):(p.style.width=c+"px",p.style.height=b+"px",q.style.width=g+"px",q.style.height=d+"px",q.style.top=(b-d)/2-1+"px",q.style.left=(c-g)/2-1+"px",r.style.width=j+"px",r.style.height=h+"px",r.style.left=this.dx+"px"),this.setValue(this.value),this.current.onCreate&&this.current.onCreate.apply(this),q.appendChild(r),p.appendChild(q),p.ondragstart=e,p.onselectstart=e,q.ondragstart=e,q.onselectstart=e,r.ondragstart=e,r.onselectstart=e,a.appendChild(p),this.current.parent=a,this.parent=a,this.setValue()},p.prototype.setValue=function(a){if(void 0===a)a=this.data.val;else if(!this.data.setValue(a))return;a=this.data.val,"N"!=this.pos&&"W"!=this.pos||(a=1-a),a*=this.rh,this.coord=a,a+=this.dy,"N"==this.pos||"S"==this.pos?this.knob.style.top=a+"px":this.knob.style.left=a+"px"},p.prototype.onMove=function(a,b){var c;c="N"==this.pos||"S"==this.pos?this.coord+b-this.dragY:this.coord+a-this.dragX,0>c&&(c=0),c>this.rh&&(c=this.rh),this.move(c)},p.prototype.move=function(a){if(this.coord!=a){"N"==this.pos||"S"==this.pos?(this.knob.style.top=a+this.dy+"px",this.dragY+=a-this.coord):(this.knob.style.left=a+this.dy+"px",this.dragX+=a-this.coord);var b=a/this.rh;"N"!=this.pos&&"W"!=this.pos||(b=1-b),this.data.setValue(b)&&this.data.emit(this),this.coord=a}},p.prototype.forward=function(a){this.emit(a),this.data.read(a)&&this.setValue()},q.prototype._info=function(b){return{type:"html/javascript",name:a(b,"Slider"),manufacturer:"virtual",version:r}},q.prototype._openIn=function(a,b){var c=new p(this._arg);c.create(),c.emit=function(b){a._emit(b)},a._info=this._info(b),a._receive=function(a){c.forward(a)},a._close=function(){c._close()},a.setValue=function(a){c.setValue(a)},a._resume()},JZZ.input.Slider=function(){var a,b;1==arguments.length?"string"==typeof arguments[0]?a=arguments[0]:b=arguments[0]:(a=arguments[0],b=arguments[1]);var c=new q;return c._arg=b,JZZ.lib.openMidiIn(a,c)},JZZ.input.Slider.register=function(){var a,b;1==arguments.length?"string"==typeof arguments[0]?a=arguments[0]:b=arguments[0]:(a=arguments[0],b=arguments[1]);var c=new q;return c._arg=b,JZZ.lib.registerMidiIn(a,c)}}}();