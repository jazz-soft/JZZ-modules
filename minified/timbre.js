!function(w){"use strict";function r(){return o.apply(null,arguments)}function o(){var t,e,i=h.call(arguments),s=i[0];switch(typeof s){case"string":u[s]?t=new u[s](i.slice(1)):l[s]?t=l[s](i.slice(1)):(e=/^(.+?)(?:\.(ar|kr))?$/.exec(s))&&(s=e[1],u[s]?t=new u[s](i.slice(1)):l[s]&&(t=l[s](i.slice(1))),t)&&e[2]&&t[e[2]]();break;case"number":t=new K(i);break;case"boolean":t=new $(i);break;case"function":t=new Y(i);break;case"object":if(null!==s){if(s instanceof v)return s;if(s.context instanceof v)return s.context;p(s)?t=new Q(i):f(s)&&(t=new H(i))}}t===w&&(t=new V(i.slice(1)),console.warn('T("'+s+'") is not defined.'));var n=t._;return n.originkey=s,n.meta=C(t),n.emit("init"),t}var q,h=Array.prototype.slice,B=[8e3,11025,12e3,16e3,22050,24e3,32e3,44100,48e3],E=[32,64,128,256],a=null,u={},l={},t="undefined"!=typeof window?"browser":"undefined"!=typeof module&&module.exports?"node":"unknown",c="browser"==t&&/(iPhone|iPad|iPod|Android)/i.test(navigator.userAgent),i=120,C=function(t){for(var e,i=t._.meta,s=t;null!==s&&s.constructor!==Object;){for(var n,r=0,a=(n=Object.getOwnPropertyNames(s)).length;r<a;++r)i[n[r]]||(/^(constructor$|process$|_)/.test(n[r])?i[n[r]]="ignore":"function"==typeof(e=Object.getOwnPropertyDescriptor(s,n[r])).value?i[n[r]]="function":(e.get||e.set)&&(i[n[r]]="property"));s=Object.getPrototypeOf(s)}return i};function n(t){var e=i;return e=(t=/^bpm(\d+(?:\.\d+)?)/i.exec(t))?Math.max(5,Math.min(300,+(t[1]||0))):e}Object.defineProperties(r,{version:{value:"14.10.12"},envtype:{value:t},envmobile:{value:c},env:{get:function(){return a.impl.env}},samplerate:{get:function(){return a.samplerate}},channels:{get:function(){return a.channels}},cellsize:{get:function(){return a.cellsize}},currentTime:{get:function(){return a.currentTime}},isPlaying:{get:function(){return 1===a.status}},isRecording:{get:function(){return 3===a.status}},amp:{set:function(t){"number"==typeof t&&(a.amp=t)},get:function(){return a.amp}},bpm:{set:function(t){"number"==typeof t&&5<=t&&t<=300&&(i=t)},get:function(){return i}}}),r.bind=function(t,e){return a.bind(t,e),r},r.setup=function(t){return a.setup(t),r},r.play=function(){return a.play(),r},r.pause=function(){return a.pause(),r},r.reset=function(){return a.reset(),a.events.emit("reset"),r},r.on=r.addListener=function(t,e){return a.on(t,e),r},r.once=function(t,e){return a.once(t,e),r},r.off=r.removeListener=function(t,e){return a.off(t,e),r},r.removeAllListeners=function(t){return a.removeAllListeners(t),r},r.listeners=function(t){return a.listeners(t)},r.rec=function(){return a.rec.apply(a,arguments)},r.timevalue=function(t){var e,i,s;if(e=/^(\d+(?:\.\d+)?)Hz$/i.exec(t))return 0==+e[1]?0:1e3/+e[1];if(e=/L(\d+)?(\.*)$/i.exec(t))return i=60/n(t)*(4/(e[1]||4))*1e3,i*=[1,1.5,1.75,1.875][(e[2]||"").length]||1;if(e=/^(\d+(?:\.\d+)?|\.(?:\d+))(min|sec|m)s?$/i.exec(t))switch(e[2]){case"min":return 60*+(e[1]||0)*1e3;case"sec":return 1e3*+(e[1]||0);case"m":return+(e[1]||0)}return(e=/^(?:([0-5]?[0-9]):)?(?:([0-5]?[0-9]):)(?:([0-5]?[0-9]))(?:\.([0-9]{1,3}))?$/.exec(t))?1e3*(s=3600*(e[1]||0)+60*(e[2]||0)+(e[3]||0))+(0|((e[4]||"")+"00").substr(0,3)):(e=/(\d+)\.(\d+)\.(\d+)$/i.exec(t))?(s=480*(4*e[1]+ +e[2])+ +e[3],60/n(t)*(s/480)*1e3):(e=/(\d+)ticks$/i.exec(t))?60/n(t)*(e[1]/480)*1e3:(e=/^(\d+)samples(?:\/(\d+)Hz)?$/i.exec(t))?1e3*e[1]/(e[2]||r.samplerate):0};var x=r.fn={SignalArray:Float32Array,currentTimeIncr:0,emptycell:null,FINISHED_STATE:0,PLAYING_STATE:1,UNSCHEDULED_STATE:2,SCHEDULED_STATE:3},f=x.isArray=Array.isArray,p=x.isDictionary=function(t){return"object"==typeof t&&t.constructor===Object},e=(x.nop=function(){return this},x.isSignalArray=function(t){return t instanceof x.SignalArray||!(!Array.isArray(t)||!t.__klass||2!==t.__klass.type)},x.extend=function(t,e){for(var i in e=e||v)e.hasOwnProperty(i)&&(t[i]=e[i]);function s(){this.constructor=t}return s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype,t},x.constructorof=function(t,e){for(var i=t&&t.prototype;i;){if(i===e.prototype)return!0;i=Object.getPrototypeOf(i)}return!1},x.register=function(t,e){x.constructorof(e,v)?u[t]=e:l[t]=e},x.alias=function(t,e){u[e]?u[t]=u[e]:l[e]&&(l[t]=l[e])},x.getClass=function(t){return u[t]},x.pointer=function(t,e,i){return e=t.byteOffset+e*t.constructor.BYTES_PER_ELEMENT,"number"==typeof i?new t.constructor(t.buffer,e,i):new t.constructor(t.buffer,e)},x.nextTick=function(t){return a.nextTick(t),r},x.fixAR=function(t){t._.ar=!0,t._.aronly=!0},x.fixKR=function(t){t._.ar=!1,t._.kronly=!0},x.changeWithValue=function(){for(var t=this._,e=t.value*t.mul+t.add,i=(isNaN(e)&&(e=0),this.cells[0]),s=0,n=i.length;s<n;++s)i[s]=e},x.changeWithValue.unremovable=!0,x.clone=function(t){var e=new t.constructor([]);return e._.ar=t._.ar,e._.mul=t._.mul,e._.add=t._.add,e._.bypassed=t._.bypassed,e},x.timer=function(t){function e(){-1===a.timers.indexOf(s)&&(a.timers.push(s),a.events.emit("addObject"),s._.emit("start"),x.buddies_start(s))}function i(){var t=a.timers.indexOf(n);-1!==t&&(a.timers.splice(t,1),n._.emit("stop"),a.events.emit("removeObject"),x.buddies_stop(n))}var s,n;return(n=s=t).nodeType=v.TIMER,t.start=function(){return a.nextTick(e),t},t.stop=function(){return a.nextTick(i),t},t},x.listener=function(e){function i(){-1===a.listeners.indexOf(s)&&(a.listeners.push(s),a.events.emit("addObject"),s._.emit("listen"),x.buddies_start(s))}function t(){var t=a.listeners.indexOf(n);-1!==t&&(a.listeners.splice(t,1),n._.emit("unlisten"),a.events.emit("removeObject"),x.buddies_stop(n))}var s,n;return(n=s=e).nodeType=v.LISTENER,e.listen=function(t){return arguments.length&&e.append.apply(e,arguments),e.nodes.length&&a.nextTick(i),e},e.unlisten=function(){return arguments.length&&e.remove.apply(e,arguments),e.nodes.length||a.nextTick(t),e},e},x.make_onended=function(r,a){return function(){if(r.playbackState=0,"number"==typeof a)for(var t=r.cells[0],e=r.cells[1],i=r.cells[2],s=0,n=e.length;s<n;++s)t[0]=e[s]=i[s]=a;r._.emit("ended")}},x.inputSignalAR=function(t){var e,i,s,n,r,a,o=t.cells[0],h=t.cells[1],u=t.cells[2],l=t.nodes,c=l.length,f=o.length,p=t.tickID;if(2===t.numChannels){if(s=!0,0!==c){for(e=0;e<c;++e)if(1===l[e].playbackState){l[e].process(p),h.set(l[e].cells[1]),u.set(l[e].cells[2]),s=!1,++e;break}for(;e<c;++e)if(1===l[e].playbackState)for(l[e].process(p),r=l[e].cells[1],a=l[e].cells[2],i=f;i;)h[i-=8]+=r[i],u[i]+=a[i],h[i+1]+=r[i+1],u[i+1]+=a[i+1],h[i+2]+=r[i+2],u[i+2]+=a[i+2],h[i+3]+=r[i+3],u[i+3]+=a[i+3],h[i+4]+=r[i+4],u[i+4]+=a[i+4],h[i+5]+=r[i+5],u[i+5]+=a[i+5],h[i+6]+=r[i+6],u[i+6]+=a[i+6],h[i+7]+=r[i+7],u[i+7]+=a[i+7]}s&&(h.set(x.emptycell),u.set(x.emptycell))}else{if(s=!0,0!==c){for(e=0;e<c;++e)if(1===l[e].playbackState){l[e].process(p),o.set(l[e].cells[0]),s=!1,++e;break}for(;e<c;++e)if(1===l[e].playbackState)for(n=l[e].process(p).cells[0],i=f;i;)o[i-=8]+=n[i],o[i+1]+=n[i+1],o[i+2]+=n[i+2],o[i+3]+=n[i+3],o[i+4]+=n[i+4],o[i+5]+=n[i+5],o[i+6]+=n[i+6],o[i+7]+=n[i+7]}s&&o.set(x.emptycell)}},x.inputSignalKR=function(t){for(var e=t.nodes,i=e.length,s=t.tickID,n=0,r=0;r<i;++r)1===e[r].playbackState&&(n+=e[r].process(s).cells[0][0]);return n},x.outputSignalAR=function(t){var e,i=t.cells[0],s=t.cells[1],n=t.cells[2],r=t._.mul,a=t._.add;if(2===t.numChannels)for(e=i.length;e;)s[e-=8]=s[e]*r+a,n[e]=n[e]*r+a,s[e+1]=s[e+1]*r+a,n[e+1]=n[e+1]*r+a,s[e+2]=s[e+2]*r+a,n[e+2]=n[e+2]*r+a,s[e+3]=s[e+3]*r+a,n[e+3]=n[e+3]*r+a,s[e+4]=s[e+4]*r+a,n[e+4]=n[e+4]*r+a,s[e+5]=s[e+5]*r+a,n[e+5]=n[e+5]*r+a,s[e+6]=s[e+6]*r+a,n[e+6]=n[e+6]*r+a,s[e+7]=s[e+7]*r+a,n[e+7]=n[e+7]*r+a,i[e]=.5*(s[e]+n[e]),i[e+1]=.5*(s[e+1]+n[e+1]),i[e+2]=.5*(s[e+2]+n[e+2]),i[e+3]=.5*(s[e+3]+n[e+3]),i[e+4]=.5*(s[e+4]+n[e+4]),i[e+5]=.5*(s[e+5]+n[e+5]),i[e+6]=.5*(s[e+6]+n[e+6]),i[e+7]=.5*(s[e+7]+n[e+7]);else if(1!==r||0!==a)for(e=i.length;e;)i[e-=8]=i[e]*r+a,i[e+1]=i[e+1]*r+a,i[e+2]=i[e+2]*r+a,i[e+3]=i[e+3]*r+a,i[e+4]=i[e+4]*r+a,i[e+5]=i[e+5]*r+a,i[e+6]=i[e+6]*r+a,i[e+7]=i[e+7]*r+a},x.outputSignalKR=function(t){var e,i=t.cells[0],s=t.cells[1],n=t.cells[2],r=t._.mul,a=t._.add,o=i[0]*r+a;if(2===t.numChannels)for(e=i.length;e;)i[e-=8]=i[e+1]=i[e+2]=i[e+3]=i[e+4]=i[e+5]=i[e+6]=i[e+7]=s[e]=s[e+1]=s[e+2]=s[e+3]=s[e+4]=s[e+5]=s[e+6]=s[e+7]=n[e]=n[e+1]=n[e+2]=n[e+3]=n[e+4]=n[e+5]=n[e+6]=n[e+7]=o;else for(e=i.length;e;)i[e-=8]=i[e+1]=i[e+2]=i[e+3]=i[e+4]=i[e+5]=i[e+6]=i[e+7]=o},x.buddies_start=function(t){for(var e,i=t._.buddies,s=0,n=i.length;s<n;++s)switch((e=i[s]).nodeType){case v.DSP:e.play();break;case v.TIMER:e.start();break;case v.LISTENER:e.listen()}},x.buddies_stop=function(t){for(var e,i=t._.buddies,s=0,n=i.length;s<n;++s)switch((e=i[s]).nodeType){case v.DSP:e.pause();break;case v.TIMER:e.stop();break;case v.LISTENER:e.unlisten()}},x.fix_iOS6_1_problem=function(t){a.fix_iOS6_1_problem(t)},r.modules={}),N=e.EventEmitter=((D=z.prototype).emit=function(t){var e=this.events[t];if(!e)return!1;if("function"==typeof e){switch(arguments.length){case 1:e.call(this.context);break;case 2:e.call(this.context,arguments[1]);break;case 3:e.call(this.context,arguments[1],arguments[2]);break;default:i=h.call(arguments,1),e.apply(this.context,i)}return!0}if(f(e)){for(var i=h.call(arguments,1),s=e.slice(),n=0,r=s.length;n<r;++n)s[n]instanceof v?s[n].bang.apply(s[n],i):s[n].apply(this.context,i);return!0}if(!(e instanceof v))return!1;i=h.call(arguments,1),e.bang.apply(e,i)},D.on=function(t,e){var i;if("function"==typeof e||e instanceof v)return(i=this.events)[t]?f(i[t])?i[t].push(e):i[t]=[i[t],e]:i[t]=e,this;throw new Error("addListener takes instances of Function or timbre.Object")},D.once=function(t,e){var i,s=this;if("function"==typeof e)i=function(){s.off(t,i),e.apply(s.context,arguments)};else{if(!(e instanceof v))throw new Error("once takes instances of Function or timbre.Object");i=function(){s.off(t,i),e.bang.apply(e,arguments)}}return i.listener=e,s.on(t,i),this},D.off=function(t,e){if("function"!=typeof e&&!(e instanceof v))throw new Error("removeListener takes instances of Function or timbre.Object");var i=this.events;if(i[t]){var s=i[t];if(f(s)){for(var n=-1,r=0,a=s.length;r<a;++r)if(s[r]===e||s[r].listener&&s[r].listener===e){n=r;break}if(n<0)return this;s.splice(n,1),0===s.length&&(i[t]=null)}else(s===e||s.listener&&s.listener===e)&&(i[t]=null)}return this},D.removeAllListeners=function(t){var e=this.events,i=!1,s=e[t];if(f(s))for(var n=s.length;n--;){var r=s[n];r.unremovable?i=!0:this.off(t,r)}else s&&(s.unremovable?i=!0:this.off(t,s));return i||(e[t]=null),this},D.listeners=function(t){var e=this.events;if(!e[t])return[];if(e=e[t],!f(e))return e.unremovable?[]:[e];for(var i=[],s=0,n=(e=e.slice()).length;s<n;++s)e[s].unremovable||i.push(e[s]);return i},z);function z(t){this.context=t,this.events={}}var G=e.Deferred=((D=d.prototype).resolve=function(){var t=h.call(arguments,0);return s.call(this,"resolved",this._doneList,this.context||this,t),this},D.resolveWith=function(t){var e=h.call(arguments,1);return s.call(this,"resolved",this._doneList,t,e),this},D.reject=function(){var t=h.call(arguments,0);return s.call(this,"rejected",this._failList,this.context||this,t),this},D.rejectWith=function(t){var e=h.call(arguments,1);return s.call(this,"rejected",this._failList,t,e),this},D.promise=function(){return this._promise},D.done=function(){for(var t=h.call(arguments),e="resolved"===this._state,i="pending"===this._state,s=this._doneList,n=0,r=t.length;n<r;++n)"function"==typeof t[n]&&(e?t[n]():i&&s.push(t[n]));return this},D.fail=function(){for(var t=h.call(arguments),e="rejected"===this._state,i="pending"===this._state,s=this._failList,n=0,r=t.length;n<r;++n)"function"==typeof t[n]&&(e?t[n]():i&&s.push(t[n]));return this},D.always=function(){return this.done.apply(this,arguments),this.fail.apply(this,arguments),this},D.then=function(t,e){return this.done(t).fail(e)},D.pipe=function(t,i){var s=this,n=new d(this.context);return this.done(function(){var e=t.apply(s.context,arguments);m(e)?e.then(function(){var t=h.call(arguments);n.resolveWith.apply(n,[e].concat(t))}):n.resolveWith(s,e)}),this.fail(function(){var e;"function"==typeof i?(e=i.apply(s.context,arguments),m(e)&&e.fail(function(){var t=h.call(arguments);n.rejectWith.apply(n,[e].concat(t))})):n.reject.apply(n,arguments)}),n.promise()},D.isResolved=function(){return"resolved"===this._state},D.isRejected=function(){return"rejected"===this._state},D.state=function(){return this._state},d.when=function(t){var e=0,i=h.call(arguments),s=i.length,n=s,r=1===(n=1!==s||m(t)?n:0)?t:new d;if(1<s)for(var a=new Array(s),o=function(){r.reject()};e<s;++e)i[e]&&m(i[e])?i[e].promise().done(function(e,i){return function(t){i[e]=1<arguments.length?h.call(arguments):t,--n||r.resolve.apply(r,i)}}(e,a)).fail(o):(a[e]=i[e],--n);return n||r.resolve.apply(r,i),r.promise()},d);function d(t){this.context=t||this,this._state="pending",this._doneList=[],this._failList=[],this._promise=new W(this)}function s(t,e,i,s){if("pending"===this._state){this._state=t;for(var n=0,r=e.length;n<r;++n)e[n].apply(i,s);this._doneList=this._failList=null}}function m(t){return t&&"function"==typeof t.promise}function W(t){this.context=t.context,this.then=t.then,this.done=function(){return t.done.apply(t,arguments),this},this.fail=function(){return t.fail.apply(t,arguments),this},this.pipe=function(){return t.pipe.apply(t,arguments)},this.always=function(){return t.always.apply(t,arguments),this},this.promise=function(){return this},this.isResolved=function(){return t.isResolved()},this.isRejected=function(){return t.isRejected()}}var v=r.Object=(g.DSP=1,g.TIMER=2,g.LISTENER=3,e=g.prototype,Object.defineProperties(e,{isAr:{get:function(){return this._.ar}},isKr:{get:function(){return!this._.ar}},isBypassed:{get:function(){return this._.bypassed}},isEnded:{get:function(){return!(1&this.playbackState)}},mul:{set:function(t){"number"==typeof t&&(this._.mul=t,this._.emit("setMul",t))},get:function(){return this._.mul}},add:{set:function(t){"number"==typeof t&&(this._.add=t,this._.emit("setAdd",t))},get:function(){return this._.add}},buddies:{set:function(t){f(t)||(t=[t]),this._.buddies=t.filter(function(t){return t instanceof g})},get:function(){return this._.buddies}}}),e.toString=function(){return this.constructor.name},e.valueOf=function(){return a.tickID!==this.tickID&&this.process(a.tickID),this.cells[0][0]},e.append=function(){var t;return 0<arguments.length&&(t=h.call(arguments).map(r),this.nodes=this.nodes.concat(t),this._.emit("append",t)),this},e.appendTo=function(t){return t.append(this),this},e.remove=function(){if(0<arguments.length){for(var t,e=this.nodes,i=[],s=0,n=arguments.length;s<n;++s)-1!==(t=e.indexOf(arguments[s]))&&(i.push(e[t]),e.splice(t,1));0<i.length&&this._.emit("remove",i)}return this},e.removeFrom=function(t){return t.remove(this),this},e.removeAll=function(){var t=this.nodes.slice();return this.nodes=[],0<t.length&&this._.emit("remove",t),this},e.removeAtIndex=function(t){var e=this.nodes[t];return e&&(this.nodes.splice(t,1),this._.emit("remove",[e])),this},e.postMessage=function(t){return this._.emit("message",t),this},e.to=function(t){var e;return t instanceof g?t.append(this):(e=h.call(arguments),p(e[1])?e.splice(2,0,this):e.splice(1,0,this),t=o.apply(null,e)),t},e.splice=function(t,e,i){var s;return e?e instanceof g&&(-1!==(s=e.nodes.indexOf(i))&&e.nodes.splice(s,1),t instanceof g?(t.nodes.push(this),e.nodes.push(t)):e.nodes.push(this)):this._.dac&&(t instanceof g?i instanceof g?i._.dac&&((i._.dac._.node=t)._.dac=i._.dac,i._.dac=null,t.nodes.push(this)):this._.dac&&((this._.dac._.node=t)._.dac=this._.dac,this._.dac=null,t.nodes.push(this)):i instanceof g&&i._.dac&&((i._.dac._.node=this)._.dac=i._.dac,i._.dac=null)),this},e.on=e.addListener=function(t,e){return this._.events.on(t,e),this},e.once=function(t,e){return this._.events.once(t,e),this},e.off=e.removeListener=function(t,e){return this._.events.off(t,e),this},e.removeAllListeners=function(t){return this._.events.removeAllListeners(t),this},e.listeners=function(t){return this._.events.listeners(t)},e.set=function(t,e){var i,s,n=this._.meta;switch(typeof t){case"string":switch(n[t]){case"property":this[t]=e;break;case"function":this[t](e);break;default:for(i=this;null!==i;)(s=Object.getOwnPropertyDescriptor(i,t))&&("function"==typeof s.value?(n[t]="function",this[t](e)):(s.get||s.set)&&(n[t]="property",this[t]=e)),i=Object.getPrototypeOf(i)}break;case"object":for(i in t)this.set(i,t[i])}return this},e.get=function(t){if("property"===this._.meta[t])return this[t]},e.bang=function(){return this._.emit.apply(this,["bang"].concat(h.call(arguments))),this},e.process=x.nop,e.bypass=function(){return this._.bypassed=0===arguments.length||!!arguments[0],this},e.play=function(){var t=this._.dac;return(t=null===t?this._.dac=new X(this):t).play()&&this._.emit.apply(this,["play"].concat(h.call(arguments))),x.buddies_start(this),this},e.pause=function(){var t=this._.dac;return t&&1===t.playbackState&&(t.pause(),this._.dac=null,this._.emit("pause")),x.buddies_stop(this),this},e.start=e.stop=e.listen=e.unlisten=function(){return this},e.ar=function(){return 0===arguments.length||arguments[0]?this._.kronly||(this._.ar=!0,this._.emit("ar",!0)):this.kr(!0),this},e.kr=function(){return 0===arguments.length||arguments[0]?this._.aronly||(this._.ar=!1,this._.emit("ar",!1)):this.ar(!0),this},e.plot="browser"==t?function(t){var e=this._,i=t.target;if(i){var s,n,r,a,o=t.width||i.width||320,h=t.height||i.height||240,u=(t.x||0)+.5,l=t.y||0,c=i.getContext("2d"),i=t.foreground!==w?t.foreground:e.plotForeground||"rgb(  0, 128, 255)",f=t.background!==w?t.background:e.plotBackground||"rgb(255, 255, 255)",p=t.lineWidth||e.plotLineWidth||1,d=!!e.plotCyclic,m=e.plotData||this.cells[0],v=t.range||e.plotRange||[-1.2,1.2],g=v[0],b=h/(v[1]-g),_=o/m.length,y=m.length;if(c.save(),c.rect(u,l,o,h),null!==f&&(c.fillStyle=f,c.fillRect(u,l,o,h)),e.plotBefore&&e.plotBefore.call(this,c,u,l,o,h),e.plotBarStyle)for(c.fillStyle=i,a=s=0;a<y;++a)r=(m[a]-g)*b,c.fillRect(s+u,(n=h-r)+l,_,r),s+=_;else{for(c.strokeStyle=i,c.lineWidth=p,c.beginPath(),v=h-(m[s=0]-g)*b,c.moveTo(s+u,v+l),a=1;a<y;++a)n=h-(m[a]-g)*b,c.lineTo((s+=_)+u,n+l);d?c.lineTo(s+_+u,v+l):c.lineTo(s+_+u,n+l),c.stroke()}e.plotAfter&&e.plotAfter.call(this,c,u,l,o,h);f=t.border||e.plotBorder;f&&(c.strokeStyle="string"==typeof f?f:"#000",c.lineWidth=1,c.strokeRect(u,l,o,h)),c.restore()}return this}:x.nop,g);function g(t,e){this._={};var i,s,n=this._.events=new N(this);switch(this._.emit=function(){return n.emit.apply(n,arguments)},p(e[0])&&(i=e.shift(),s=i.in,this.once("init",function(){this.set(i),s&&(f(s)?this.append.apply(this,s):s instanceof g&&this.append(s))})),this.tickID=-1,this.nodes=e.map(r),this.cells=[],this.numChannels=t){case 0:this.L=this.R=new b(null),this.cells[0]=this.cells[1]=this.cells[2]=this.L.cell;break;case 1:this.L=this.R=new b(this),this.cells[0]=this.cells[1]=this.cells[2]=this.L.cell;break;case 2:this.L=new b(this),this.R=new b(this),this.cells[0]=new x.SignalArray(a.cellsize),this.cells[1]=this.L.cell,this.cells[2]=this.R.cell}this.playbackState=1,this.nodeType=g.DSP,this._.ar=!0,this._.mul=1,this._.add=0,this._.dac=null,this._.bypassed=!1,this._.meta={},this._.samplerate=a.samplerate,this._.cellsize=a.cellsize,this._.buddies=[]}var b=r.ChannelObject=(x.extend(_),_.prototype.process=function(t){return this.tickID!==t&&(this.tickID=t,this._.parent)&&this._.parent.process(t),this},_);function _(t){r.Object.call(this,-1,[]),x.fixAR(this),this._.parent=t,this.cell=new x.SignalArray(a.cellsize),(this.L=this.R=this).cells[0]=this.cells[1]=this.cells[2]=this.cell,this.numChannels=1}x.extend(y),y.prototype.process=function(t){var e=this._;return this.tickID!==t&&(this.tickID=t,e.ar?(x.inputSignalAR(this),x.outputSignalAR(this)):(this.cells[0][0]=x.inputSignalKR(this),x.outputSignalKR(this))),this},x.register("+",y);var V=y;function y(t){v.call(this,2,t)}x.extend(k),Object.defineProperties(k.prototype,{value:{set:function(t){"number"==typeof t&&(this._.value=isNaN(t)?0:t,x.changeWithValue.call(this))},get:function(){return this._.value}}});var K=k;function k(t){var e;v.call(this,1,[]),x.fixKR(this),this.value=t[0],p(t[1])&&(e=t[1],this.once("init",function(){this.set(e)})),this.on("setAdd",x.changeWithValue),this.on("setMul",x.changeWithValue)}x.extend(A),Object.defineProperties(A.prototype,{value:{set:function(t){this._.value=t?1:0,x.changeWithValue.call(this)},get:function(){return!!this._.value}}});var $=A;function A(t){var e;v.call(this,1,[]),x.fixKR(this),this.value=t[0],p(t[1])&&(e=t[1],this.once("init",function(){this.set(e)})),this.on("setAdd",x.changeWithValue),this.on("setMul",x.changeWithValue)}x.extend(S),D=S.prototype,Object.defineProperties(D,{func:{set:function(t){"function"==typeof t&&(this._.func=t)},get:function(){return this._.func}},args:{set:function(t){f(t)?this._.args=t:this._.args=[t]},get:function(){return this._.args}}}),D.bang=function(){var t=this._,e=h.call(arguments).concat(t.args),e=t.func.apply(this,e);return"number"==typeof e&&(t.value=e,x.changeWithValue.call(this)),this._.emit("bang"),this};var Y=S;function S(t){var e;v.call(this,1,[]),x.fixKR(this),this.func=t[0],this._.value=0,p(t[1])&&(e=t[1],this.once("init",function(){this.set(e)})),this.on("setAdd",x.changeWithValue),this.on("setMul",x.changeWithValue)}x.extend(T),e=T.prototype,Object.defineProperties(e,{}),e.bang=function(){for(var t=["bang"].concat(h.call(arguments)),e=this.nodes,i=0,s=e.length;i<s;++i)e[i].bang.apply(e[i],t);return this},e.postMessage=function(t){for(var e=this.nodes,i=0,s=e.length;i<s;++i)e[i].postMessage(t);return this},e.process=function(t){var e=this._;return this.tickID!==t&&(this.tickID=t,e.ar?(x.inputSignalAR(this),x.outputSignalAR(this)):(this.cells[0][0]=x.inputSignalKR(this),x.outputSignalKR(this))),this};var H=T;function T(t){var e,i,s;for(v.call(this,1,[]),i=t[e=0].length;e<i;++e)this.append(t[0][e]);p(t[1])&&(s=t[1],this.once("init",function(){this.set(s)}))}x.extend(I),Object.defineProperties(I.prototype,{});var Q=I;function I(t){var e;v.call(this,1,[]),x.fixKR(this),p(t[1])&&(e=t[1],this.once("init",function(){this.set(e)}))}x.extend(R),Z=function(t){return function(){-1===a.inlets.indexOf(t)&&(a.inlets.push(t),a.events.emit("addObject"),t.playbackState=1,t._.emit("play"))}},U=function(e){return function(){var t=a.inlets.indexOf(e);-1!==t&&(a.inlets.splice(t,1),e.playbackState=0,e._.emit("pause"),a.events.emit("removeObject"))}},(D=R.prototype).play=function(){return a.nextTick(this._.onplay),-1===a.inlets.indexOf(this)},D.pause=function(){a.nextTick(this._.onpause)},D.process=function(t){var e=this._.node;1&e.playbackState?(e.process(t),this.cells[1].set(e.cells[1]),this.cells[2].set(e.cells[2])):(this.cells[1].set(x.emptycell),this.cells[2].set(x.emptycell))};var Z,U,X=R;function R(t){v.call(this,2,[]),this.playbackState=0;var e=this._;e.node=t,e.onplay=Z(this),e.onpause=U(this)}(e=J.prototype).bind=function(t,e){return"function"==typeof t&&(t=new t(this,e),this.impl=t,this.impl.defaultSamplerate)&&(this.samplerate=this.impl.defaultSamplerate),this},e.setup=function(t){return"object"==typeof t&&(-1!==B.indexOf(t.samplerate)&&(t.samplerate<=this.impl.maxSamplerate?this.samplerate=t.samplerate:this.samplerate=this.impl.maxSamplerate),-1!==E.indexOf(t.cellsize)&&(this.cellsize=t.cellsize),"undefined"!=typeof Float64Array)&&void 0!==t.f64&&(q=!!t.f64,x.SignalArray=q?Float64Array:Float32Array),x.currentTimeIncr=1e3*this.cellsize/this.samplerate,x.emptycell=new x.SignalArray(this.cellsize),this},e.getAdjustSamples=function(t){return t=t||this.samplerate,t=this.streammsec/1e3*t,1<<((t=Math.ceil(Math.log(t)*Math.LOG2E))<8?8:14<t?14:t)},e.play=function(){return 0===this.status&&(this.status=1,this.streamsize=this.getAdjustSamples(),this.strmL=new x.SignalArray(this.streamsize),this.strmR=new x.SignalArray(this.streamsize),this.impl.play(),this.events.emit("play")),this},e.pause=function(){return 1===this.status&&(this.status=0,this.impl.pause(),this.events.emit("pause")),this},e.reset=function(t){return t&&(this.events=new N(this).on("addObject",function(){0===this.status&&this.play()}).on("removeObject",function(){1===this.status&&this.inlets.length+this.timers.length+this.listeners.length===0&&this.pause()})),this.currentTime=0,this.nextTicks=[],this.inlets=[],this.timers=[],this.listeners=[],this},e.process=function(){var t,e,i,s,n,r,a,o=this.tickID,h=this.strmL,u=this.strmR,l=this.amp,c=this.streamsize,f=0,p=this.cellsize,d=this.streamsize/this.cellsize,m=this.timers,v=this.inlets,g=this.listeners,b=x.currentTimeIncr;for(w=0;w<c;++w)h[w]=u[w]=0;for(;d--;){for(++o,s=0,n=m.length;s<n;++s)1&m[s].playbackState&&m[s].process(o);for(s=0,n=v.length;s<n;++s)if((t=v[s]).process(o),1&t.playbackState)for(e=t.cells[1],i=t.cells[2],r=0,w=f;r<p;++r,++w)h[w]+=e[r],u[w]+=i[r];for(f+=p,s=0,n=g.length;s<n;++s)1&g[s].playbackState&&g[s].process(o);for(this.currentTime+=b,n=(a=this.nextTicks.splice(s=0)).length;s<n;++s)a[s]()}for(w=0;w<c;++w)(t=h[w]*l)<-1?t=-1:1<t&&(t=1),h[w]=t,(t=u[w]*l)<-1?t=-1:1<t&&(t=1),u[w]=t;this.tickID=o;var _=this.currentTime;if(3===this.status){if(2===this.recCh)this.recBuffers.push(new x.SignalArray(h)),this.recBuffers.push(new x.SignalArray(u));else{for(var y=new x.SignalArray(h.length),w=0,c=y.length;w<c;++w)y[w]=.5*(h[w]+u[w]);this.recBuffers.push(y)}_>=this.maxDuration?this.deferred.sub.reject():_>=this.recDuration?this.deferred.sub.resolve():20<Date.now()-this.recStart?setTimeout(this.delayProcess,10):this.process()}},e.nextTick=function(t){0===this.status?t():this.nextTicks.push(t)},e.rec=function(){x.fix_iOS6_1_problem(!0);var t=new G(this);if(this.deferred)return console.warn("rec deferred is exists??"),t.reject().promise();if(0!==this.status)return console.log("status is not none",this.status),t.reject().promise();var e=0,i=arguments,s=p(i[e])?i[e++]:{},i=i[e];if("function"!=typeof i)return console.warn("no function"),t.reject().promise();this.deferred=t,this.status=3,this.reset();var n=new o("+"),r=new G(this),e={done:function(){r.resolve.apply(r,h.call(arguments))},send:function(){n.append.apply(n,arguments)}},a=this;return r.then(O,function(){x.fix_iOS6_1_problem(!1),O.call(a,!0)}),this.deferred.sub=r,this.savedSamplerate=this.samplerate,this.samplerate=s.samplerate||this.samplerate,this.recDuration=s.recDuration||1/0,this.maxDuration=s.maxDuration||6e5,this.recCh=s.ch||1,2!==this.recCh&&(this.recCh=1),this.recBuffers=[],this.streamsize=this.getAdjustSamples(),this.strmL=new x.SignalArray(this.streamsize),this.strmR=new x.SignalArray(this.streamsize),this.inlets.push(n),i(e),setTimeout(this.delayProcess,10),t.promise()},O=function(){this.status=0,this.reset();var t,e=this.recBuffers,i=this.samplerate,s=this.streamsize;this.samplerate=this.savedSamplerate;var n=(p=this.recDuration!==1/0?this.recDuration*i*.001|0:(e.length>>this.recCh-1)*s)/s|0,r=0,a=0,o=p;if(2===this.recCh){for(var h=new x.SignalArray(p),u=new x.SignalArray(p),l=new x.SignalArray(p),c=0;c<n;++c)if(h.set(e[r++],a),u.set(e[r++],a),a+=s,0<(o-=s)&&o<s){h.set(e[r++].subarray(0,o),a),u.set(e[r++].subarray(0,o),a);break}for(c=0,n=p;c<n;++c)l[c]=.5*(h[c]+u[c]);t={samplerate:i,channels:2,buffer:[l,h,u]}}else{var f=new x.SignalArray(p);for(c=0;c<n;++c)if(f.set(e[r++],a),a+=s,0<(o-=s)&&o<s){f.set(e[r++].subarray(0,o),a);break}t={samplerate:i,channels:1,buffer:[f]}}var p=[].concat.apply([t],arguments);this.deferred.resolve.apply(this.deferred,p),this.deferred=null},e.on=function(t,e){this.events.on(t,e)},e.once=function(t,e){this.events.once(t,e)},e.off=function(t,e){this.events.off(t,e)},e.removeAllListeners=function(t){this.events.removeListeners(t)},e.listeners=function(t){return this.events.listeners(t)},e.fix_iOS6_1_problem=function(t){this.impl.fix_iOS6_1_problem&&this.impl.fix_iOS6_1_problem(t)};var O,D=J;function J(){var t;(this.context=this).tickID=0,this.impl=null,this.amp=.8,this.status=0,this.samplerate=44100,this.channels=2,this.cellsize=64,this.streammsec=20,this.streamsize=0,this.currentTime=0,this.nextTicks=[],this.inlets=[],this.timers=[],this.listeners=[],this.deferred=null,this.recStart=0,this.recBuffers=null,this.delayProcess=(t=this,function(){t.recStart=Date.now(),t.process()}),this.events=null,x.currentTimeIncr=1e3*this.cellsize/this.samplerate,x.emptycell=new x.SignalArray(this.cellsize),this.reset(!0)}var tt,et,it,M,L,st,j,P,e=null,F=(e=void 0!==(tt="undefined"!=typeof window?window.AudioContext||window.webkitAudioContext:tt)?function(l){var i,s,e,n,r=new tt,t=(x._audioContext=r,this.maxSamplerate=r.sampleRate,this.defaultSamplerate=r.sampleRate,this.env="webkit",navigator.userAgent);t.match(/linux/i)?l.streammsec*=8:t.match(/win(dows)?\s*(nt 5\.1|xp)/i)&&(l.streammsec*=4),this.play=function(){var o,h,t=l.getAdjustSamples(r.sampleRate),u=l.streamsize,e=l.samplerate===r.sampleRate?function(t){t=t.outputBuffer;l.process(),t.getChannelData(0).set(l.strmL),t.getChannelData(1).set(l.strmR)}:2*l.samplerate===r.sampleRate?function(t){var e,i,s=l.strmL,n=l.strmR,t=t.outputBuffer,r=t.getChannelData(0),a=t.getChannelData(1),o=t.length;for(l.process(),e=i=0;e<o;e+=2,++i)r[e]=r[e+1]=s[i],a[e]=a[e+1]=n[i]}:(o=u,h=l.samplerate/r.sampleRate,function(t){for(var e=l.strmL,i=l.strmR,t=t.outputBuffer,s=t.getChannelData(0),n=t.getChannelData(1),r=t.length,a=0;a<r;++a)u<=o&&(l.process(),o-=u),s[a]=e[0|o],n[a]=i[0|o],o+=h});i=r.createBufferSource(),(s=r.createScriptProcessor(t,2,l.channels)).onaudioprocess=e,i.noteOn&&i.noteOn(0),i.connect(s),s.connect(r.destination)},this.pause=function(){i.disconnect(),s.disconnect()},c&&(e=0,n=r.createBufferSource(),this.fix_iOS6_1_problem=function(t){1===(e+=t?1:-1)?(n.noteOn(0),n.connect(r.destination)):0===e&&n.disconnect()})}:function(t){this.maxSamplerate=48e3,this.defaultSamplerate=44100,this.env="nop",this.play=function(){},this.pause=function(){}},a=(new D).bind(e),r);"node"==t||"undefined"!=typeof module&&module.exports?module.exports=global.timbre=F:"browser"==t&&(F.noConflict=(et=window.timbre,it=window.T,function(t){return window.T===F&&(window.T=it),t&&window.timbre===F&&(window.timbre=et),F}),window.timbre=window.T=F),"nop"!==a.impl.env||"browser"!=t||c||(M=navigator,function(t){try{return M.plugins&&M.mimeTypes&&M.mimeTypes.length?M.plugins["Shockwave Flash"].description.match(/([0-9]+)/)[t]:new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version").match(/([0-9]+)/)[t]}catch(t){return-1}}(0)<10)||(st=function(){var t=document.getElementsByTagName("script");if(t&&t.length)for(var e,i=0,s=t.length;i<s;++i)if(e=/^(.*\/)timbre(?:\.dev)?\.js$/i.exec(t[i].src))return e[1]+"timbre.swf"}(),window.timbrejs_flashfallback_init=function(){a.bind(function(h){var i=0;this.maxSamplerate=44100,this.defaultSamplerate=44100,this.env="flash",this.play=function(){var n=new Array(h.streamsize*h.channels),t=h.streammsec,r=0,a=h.streamsize/h.samplerate*1e3,o=Date.now(),e=function(){if(!(r>Date.now()-o)){var t=h.strmL,e=h.strmR,i=n.length,s=t.length;for(h.process();s--;)n[--i]=32768*e[s]|0,n[--i]=32768*t[s]|0;L.writeAudio(n.join(" ")),r+=a}};L.setup?(L.setup(h.channels,h.samplerate),i=setInterval(e,t)):console.warn("Cannot find "+st)},this.pause=function(){0!==i&&(L.cancel(),clearInterval(i),i=0)}}),delete window.timbrejs_flashfallback_init},D=st+"?"+ +new Date,j="TimbreFlashPlayer",(P=document.createElement("div")).id="TimbreFlashPlayerDiv",P.style.display="inline",P.width=P.height=1,M.plugins&&M.mimeTypes&&M.mimeTypes.length?((e=document.createElement("object")).id=j,e.classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",e.width=e.height=1,e.setAttribute("data",D),e.setAttribute("type","application/x-shockwave-flash"),(t=document.createElement("param")).setAttribute("name","allowScriptAccess"),t.setAttribute("value","always"),e.appendChild(t),P.appendChild(e)):P.innerHTML='<object id="'+j+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="1" height="1"><param name="movie" value="'+D+'" /><param name="bgcolor" value="#FFFFFF" /><param name="quality" value="high" /><param name="allowScriptAccess" value="always" /></object>',window.addEventListener("load",function(){document.body.appendChild(P),L=document[j]}))}(),function(t){"use strict";function e(t){this.samplerate=t,this.frequency=340,this.Q=1,this.gain=0,this.x1L=this.x2L=this.y1L=this.y2L=0,this.x1R=this.x2R=this.y1R=this.y2R=0,this.b0=this.b1=this.b2=this.a1=this.a2=0,this.setType("lpf")}var i=e.prototype,n=(i.process=function(t,e){for(var i,s,n,r=this.x1L,a=this.x2L,o=this.y1L,h=this.y2L,u=this.x1R,l=this.x2R,c=this.y1R,f=this.y2R,p=this.b0,d=this.b1,m=this.b2,v=this.a1,g=this.a2,b=0,_=t.length;b<_;++b)s=p*(i=t[b])+d*r+m*a-v*o-g*h,a=r,r=i,h=o,n=p*(i=e[b])+d*u+m*l-v*c-g*f,l=u,u=i,f=c,c=n,t[b]=o=s,e[b]=n;this.x1L=r,this.x2L=a,this.y1L=o,this.y2L=h,this.x1R=u,this.x2R=l,this.y1R=c,this.y2R=f},i.setType=function(t){var e;(e=n[t])&&(this.type=t,e.call(this,this.frequency,this.Q,this.gain))},i.setParams=function(t,e,i){this.frequency=t,this.Q=e,this.gain=i;var s=n[this.type];return s&&s.call(this,t,e,i),this},{lowpass:function(t,e){var i;1<=(t/=.5*this.samplerate)?(this.b0=1,this.b1=this.b2=this.a1=this.a2=0):t<=0?this.b0=this.b1=this.b2=this.a1=this.a2=0:(e=e<0?0:e,e=Math.pow(10,.05*e),e=Math.sqrt(.5*(4-Math.sqrt(16-16/(e*e)))),t=Math.PI*t,t=(.5+(e=.5*(1-(e=.5*e*Math.sin(t)))/(1+e)))*Math.cos(t),this.b0=2*(i=.25*(.5+e-t)),this.b1=4*i,this.b2=this.b0,this.a1=2*-t,this.a2=2*e)},highpass:function(t,e){var i;1<=(t/=.5*this.samplerate)?this.b0=this.b1=this.b2=this.a1=this.a2=0:t<=0?(this.b0=1,this.b1=this.b2=this.a1=this.a2=0):(e=e<0?0:e,e=Math.pow(10,.05*e),e=Math.sqrt((4-Math.sqrt(16-16/(e*e)))/2),t=Math.PI*t,t=(.5+(e=.5*(1-(e=.5*e*Math.sin(t)))/(1+e)))*Math.cos(t),this.b0=2*(i=.25*(.5+e+t)),this.b1=-4*i,this.b2=this.b0,this.a1=2*-t,this.a2=2*e)},bandpass:function(t,e){var i;0<(t/=.5*this.samplerate)&&t<1&&0<e?(t=Math.PI*t,e=Math.sin(t)/(2*e),t=Math.cos(t),this.b0=e*(i=1/(1+e)),this.b1=0,this.b2=-e*i,this.a1=-2*t*i,this.a2=(1-e)*i):this.b0=this.b1=this.b2=this.a1=this.a2=0},lowshelf:function(t,e,i){t/=.5*this.samplerate;var s,n,r,a,i=Math.pow(10,i/40);1<=t?(this.b0=i*i,this.b1=this.b2=this.a1=this.a2=0):t<=0?(this.b0=1,this.b1=this.b2=this.a1=this.a2=0):(t=Math.PI*t,s=.5*Math.sin(t)*Math.sqrt(0*(i+1/i)+2),t=Math.cos(t),s=2*Math.sqrt(i)*s,this.b0=i*((n=i+1)-(r=i-1)*t+s)*(a=1/(n+r*t+s)),this.b1=2*i*(r-n*t)*a,this.b2=i*(n-r*t-s)*a,this.a1=-2*(r+n*t)*a,this.a2=(n+r*t-s)*a)},highshelf:function(t,e,i){t/=.5*this.samplerate;var s,n,r,a,i=Math.pow(10,i/40);1<=t?(this.b0=1,this.b1=this.b2=this.a1=this.a2=0):t<=0?(this.b0=i*i,this.b1=this.b2=this.a1=this.a2=0):(t=Math.PI*t,s=.5*Math.sin(t)*Math.sqrt(0*(i+1/i)+2),t=Math.cos(t),s=2*Math.sqrt(i)*s,this.b0=i*((n=i+1)+(r=i-1)*t+s)*(a=1/(n-r*t+s)),this.b1=-2*i*(r+n*t)*a,this.b2=i*(n+r*t-s)*a,this.a1=2*(r-n*t)*a,this.a2=(n-r*t-s)*a)},peaking:function(t,e,i){var s;0<(t/=.5*this.samplerate)&&t<1?(i=Math.pow(10,i/40),0<e?(t=Math.PI*t,e=Math.sin(t)/(2*e),t=Math.cos(t),this.b0=(1+e*i)*(s=1/(1+e/i)),this.b1=-2*t*s,this.b2=(1-e*i)*s,this.a1=this.b1,this.a2=(1-e/i)*s):(this.b0=i*i,this.b1=this.b2=this.a1=this.a2=0)):(this.b0=1,this.b1=this.b2=this.a1=this.a2=0)},notch:function(t,e){var i;0<(t/=.5*this.samplerate)&&t<1?0<e?(t=Math.PI*t,e=Math.sin(t)/(2*e),t=Math.cos(t),this.b0=i=1/(1+e),this.b1=-2*t*i,this.b2=i,this.a1=this.b1,this.a2=(1-e)*i):this.b0=this.b1=this.b2=this.a1=this.a2=0:(this.b0=1,this.b1=this.b2=this.a1=this.a2=0)},allpass:function(t,e){var i;0<(t/=.5*this.samplerate)&&t<1?0<e?(t=Math.PI*t,e=Math.sin(t)/(2*e),t=Math.cos(t),this.b0=(1-e)*(i=1/(1+e)),this.b1=-2*t*i,this.b2=(1+e)*i,this.a1=this.b1,this.a2=this.b0):(this.b0=-1,this.b1=this.b2=this.a1=this.a2=0):(this.b0=1,this.b1=this.b2=this.a1=this.a2=0)}});n.lpf=n.lowpass,n.hpf=n.highpass,n.bpf=n.bandpass,n.bef=n.notch,n.brf=n.notch,n.apf=n.allpass,t.modules.Biquad=e}(timbre),function(e){"use strict";function t(t){this.samplerate=t;t=Math.round(Math.log(.1*t)*Math.LOG2E);this.buffersize=1<<t,this.bufferL=new e.fn.SignalArray(this.buffersize+1),this.bufferR=new e.fn.SignalArray(this.buffersize+1),this.wave=null,this._wave=null,this.writeIndex=this.buffersize>>1,this.readIndex=0,this.delayTime=20,this.rate=4,this.depth=20,this.feedback=.2,this.wet=.5,this.phase=0,this.phaseIncr=0,this.phaseStep=4,this.setWaveType("sin"),this.setDelayTime(this.delayTime),this.setRate(this.rate)}var i=t.prototype,s=[];s[0]=function(){for(var t=new Float32Array(512),e=0;e<512;++e)t[e]=Math.sin(2*Math.PI*(e/512));return t}(),s[1]=function(){for(var t,e=new Float32Array(512),i=0;i<512;++i)t=i/512-.25,e[i]=1-4*Math.abs(Math.round(t)-t);return e}(),i.setWaveType=function(t){"sin"===t?(this.wave=t,this._wave=s[0]):"tri"===t&&(this.wave=t,this._wave=s[1])},i.setDelayTime=function(t){this.delayTime=t;for(var e=this.writeIndex-(t*this.samplerate*.001|0);e<0;)e+=this.buffersize;this.readIndex=e},i.setRate=function(t){this.rate=t,this.phaseIncr=512*this.rate/this.samplerate*this.phaseStep},i.process=function(t,e){for(var i,s,n,r,a=this.bufferL,o=this.bufferR,h=this.buffersize,u=h-1,l=this._wave,c=this.phase,f=this.phaseIncr,p=this.writeIndex,d=this.readIndex,m=this.depth,v=this.feedback,g=this.wet,b=1-g,_=t.length,y=this.phaseStep,w=0;w<_;){for(n=l[0|c]*m,c+=f;512<c;)c-=512;for(r=0;r<y;++r,++w)i=.5*(a[s=d+h+n&u]+a[1+s]),a[p]=t[w]-i*v,t[w]=t[w]*b+i*g,i=.5*(o[s]+o[1+s]),o[p]=e[w]-i*v,e[w]=e[w]*b+i*g,p=p+1&u,d=d+1&u}this.phase=c,this.writeIndex=p,this.readIndex=d},e.modules.Chorus=t}(timbre),function(i){"use strict";var s=1024;function e(t,e){this.samplerate=t,this.channels=e,this.lastPreDelayFrames=0,this.preDelayReadIndex=0,this.preDelayWriteIndex=256,this.ratio=-1,this.slope=-1,this.linearThreshold=-1,this.dbThreshold=-1,this.dbKnee=-1,this.kneeThreshold=-1,this.kneeThresholdDb=-1,this.ykneeThresholdDb=-1,this.K=-1,this.attackTime=.003,this.releaseTime=.25,this.preDelayTime=.006,this.dbPostGain=0,this.effectBlend=1,this.releaseZone1=.09,this.releaseZone2=.16,this.releaseZone3=.42,this.releaseZone4=.98,this.detectorAverage=0,this.compressorGain=1,this.meteringGain=1,this.delayBufferL=new i.fn.SignalArray(s),this.delayBufferR=2===e?new i.fn.SignalArray(s):this.delayBufferL,this.preDelayTime=6,this.preDelayReadIndex=0,this.preDelayWriteIndex=256,this.maxAttackCompressionDiffDb=-1,this.meteringReleaseK=1-Math.exp(-1/(.325*this.samplerate)),this.setAttackTime(this.attackTime),this.setReleaseTime(this.releaseTime),this.setPreDelayTime(this.preDelayTime),this.setParams(-24,30,12)}var t=e.prototype;t.clone=function(){var t=new e(this.samplerate,this.channels);return t.setAttackTime(this.attackTime),t.setReleaseTime(this.releaseTime),t.setPreDelayTime(this.preDelayTime),t.setParams(this.dbThreshold,this.dbKnee,this.ratio),t},t.setAttackTime=function(t){this.attackTime=Math.max(.001,t),this._attackFrames=this.attackTime*this.samplerate},t.setReleaseTime=function(t){this.releaseTime=Math.max(.001,t);var t=this.releaseTime*this.samplerate,e=(this._satReleaseFrames=.0025*this.samplerate,t*this.releaseZone1),i=t*this.releaseZone2,s=t*this.releaseZone3,t=t*this.releaseZone4;this._kA=.9999999999999998*e+18432219684323923e-32*i-19373394351676423e-32*s+8824516011816245e-33*t,this._kB=-1.5788320352845888*e+2.3305837032074286*i-.9141194204840429*s+.1623677525612032*t,this._kC=.5334142869106424*e-1.272736789213631*i+.9258856042207512*s-.18656310191776226*t,this._kD=.08783463138207234*e-.1694162967925622*i+.08588057951595272*s-.00429891410546283*t,this._kE=-.042416883008123074*e+.1115693827987602*i-.09764676325265872*s+.028494263462021576*t},t.setPreDelayTime=function(t){t=(this.preDelayTime=t)*this.samplerate;if(this.lastPreDelayFrames!==(t=1023<t?1023:t)){this.lastPreDelayFrames=t;for(var e=0,i=this.delayBufferL.length;e<i;++e)this.delayBufferL[e]=this.delayBufferR[e]=0;this.preDelayReadIndex=0,this.preDelayWriteIndex=t}},t.setParams=function(t,e,i){this._k=this.updateStaticCurveParameters(t,e,i);t=1/this.saturate(1,this._k),t=Math.pow(t,.6);this._masterLinearGain=Math.pow(10,.05*this.dbPostGain)*t},t.kneeCurve=function(t,e){return t<this.linearThreshold?t:this.linearThreshold+(1-Math.exp(-e*(t-this.linearThreshold)))/e},t.saturate=function(t,e){return t<this.kneeThreshold?this.kneeCurve(t,e):(e=t?20*Math.log(t)*Math.LOG10E:-1e3,t=this.ykneeThresholdDb+this.slope*(e-this.kneeThresholdDb),Math.pow(10,.05*t))},t.slopeAt=function(t,e){var i,s,n;return t<this.linearThreshold?1:(n=1.001*t,i=t?20*Math.log(t)*Math.LOG10E:-1e3,s=n?20*Math.log(n)*Math.LOG10E:-1e3,t=this.kneeCurve(t,e),n=this.kneeCurve(n,e),e=t?20*Math.log(t)*Math.LOG10E:-1e3,((n?20*Math.log(n)*Math.LOG10E:-1e3)-e)/(s-i))},t.kAtSlope=function(t){for(var e=this.dbThreshold+this.dbKnee,i=Math.pow(10,.05*e),s=.1,n=1e4,r=5,a=0;a<15;++a)this.slopeAt(i,r)<t?n=r:s=r,r=Math.sqrt(s*n);return r},t.updateStaticCurveParameters=function(t,e,i){this.dbThreshold=t,this.linearThreshold=Math.pow(10,.05*t),this.dbKnee=e,this.ratio=i,this.slope=1/this.ratio,this.kneeThresholdDb=t+e,this.kneeThreshold=Math.pow(10,.05*this.kneeThresholdDb);i=this.kAtSlope(1/this.ratio),t=this.kneeCurve(this.kneeThreshold,i);return this.ykneeThresholdDb=t?20*Math.log(t)*Math.LOG10E:-1e3,this._k=i,this._k},t.process=function(t,e){for(var i=1-this.effectBlend,s=this.effectBlend,n=this._k,r=this._masterLinearGain,a=this._satReleaseFrames,o=this._kA,h=this._kB,u=this._kC,l=this._kD,c=this._kE,f=t.length/64,p=0,d=this.detectorAverage,m=this.compressorGain,v=this.maxAttackCompressionDiffDb,g=1/this._attackFrames,b=this.preDelayReadIndex,_=this.preDelayWriteIndex,y=this.detectorAverage,w=this.delayBufferL,x=this.delayBufferR,k=this.meteringGain,A=this.meteringReleaseK,S=0;S<f;++S){for(var T,I=Math.asin(d)/(.5*Math.PI),R=m<I,O=m/I,D=O?20*Math.log(O)*Math.LOG10E:-1e3,M=(D!==1/0&&!isNaN(D)||(D=-1),T=R?(v=-1,R=(O=(O=D)<-12?0:0<O?3:.25*(O+12))*O,Math.pow(10,.05*(5/(o+h*O+u*R+l*(R*O)+c*(R*R))))):((-1===v||v<D)&&(v=D),O=.25/Math.max(.5,v),1-Math.pow(O,g)),64);M--;){var L=0,j=.5*(t[p]+e[p]),j=(w[_]=t[p],x[_]=e[p],j<0&&(j*=-1),L=L<j?j:L),L=(j<0&&(j*=-1),this.saturate(j,n)),L=j<=1e-4?1:L/j,j=L?-20*Math.log(L)*Math.LOG10E:1e3,j=(j=j<2?2:j)/a,j=Math.pow(10,.05*j)-1,L=(1<(y+=(L-y)*(y<L?j:1))&&(y=1),T<1?m+=(I-m)*T:1<(m*=T)&&(m=1),Math.sin(.5*Math.PI*m)),j=i+s*r*L,L=20*Math.log(L)*Math.LOG10E;L<k?k=L:k+=(L-k)*A,t[p]=w[b]*j,e[p]=x[b]*j,p++,b=b+1&1023,_=_+1&1023}y<1e-6&&(y=1e-6),m<1e-6&&(m=1e-6)}this.preDelayReadIndex=b,this.preDelayWriteIndex=_,this.detectorAverage=y,this.compressorGain=m,this.maxAttackCompressionDiffDb=v,this.meteringGain=k},t.reset=function(){this.detectorAverage=0,this.compressorGain=1,this.meteringGain=1;for(var t=0,e=this.delayBufferL.length;t<e;++t)this.delayBufferL[t]=this.delayBufferR[t]=0;this.preDelayReadIndex=0,this.preDelayWriteIndex=256,this.maxAttackCompressionDiffDb=-1},i.modules.Compressor=e}(timbre),function(s){"use strict";function r(){}r.prototype.decode=function(t,e,i){if("string"==typeof t){if(/\.wav$/.test(t))return r.wav_decode(t,e,i);if(r.ogg_decode&&/\.ogg$/.test(t))return r.ogg_decode(t,e,i);if(r.mp3_decode&&/\.mp3$/.test(t))return r.mp3_decode(t,e,i)}else if("object"==typeof t){if("wav"===t.type)return r.wav_decode(t.data,e,i);if(r.ogg_decode&&"ogg"===t.type)return r.ogg_decode(t.data,e,i);if(r.mp3_decode&&"mp3"===t.type)return r.mp3_decode(t.data,e,i)}return r.webkit_decode?r.webkit_decode("object"==typeof t&&t.data||t,e,i):r.moz_decode?r.moz_decode(t,e,i):void e(!1)},s.modules.Decoder=r,"browser"===s.envtype?r.getBinaryWithPath=function(t,e){s.fn.fix_iOS6_1_problem(!0);var i=new XMLHttpRequest;i.open("GET",t),i.responseType="arraybuffer",i.onreadystatechange=function(){4===i.readyState&&(i.response?e(new Uint8Array(i.response)):void 0!==i.responseBody&&e(new Uint8Array(VBArray(i.responseBody).toArray())),s.fn.fix_iOS6_1_problem(!1))},i.send()}:r.getBinaryWithPath=function(t,e){e("no support")};function n(t,e,i){if("RIFF"!==String.fromCharCode(t[0],t[1],t[2],t[3]))return e(!1);if(t[4]+(t[5]<<8)+(t[6]<<16)+(t[7]<<24)+8!==t.length)return e(!1);if("WAVE"!==String.fromCharCode(t[8],t[9],t[10],t[11]))return e(!1);if("fmt "!==String.fromCharCode(t[12],t[13],t[14],t[15]))return e(!1);for(var s=t[22]+(t[23]<<8),n=t[24]+(t[25]<<8)+(t[26]<<16)+(t[27]<<24),r=t[34]+(t[35]<<8),a=36;a<t.length&&"data"!==String.fromCharCode(t[a],t[a+1],t[a+2],t[a+3]);)a+=1;if(a>=t.length)return e(!1);var o,h,u,l=t[a+=4]+(t[a+1]<<8)+(t[a+2]<<16)+(t[a+3]<<24),c=(l/s>>1)/n;if(l>t.length-(a+=4))return e(!1);o=new Float32Array(c*n|0),2===s&&(h=new Float32Array(o.length),u=new Float32Array(o.length)),e({samplerate:n,channels:s,buffer:[o,h,u],duration:c}),8===r?t=new Int8Array(t.buffer,a):16===r?t=new Int16Array(t.buffer,a):32===r?t=new Int32Array(t.buffer,a):24===r&&(t=function(t){for(var e,i,s,n=new Int32Array(t.length/3),r=0,a=t.length,o=0;r<a;)s=t[r++],e=t[r++],i=t[r++],n[o++]=8388608&(s=s+(e<<8)+(i<<16))?s-16777216:s;return n}(new Uint8Array(t.buffer,a)));var f,p,d,m=1/((1<<r-1)-1);if(2===s)for(a=p=0,f=o.length;a<f;++a)d=h[a]=t[p++]*m,d+=u[a]=t[p++]*m,o[a]=.5*d;else for(a=0,f=o.length;a<f;++a)o[a]=t[a]*m;i()}r.wav_decode=function(t,e,i){"string"==typeof t?r.getBinaryWithPath(t,function(t){n(t,e,i)}):n(t,e,i)},r.webkit_decode=function(){var l,n;if(void 0!==s.fn._audioContext)return l=s.fn._audioContext,n=function(t,e,i){var s,n,r;if("string"==typeof t)return i(!1);try{a=l.createBuffer(t.buffer,!1)}catch(t){return e(!1)}t=l.sampleRate,2===(s=a.numberOfChannels)?(n=a.getChannelData(0),r=a.getChannelData(1)):n=r=a.getChannelData(0);for(var a=n.length/t,o=new Float32Array(n),h=0,u=o.length;h<u;++h)o[h]=.5*(o[h]+r[h]);e({samplerate:t,channels:s,buffer:[o,n,r],duration:a}),i()},function(t,e,i){var s;t instanceof File?((s=new FileReader).onload=function(t){n(new Uint8Array(t.target.result),e,i)},s.readAsArrayBuffer(t)):"string"==typeof t?r.getBinaryWithPath(t,function(t){n(t,e,i)}):n(t,e,i)}}(),r.moz_decode=function(){if("function"==typeof Audio&&"function"==typeof(new Audio).mozSetup)return function(t,e,i){var s,n,r,a,o,h,u=0,l=new Audio(t);l.volume=0,l.addEventListener("loadedmetadata",function(){s=l.mozSampleRate,n=l.mozChannels,h=l.duration,r=new Float32Array(l.duration*s|0),2===n&&(a=new Float32Array(l.duration*s|0),o=new Float32Array(l.duration*s|0)),2===n?l.addEventListener("MozAudioAvailable",function(t){for(var e,i=t.frameBuffer,s=0,n=i.length;s<n;s+=2)e=a[u]=i[s],e+=o[u]=i[s+1],r[u]=.5*e,u+=1},!1):l.addEventListener("MozAudioAvailable",function(t){for(var e=t.frameBuffer,i=0,s=e.length;i<s;++i)r[i]=e[i],u+=1},!1),l.play(),setTimeout(function(){e({samplerate:s,channels:n,buffer:[r,a,o],duration:h})},1e3)},!1),l.addEventListener("ended",function(){i()},!1),l.load()}}()}(timbre),function(t){"use strict";function e(t){this.samplerate=t||44100,this.value=r,this.status=d,this.curve="linear",this.step=1,this.releaseNode=null,this.loopNode=null,this.emit=null,this._envValue=new n(t),this._table=[],this._initValue=r,this._curveValue=0,this._defaultCurveType=p,this._index=0,this._counter=0}var r=e.ZERO=1e-6,p=(e.CurveTypeSet=0,e.CurveTypeLin=1),d=(e.CurveTypeExp=2,e.CurveTypeSin=3,e.CurveTypeWel=4,e.CurveTypeCurve=5,e.CurveTypeSqr=6,e.CurveTypeCub=7,e.StatusWait=0),i=(e.StatusGate=1,e.StatusSustain=2,e.StatusRelease=3,e.StatusEnd=4,{set:0,lin:p,linear:p,exp:2,exponential:2,sin:3,sine:3,wel:4,welch:4,sqr:6,squared:6,cub:7,cubed:7}),s=(e.CurveTypeDict=i,e.prototype);function n(t){this.samplerate=t,this.value=r,this.step=1,this._curveType=p,this._curveValue=0,this._grow=0,this._a2=0,this._b1=0,this._y1=0,this._y2=0}s.clone=function(){var t=new e(this.samplerate);return t._table=this._table,t._initValue=this._initValue,t.setCurve(this.curve),null!==this.releaseNode&&t.setReleaseNode(this.releaseNode+1),null!==this.loopNode&&t.setLoopNode(this.loopNode+1),t.setStep(this.step),t.reset(),t},s.setTable=function(t){this._initValue=t[0],this._table=t.slice(1),this.value=this._envValue.value=this._initValue,this._index=0,this._counter=0,this.status=d},s.setCurve=function(t){"number"==typeof t?(this._defaultCurveType=5,this._curveValue=t):this._defaultCurveType=i[t]||null,this.curve=t},s.setReleaseNode=function(t){"number"==typeof t&&0<t&&(this.releaseNode=t-1)},s.setLoopNode=function(t){"number"==typeof t&&0<t&&(this.loopNode=t-1)},s.setStep=function(t){this.step=this._envValue.step=t},s.reset=function(){this.value=this._envValue.value=this._initValue,this._index=0,this._counter=0,this.status=d},s.release=function(){null!==this.releaseNode&&this._index<=this.releaseNode&&(this._counter=0,this._index=this.releaseNode,this.status=3)},s.getInfo=function(t){for(var e=this._table,i=0,s=1/0,n=1/0,r=!1,a=0,o=e.length;a<o;++a){this.loopNode===a&&(s=i),this.releaseNode===a&&(i<t?i+=t:i=t,n=i);var h=e[a];Array.isArray(h)&&(i+=h[1])}return s!==1/0&&n===1/0&&(i+=t,r=!0),{totalDuration:i,loopBeginTime:s,releaseBeginTime:n,isEndlessLoop:r}},s.calcStatus=function(){var t,e,i,s=this.status,n=this._table,r=this._index,a=this._counter,o=this._curveValue,h=this._defaultCurveType,u=this.loopNode,l=this.releaseNode,c=this._envValue,f=null;switch(s){case d:case 4:break;case 1:case 3:for(;a<=0;)r>=n.length?1===s&&null!==u?r=u:(s=4,a=1/0,i=0,f="ended"):1===s&&r===l?null!==u&&u<l?r=u:(s=2,a=1/0,i=0,f="sustained"):(t=(e=n[r++])[0],5===(i=null===e[2]?h:e[2])&&(o=e[3],Math.abs(o)<.001)&&(i=p),e=e[1],a=c.setNext(t,e,i,o))}return this.status=s,this.emit=f,this._index=r,this._counter=a,s},s.next=function(){return 1&this.calcStatus()&&(this.value=this._envValue.next()||r),--this._counter,this.value},s.process=function(t){var e=this._envValue,i=t.length;if(1&this.calcStatus())for(n=0;n<i;++n)t[n]=e.next()||r;else for(var s=this.value||r,n=0;n<i;++n)t[n]=s;this.value=t[i-1],this._counter-=t.length},n.prototype.setNext=function(t,e,i,s){var n,r,a,o,h,u,l=this.step,c=this.value,f=.001*e*this.samplerate/l|0;switch(f<1&&(f=1,i=0),i){case 0:this.value=t;break;case p:n=(t-c)/f;break;case 2:n=0!==c?Math.pow(t/c,1/f):0;break;case 3:r=Math.PI/f,a=.5*(t+c),o=2*Math.cos(r),u=(h=.5*(t-c))*Math.sin(.5*Math.PI-r),c=a-h;break;case 4:r=.5*Math.PI/f,o=2*Math.cos(r),u=c<=t?(a=c,h=0,-Math.sin(r)*(t-c)):(h=c-(a=t),Math.cos(r)*(c-t)),c=a+h;break;case 5:a=c+(r=(t-c)/(1-Math.exp(s))),o=r,n=Math.exp(s/f);break;case 6:h=Math.sqrt(c),n=((u=Math.sqrt(t))-h)/f;break;case 7:h=Math.pow(c,.33333333),n=((u=Math.pow(t,.33333333))-h)/f}return this.next=m[i],this._grow=n,this._a2=a,this._b1=o,this._y1=h,this._y2=u,f};var m=[];m[0]=function(){return this.value},m[p]=function(){return this.value+=this._grow,this.value},m[2]=function(){return this.value*=this._grow,this.value},m[3]=function(){var t=this._b1*this._y1-this._y2;return this.value=this._a2-t,this._y2=this._y1,this._y1=t,this.value},m[4]=function(){var t=this._b1*this._y1-this._y2;return this.value=this._a2+t,this._y2=this._y1,this._y1=t,this.value},m[5]=function(){return this._b1*=this._grow,this.value=this._a2-this._b1,this.value},m[6]=function(){return this._y1+=this._grow,this.value=this._y1*this._y1,this.value},m[7]=function(){return this._y1+=this._grow,this.value=this._y1*this._y1*this._y1,this.value},n.prototype.next=m[0],t.modules.Envelope=e,t.modules.EnvelopeValue=n}(timbre),function(h){"use strict";function t(t){t="number"==typeof t?t:512,t=1<<Math.ceil(Math.log(t)*Math.LOG2E),this.length=t,this.buffer=new h.fn.SignalArray(t),this.real=new h.fn.SignalArray(t),this.imag=new h.fn.SignalArray(t),this._real=new h.fn.SignalArray(t),this._imag=new h.fn.SignalArray(t),this.mag=new h.fn.SignalArray(t>>1),this.minDecibels=-30,this.maxDecibels=-100;t=l.get(t);this._bitrev=t.bitrev,this._sintable=t.sintable,this._costable=t.costable}var n,r,i,s,a,o,u,e=t.prototype,l=(e.setWindow=function(t){if("string"==typeof t){var e=/([A-Za-z]+)(?:\(([01]\.?\d*)\))?/.exec(t);if(null!==e){var i=e[1].toLowerCase(),s=void 0!==e[2]?+e[2]:.25,n=c[i];if(n){this._window||(this._window=new h.fn.SignalArray(this.length));for(var r=this._window,a=0,o=this.length,s=s<0?0:1<s?1:s;a<o;++a)r[a]=n(a,o,s);this.windowName=t}}}},e.forward=function(t){var e,i,s,n,r,a,o,h,u,l,c=this.buffer,f=this.real,p=this.imag,d=this._window,m=this._bitrev,v=this._sintable,g=this._costable,b=c.length;if(d)for(x=0;x<b;++x)c[x]=t[x]*d[x];else c.set(t);for(x=0;x<b;++x)f[x]=c[m[x]],p[x]=0;for(i=1;i<b;i=s)for(r=b/(s=i+i),e=n=0;e<i;e++){for(a=g[n],o=v[n],x=e;x<b;x+=s)u=o*p[h=x+i]+a*f[h],l=a*p[h]-o*f[h],f[h]=f[x]-u,f[x]+=u,p[h]=p[x]-l,p[x]+=l;n+=r}for(var _,y,w=this.mag,x=0;x<b;++x)_=f[x],y=p[x],w[x]=Math.sqrt(_*_+y*y);return{real:f,imag:p}},e.inverse=function(t,e){for(var i,s,n,r,a,o,h,u,l,c,f=this.buffer,p=this._real,d=this._imag,m=this._bitrev,v=this._sintable,g=this._costable,b=f.length,_=0;_<b;++_)i=m[_],p[_]=+t[i],d[_]=-e[i];for(s=1;s<b;s=n)for(a=b/(n=s+s),i=r=0;i<s;i++){for(o=g[r],h=v[r],_=i;_<b;_+=n)l=h*d[u=_+s]+o*p[u],c=o*d[u]-h*p[u],p[u]=p[_]-l,p[_]+=l,d[u]=d[_]-c,d[_]+=c;r+=a}for(_=0;_<b;++_)f[_]=p[_]/b;return f},e.getFrequencyData=function(t){var e=this.minDecibels,i=Math.min(this.mag.length,t.length);if(i)for(var s,n=this.mag,r=0,a=0;a<i;++a)s=n[a],t[a]=s?20*Math.log(s)*Math.LOG10E:e,r<t[a]&&(r=t[a]);return t},{get:function(o){return l[o]||function(){for(var t=function(){for(var t,e,i=new Int16Array(o),s=o>>1,n=t=0;i[n]=t,!(++n>=o);){for(e=s;e<=t;)t-=e,e>>=1;t+=e}return i}(),e=Math.floor(Math.log(o)/Math.LN2),i=new h.fn.SignalArray((1<<e)-1),s=new h.fn.SignalArray((1<<e)-1),n=2*Math.PI,r=0,a=i.length;r<a;++r)i[r]=Math.sin(r/o*n),s[r]=Math.cos(r/o*n);return l[o]={bitrev:t,sintable:i,costable:s},l[o]}()}}),c=(n=Math.PI,r=2*Math.PI,i=Math.abs,s=Math.pow,a=Math.cos,o=Math.sin,u=Math.E,{rectangular:function(){return 1},hann:function(t,e){return.5*(1-a(r*t/(e-1)))},hamming:function(t,e){return.54-.46*a(r*t/(e-1))},tukery:function(t,e,i){return t<i*(e-1)/2?.5*(1+a(n*(2*t/(i*(e-1))-1))):(e-1)*(1-i/2)<t?.5*(1+a(n*(2*t/(i*(e-1))-2/i+1))):1},cosine:function(t,e){return o(n*t/(e-1))},lanczos:function(t,e){return o(n*(t=2*t/(e-1)-1))/(n*t)},triangular:function(t,e){return 2/(e+1)*((e+1)/2-i(t-(e-1)/2))},bartlett:function(t,e){return 2/(e-1)*((e-1)/2-i(t-(e-1)/2))},gaussian:function(t,e,i){return s(u,-.5*s((t-(e-1)/2)/(i*(e-1)/2),2))},bartlettHann:function(t,e){return.62-.48*i(t/(e-1)-.5)-.38*a(r*t/(e-1))},blackman:function(t,e,i){var s=i/2;return(1-i)/2-.5*a(r*t/(e-1))+s*a(4*n*t/(e-1))}});h.modules.FFT=t}(timbre),function(r){"use strict";function e(t){this.samplerate=t||44100,this.wave=null,this.step=1,this.frequency=0,this.value=0,this.phase=0,this.feedback=!1,this._x=0,this._lastouts=0,this._coeff=m/this.samplerate,this._radtoinc=m/(2*Math.PI)}var m=1024,v=1023,t=e.prototype;t.setWave=function(t){var e,i,s=this.wave;if(this.wave||(this.wave=new Float32Array(1025)),"function"==typeof t)for(e=0;e<m;++e)s[e]=t(e/m);else if(r.fn.isSignalArray(t))if(t.length===s.length)s.set(t);else for(i=t.length/m,e=0;e<m;++e)s[e]=t[e*i|0];else"string"==typeof t&&void 0!==(i=n(t))&&this.wave.set(i);this.wave[m]=this.wave[0]},t.clone=function(){var t=new e(this.samplerate);return t.wave=this.wave,t.step=this.step,t.frequency=this.frequency,t.value=this.value,t.phase=this.phase,t.feedback=this.feedback,t},t.reset=function(){this._x=0},t.next=function(){var t=this._x,e=t+this.phase*this._radtoinc|0;return this.value=this.wave[e&v],t+=this.frequency*this._coeff*this.step,m<t&&(t-=m),this._x=t,this.value},t.process=function(t){var e,i,s,n,r,a=this.wave,o=this._radtoinc,h=this._x,u=this.frequency*this._coeff,l=this.step;if(this.feedback){var c=this._lastouts;for(o*=this.phase,p=0;p<l;++p)s=(e=h+c*o)-(i=0|e),n=a[i&=v],r=a[i+1],t[p]=c=n+s*(r-n),h+=u;this._lastouts=c}else for(var f=this.phase*o,p=0;p<l;++p)s=(e=h+f)-(i=0|e),n=a[i&=v],r=a[i+1],t[p]=n+s*(r-n),h+=u;m<h&&(h-=m),this._x=h,this.value=t[t.length-1]},t.processWithFreqArray=function(t,e){var i,s,n,r,a,o=this.wave,h=this._radtoinc,u=this._x,l=this._coeff,c=this.step;if(this.feedback){var f=this._lastouts;for(h*=this.phase,d=0;d<c;++d)n=(i=u+f*h)-(s=0|i),r=o[s&=v],a=o[s+1],t[d]=f=r+n*(a-r),u+=e[d]*l;this._lastouts=f}else for(var p=this.phase*this._radtoinc,d=0;d<c;++d)n=(i=u+p)-(s=0|i),r=o[s&=v],a=o[s+1],t[d]=r+n*(a-r),u+=e[d]*l;m<u&&(u-=m),this._x=u,this.value=t[t.length-1]},t.processWithPhaseArray=function(t,e){var i,s,n,r,a,o,h=this.wave,u=this._radtoinc,l=this._x,c=this.frequency*this._coeff,f=this.step;if(this.feedback){var p=this._lastouts;for(u*=this.phase,o=0;o<f;++o)n=(i=l+p*u)-(s=0|i),r=h[s&=v],a=h[s+1],t[o]=p=r+n*(a-r),l+=c;this._lastouts=p}else for(o=0;o<f;++o)n=(i=l+e[o]*u)-(s=0|i),r=h[s&=v],a=h[s+1],t[o]=r+n*(a-r),l+=c;m<l&&(l-=m),this._x=l,this.value=t[t.length-1]},t.processWithFreqAndPhaseArray=function(t,e,i){var s,n,r,a,o,h,u=this.wave,l=this._radtoinc,c=this._x,f=this._coeff,p=this.step;if(this.feedback){var d=this._lastouts;for(l*=this.phase,h=0;h<p;++h)r=(s=c+d*l)-(n=0|s),a=u[n&=v],o=u[n+1],t[h]=d=a+r*(o-a),c+=e[h]*f;this._lastouts=d}else for(h=0;h<p;++h)r=(s=c+i[h]*m)-(n=0|s),a=u[n&=v],o=u[n+1],t[h]=a+r*(o-a),c+=e[h]*f;m<c&&(c-=m),this._x=c,this.value=t[t.length-1]};var n=function(t){var e,i=y[t];if(void 0!==i)return i="function"==typeof i?i():i;if(null!==(e=/^([\-+]?)(\w+)(?:\((@[0-7])?:?(\d+)?\))?$/.exec(t))&&void 0!==(i=function(t,e,i,s){var n,r,a,o,h,u=y[e];if(void 0!==u){switch("function"==typeof u&&(u=u()),i){case"@1":for(r=512;r<1024;++r)u[r]=0;break;case"@2":for(r=512;r<1024;++r)u[r]=Math.abs(u[r]);break;case"@3":for(r=256;r<512;++r)u[r]=0;for(r=512;r<768;++r)u[r]=Math.abs(u[r]);for(r=768;r<1024;++r)u[r]=0;break;case"@4":for(n=new Float32Array(1024),r=0;r<512;++r)n[r]=u[r<<1];u=n;break;case"@5":for(n=new Float32Array(1024),r=0;r<512;++r)n[r]=Math.abs(u[r<<1]);u=n}if(void 0!==s&&50!==s){for(s=(s*=.01)<0?0:1<s?1:s,n=new Float32Array(1024),a=1024*s|0,r=0;r<a;++r)n[r]=u[r/a*512|0];for(h=1024-a,o=0;r<1024;++r,++o)n[r]=u[o/h*512+512|0];u=n}if("+"===t)for(r=0;r<1024;++r)u[r]=.5*u[r]+.5;else if("-"===t)for(r=0;r<1024;++r)u[r]*=-1;return u}}(e[1],e[2],e[3],e[4])))return y[t]=i;if(null!==(e=/^wavb\(((?:[0-9a-fA-F][0-9a-fA-F])+)\)$/.exec(t))){var s=e[1],n=new Float32Array(1024),r=s.length>>1;if(-1!==[2,4,8,16,32,64,128,256,512,1024].indexOf(r))for(var a=0,o=0;a<r;++a)for(var h=128&(h=parseInt(s.substr(2*a,2),16))?(h-256)/128:h/127,u=0,l=1024/r;u<l;++u)n[o++]=h;return n}if(null!==(e=/^wavc\(([0-9a-fA-F]{8})\)$/.exec(t))){var i=e[1],c=new Float32Array(1024);if(8===i.length){var f=parseInt(i,16),p=new Float32Array(8);for(p[0]=1,_=0;_<7;++_)p[_+1]=.0625*(15&f),f>>=4;for(_=0;_<8;++_)for(var d=0,m=(_+1)/1024,v=0;v<1024;++v)c[v]+=Math.sin(2*Math.PI*d)*p[_],d+=m;for(var g,b=0,_=0;_<1024;++_)b<(g=Math.abs(c[_]))&&(b=g);if(0<b)for(_=0;_<1024;++_)c[_]/=b}return c}},y=(e.getWavetable=n,e.setWavetable=function(t,e){var i,s,n=new Float32Array(1024);if("function"==typeof e)for(s=0;s<1024;++s)n[s]=e(s/1024);else if(r.fn.isSignalArray(e))if(e.length===n.length)n.set(e);else for(i=e.length/1024,s=0;s<1024;++s)n[s]=e[s*i|0];y[t]=n},{sin:function(){for(var t=new Float32Array(1024),e=0;e<1024;++e)t[e]=Math.sin(2*Math.PI*(e/1024));return t},cos:function(){for(var t=new Float32Array(1024),e=0;e<1024;++e)t[e]=Math.cos(2*Math.PI*(e/1024));return t},pulse:function(){for(var t=new Float32Array(1024),e=0;e<1024;++e)t[e]=e<512?1:-1;return t},tri:function(){for(var t,e=new Float32Array(1024),i=0;i<1024;++i)t=i/1024-.25,e[i]=1-4*Math.abs(Math.round(t)-t);return e},saw:function(){for(var t,e=new Float32Array(1024),i=0;i<1024;++i)e[i]=2*((t=i/1024)-Math.round(t));return e},fami:function(){for(var t=[0,.125,.25,.375,.5,.625,.75,.875,.875,.75,.625,.5,.375,.25,.125,0,-.125,-.25,-.375,-.5,-.625,-.75,-.875,-1,-1,-.875,-.75,-.625,-.5,-.375,-.25,-.125],e=new Float32Array(1024),i=0;i<1024;++i)e[i]=t[i/1024*t.length|0];return e},konami:function(){for(var t=[-.625,-.875,-.125,.75,.5,.125,.5,.75,.25,-.125,.5,.875,.625,0,.25,.375,-.125,-.75,0,.625,.125,-.5,-.375,-.125,-.75,-1,-.625,0,-.375,-.875,-.625,-.25],e=new Float32Array(1024),i=0;i<1024;++i)e[i]=t[i/1024*t.length|0];return e}});r.modules.Oscillator=e}(timbre),function(r){"use strict";var a=[1116,1188,1277,1356,1422,1491,1557,1617],o=[225,556,441,341];function t(t,e){var i,s=(this.samplerate=t)/44100,n=2*a.length;for(this.comb=new Array(n),this.combout=new Array(n),i=0;i<n;++i)this.comb[i]=new h(a[i%a.length]*s),this.combout[i]=new r.fn.SignalArray(e);for(n=2*o.length,this.allpass=new Array(n),i=0;i<n;++i)this.allpass[i]=new u(o[i%o.length]*s);this.outputs=[new r.fn.SignalArray(e),new r.fn.SignalArray(e)],this.damp=0,this.wet=.33,this.setRoomSize(.5),this.setDamp(.5)}var e=t.prototype;function h(t){this.buffer=new r.fn.SignalArray(0|t),this.buffersize=this.buffer.length,this.bufidx=0,this.feedback=0,this.filterstore=0,this.damp=0}function u(t){this.buffer=new r.fn.SignalArray(0|t),this.buffersize=this.buffer.length,this.bufidx=0}e.setRoomSize=function(t){var e=this.comb,i=.28*t+.7;this.roomsize=t,e[0].feedback=e[1].feedback=e[2].feedback=e[3].feedback=e[4].feedback=e[5].feedback=e[6].feedback=e[7].feedback=e[8].feedback=e[9].feedback=e[10].feedback=e[11].feedback=e[12].feedback=e[13].feedback=e[14].feedback=e[15].feedback=i},e.setDamp=function(t){var e=this.comb,i=.4*t;this.damp=t,e[0].damp=e[1].damp=e[2].damp=e[3].damp=e[4].damp=e[5].damp=e[6].damp=e[7].damp=e[8].damp=e[9].damp=e[10].damp=e[11].damp=e[12].damp=e[13].damp=e[14].damp=e[15].damp=i},e.process=function(t,e){var i,s=this.comb,n=this.combout,r=this.allpass,a=this.outputs[0],o=this.outputs[1],h=this.wet,u=1-h,l=t.length;for(s[0].process(t,n[0]),s[1].process(t,n[1]),s[2].process(t,n[2]),s[3].process(t,n[3]),s[4].process(t,n[4]),s[5].process(t,n[5]),s[6].process(t,n[6]),s[7].process(t,n[7]),s[8].process(e,n[8]),s[9].process(e,n[9]),s[10].process(e,n[10]),s[11].process(e,n[11]),s[12].process(e,n[12]),s[13].process(e,n[13]),s[14].process(e,n[14]),s[15].process(e,n[15]),i=0;i<l;++i)a[i]=n[0][i]+n[1][i]+n[2][i]+n[3][i]+n[4][i]+n[5][i]+n[6][i]+n[7][i],o[i]=n[8][i]+n[9][i]+n[10][i]+n[11][i]+n[12][i]+n[13][i]+n[14][i]+n[15][i];for(r[0].process(a,a),r[1].process(a,a),r[2].process(a,a),r[3].process(a,a),r[4].process(o,o),r[5].process(o,o),r[6].process(o,o),r[7].process(o,o),i=0;i<l;++i)t[i]=a[i]*h+t[i]*u,e[i]=o[i]*h+e[i]*u},h.prototype.process=function(t,e){for(var i,s,n=this.buffer,r=this.buffersize,a=this.bufidx,o=this.filterstore,h=this.feedback,u=this.damp,l=1-u,c=t.length,f=0;f<c;++f)i=.015*t[f],s=n[a],n[a]=i+(o=s*l+o*u)*h,++a>=r&&(a=0),e[f]=s;this.bufidx=a,this.filterstore=o},u.prototype.process=function(t,e){for(var i,s,n,r=this.buffer,a=this.buffersize,o=this.bufidx,h=t.length,u=0;u<h;++u)s=-(i=t[u])+(n=r[o]),r[o]=i+.5*n,++o>=a&&(o=0),e[u]=s;this.bufidx=o},r.modules.Reverb=t}(timbre),function(v){"use strict";var g=new Float32Array(60);function r(t){return new u(t)}var o={buffer:g,samplerate:1};function u(t){var e;this.fragments=[],t&&(e=t.samplerate||44100,e=t.buffer[0].length/e,this.fragments.push(new i(t,0,e)))}function i(t,e,i,s,n,r,a){t=t||o,this.buffer=t.buffer[0],this.samplerate=t.samplerate||44100,this.start=e,this._duration=i,this.reverse=s||!1,this.pitch=n||100,this.stretch=r||!1,this.pan=a||50}function s(t,e){this.tape=t,this.fragments=t.fragments,this.samplerate=e||44100,this.isEnded=!1,this.buffer=null,this.bufferIndex=0,this.bufferIndexIncr=0,this.bufferBeginIndex=0,this.bufferEndIndex=0,this.fragment=null,this.fragmentIndex=0,this.panL=.5,this.panR=.5}r.silence=function(t){return new r(o).slice(0,1).fill(t)},r.join=function(t){for(var e=new u,i=0;i<t.length;i++)t[i]instanceof u&&e.add_fragments(t[i].fragments);return e},(r.Tape=u).prototype.add_fragment=function(t){return this.fragments.push(t),this},u.prototype.add_fragments=function(t){for(var e=0;e<t.length;e++)this.fragments.push(t[e]);return this},u.prototype.duration=function(){for(var t=0,e=0;e<this.fragments.length;e++)t+=this.fragments[e].duration();return t},u.prototype.cut=u.prototype.slice=function(t,e){for(var i=this.duration(),s=(i<t+e&&(e=i-t),new u),n=t,r=e,a=0;a<this.fragments.length;a++){var o=this.fragments[a].create(n,r),h=o[0],n=o[1],r=o[2];if(h&&s.add_fragment(h),0===r)break}return s},u.prototype.concat=function(t){var e=new u;return e.add_fragments(this.fragments),e.add_fragments(t.fragments),e},u.prototype.times=u.prototype.loop=function(t){for(var e=[],i=0;i<this.fragments.length;i++)e.push(this.fragments[i].clone());var s=new u;for(i=0;i<t;i++)s.add_fragments(e);return s},u.prototype.split=function(t){for(var e=this.duration()/t,i=[],s=0;s<t;s++)i.push(this.slice(s*e,e));return i},u.prototype.fill=function(t){var e=this.duration();if(0===e)throw"EmptyFragment";var i=t%e;return this.loop(t/e|0).plus(this.slice(0,i))},u.prototype.replace=function(t,e,i){var s=new u,e=t+e,n=(s=s.plus(this.slice(0,t))).duration(),t=(s=(s=n<t?s.plus(r.silence(t-n)):s).plus(i),this.duration());return s=e<t?s.plus(this.slice(e,t-e)):s},u.prototype.reverse=function(){for(var t=new u,e=this.fragments.length;e--;){var i=this.fragments[e].clone();i.reverse=!i.isReversed(),t.add_fragment(i)}return t},u.prototype.pitch=function(t,e){var i=new u;e=e||!1;for(var s=0;s<this.fragments.length;s++){var n=this.fragments[s].clone();n.pitch*=.01*t,n.stretch=e,i.add_fragment(n)}return i},u.prototype.stretch=function(t){return this.pitch(1/(.01*t)*100,!0)},u.prototype.pan=function(t){var e=new u;100<t?t=100:t<0&&(t=0);for(var i=0;i<this.fragments.length;i++){var s=this.fragments[i].clone();s.pan=t,e.add_fragment(s)}return e},u.prototype.silence=function(){return r.silence(this.duration())},u.prototype.join=function(t){for(var e=new u,i=0;i<t.length;i++)t[i]instanceof u&&e.add_fragments(t[i].fragments);return e},u.prototype.getBuffer=function(){var t=44100,e=new s(this,t=0<this.fragments.length?this.fragments[0].samplerate:t),i=this.duration()*t|0;return{samplerate:t,buffer:e.fetch(i)}},i.prototype.duration=function(){return this._duration*(100/this.pitch)},i.prototype.original_duration=function(){return this._duration},i.prototype.isReversed=function(){return this.reverse},i.prototype.isStretched=function(){return this.stretched},i.prototype.create=function(t,e){var i,s=this.duration();return s<=t?[null,t-s,e]:(s<=t+e?e-=i=s-t:(i=e,e=0),(s=this.clone()).start=this.start+t*this.pitch*.01,s._duration=i*this.pitch*.01,s.reverse=!1,[s,0,e])},i.prototype.clone=function(){var t=new i;return t.buffer=this.buffer,t.samplerate=this.samplerate,t.start=this.start,t._duration=this._duration,t.reverse=this.reverse,t.pitch=this.pitch,t.stretch=this.stretch,t.pan=this.pan,t},r.Fragment=i,(r.TapeStream=s).prototype.reset=function(){return this.isEnded=!1,this.buffer=null,this.bufferIndex=0,this.bufferIndexIncr=0,this.bufferBeginIndex=0,this.bufferEndIndex=0,this.fragment=null,this.fragmentIndex=0,this.panL=.5,this.panR=.5,this.isLooped=!1,this},s.prototype.fetch=function(t){var e=new v.fn.SignalArray(t),i=new v.fn.SignalArray(t),s=this.fragments;if(0!==s.length){for(var n,r=100*this.samplerate,a=this.buffer,o=this.bufferIndex,h=this.bufferIndexIncr,u=this.bufferBeginIndex,l=this.bufferEndIndex,c=this.fragment,f=this.fragmentIndex,p=this.panL,d=this.panR,m=0;m<t;m++){for(;!a||o<u||l<=o;)if(!c||f<s.length)a=(c=s[f++]).buffer,h=c.samplerate/r*c.pitch,l=(u=c.start*c.samplerate)+c.original_duration()*c.samplerate,p=1-(n=.01*c.pan),d=n,o=c.reverse?l+(h*=-1):u;else{if(!this.isLooped){this.isEnded=!0,a=g,o=h=0;break}c=a=null,f=l=u=h=o=0}e[m]=a[0|o]*p,i[m]=a[0|o]*d,o+=h}this.buffer=a,this.bufferIndex=o,this.bufferIndexIncr=h,this.bufferBeginIndex=u,this.bufferEndIndex=l,this.fragment=c,this.fragmentIndex=f,this.panL=p,this.panR=d}return[e,i]},v.modules.Scissor=r}(timbre),function(e){"use strict";function t(t){this.samplerate=t;t=Math.ceil(Math.log(1.5*t)*Math.LOG2E);this.buffersize=1<<t,this.buffermask=this.buffersize-1,this.writeBufferL=new e.fn.SignalArray(this.buffersize),this.writeBufferR=new e.fn.SignalArray(this.buffersize),this.readBufferL=this.writeBufferL,this.readBufferR=this.writeBufferR,this.delaytime=null,this.feedback=null,this.cross=null,this.mix=null,this.prevL=0,this.prevR=0,this.readIndex=0,this.writeIndex=0,this.setParams(125,.25,!1,.45)}var i=t.prototype;i.setParams=function(t,e,i,s){this.delaytime!==t&&((t=.001*(this.delaytime=t)*this.samplerate|0)>this.buffermask&&(t=this.buffermask),this.writeIndex=this.readIndex+t&this.buffermask),this.feedback!==e&&(this.feedback=e),this.cross!==i&&((this.cross=i)?(this.readBufferL=this.writeBufferR,this.readBufferR=this.writeBufferL):(this.readBufferL=this.writeBufferL,this.readBufferR=this.writeBufferR)),this.mix!==s&&(this.mix=s)},i.process=function(t,e){for(var i,s=this.readBufferL,n=this.readBufferR,r=this.writeBufferL,a=this.writeBufferR,o=this.readIndex,h=this.writeIndex,u=this.buffermask,l=this.feedback,c=this.mix,f=1-c,p=this.prevL,d=this.prevR,m=t.length,v=0;v<m;++v)i=s[o],r[h]=t[v]-i*l,t[v]=p=.5*(t[v]*f+i*c+p),i=n[o],a[h]=e[v]-i*l,e[v]=d=.5*(e[v]*f+i*c+d),o+=1,h=h+1&u;this.readIndex=o&this.buffermask,this.writeIndex=h,this.prevL=p,this.prevR=d},e.modules.StereoDelay=t}(timbre),function(a){"use strict";var o=a.fn,h=a.modules,e=(o.register("audio",function(t){t=new(o.getClass("buffer"))(t);return t.playbackState=o.FINISHED_STATE,t._.isLoaded=!1,Object.defineProperties(t,{isLoaded:{get:function(){return this._.isLoaded}}}),t.load=e,t.loadthis=i,t}),function(t){var s=this,e=this._,n=new h.Deferred(this),i=arguments,r=1;n.done(function(){s._.emit("done")}),"function"==typeof i[1]&&(n.done(i[+r]),"function"==typeof i[2])&&n.fail(i[2]),e.loadedTime=0;return(new h.Decoder).decode(t,function(t,e){var i=s._;t?(s.playbackState=o.PLAYING_STATE,i.samplerate=t.samplerate,i.channels=t.channels,i.bufferMix=null,i.buffer=t.buffer,i.phase=0,i.phaseIncr=t.samplerate/a.samplerate,i.duration=1e3*t.duration,i.currentTime=0,i.isReversed&&(i.phaseIncr*=-1,i.phase=t.buffer[0].length+i.phaseIncr),s._.emit("loadedmetadata")):n.reject(e)},function(){s._.isLoaded=!0,s._.plotFlush=!0,s._.emit("loadeddata"),n.resolveWith(s)}),n.promise()}),i=function(){return e.apply(this,arguments),this}}(timbre),function(e){"use strict";var n=e.fn,t=e.modules.FFT,l=e.modules.Biquad;function i(t){e.Object.call(this,2,t),n.fixAR(this);t=this._;t.biquad=new l(t.samplerate),t.freq=e(340),t.band=e(1),t.gain=e(0),t.plotBefore=s,t.plotRange=[-18,18],t.plotFlush=!0}n.extend(i);var s=function(t,e,i,s,n){t.lineWidth=1,t.strokeStyle="rgb(192, 192, 192)";for(var r=.5*this._.samplerate,a=1;a<=10;++a)for(var o=1;o<=4;o++){var h=a*Math.pow(10,o);h<=20||r<=h||(t.beginPath(),h=Math.log(h/20)/Math.log(r/20),t.moveTo(h=.5+(h*s+e|0),i),t.lineTo(h,i+n),t.stroke())}for(var u=n/6,a=1;a<6;a++){t.beginPath();var l=.5+(i+a*u|0);t.moveTo(e,l),t.lineTo(e+s,l),t.stroke()}},r=i.prototype,c=(Object.defineProperties(r,{type:{set:function(t){var e=this._;t!==e.biquad.type&&(e.biquad.setType(t),e.plotFlush=!0)},get:function(){return this._.biquad.type}},freq:{set:function(t){this._.freq=e(t)},get:function(){return this._.freq}},cutoff:{set:function(t){this._.freq=e(t)},get:function(){return this._.freq}},res:{set:function(t){this._.band=e(t)},get:function(){return this._.band}},Q:{set:function(t){this._.band=e(t)},get:function(){return this._.band}},band:{set:function(t){this._.band=e(t)},get:function(){return this._.band}},gain:{set:function(t){this._.gain=e(t)},get:function(){return this._.gain}}}),r.process=function(t){var e,i,s=this._;return this.tickID!==t&&(this.tickID=t,n.inputSignalAR(this),e=s.freq.process(t).cells[0][0],i=s.band.process(t).cells[0][0],t=s.gain.process(t).cells[0][0],s.prevFreq===e&&s.prevband===i&&s.prevGain===t||(s.prevFreq=e,s.prevband=i,s.prevGain=t,s.biquad.setParams(e,i,t),s.plotFlush=!0),s.bypassed||s.biquad.process(this.cells[1],this.cells[2]),n.outputSignalAR(this)),this},new t(2048)),f=e.Object.prototype.plot;r.plot=function(t){if(this._.plotFlush){var e,i,s,n,r=new l(this._.samplerate),a=(r.setType(this.type),r.setParams(this.freq.valueOf(),this.band.valueOf(),this.gain.valueOf()),new Float32Array(c.length)),o=(a[0]=1,r.process(a,a),c.forward(a),new Float32Array(512)),h=.5*this._.samplerate,u=new Float32Array(512);for(c.getFrequencyData(u),e=0;e<512;++e)s=(i=20*Math.pow(h/20,e/512)/(h/u.length))-(i=0|i),0==i?n=u[i]:n=(1-s)*u[i-1]+s*u[i],o[e]=n;this._.plotData=o,this._.plotFlush=null}return f.call(this,t)},n.register("biquad",i),n.register("lowpass",function(t){return new i(t).set("type","lowpass")}),n.register("highpass",function(t){return new i(t).set("type","highpass")}),n.register("bandpass",function(t){return new i(t).set("type","bandpass")}),n.register("lowshelf",function(t){return new i(t).set("type","lowshelf")}),n.register("highshelf",function(t){return new i(t).set("type","highshelf")}),n.register("peaking",function(t){return new i(t).set("type","peaking")}),n.register("notch",function(t){return new i(t).set("type","notch")}),n.register("allpass",function(t){return new i(t).set("type","allpass")}),n.alias("lpf","lowpass"),n.alias("hpf","highpass"),n.alias("bpf","bandpass"),n.alias("bef","notch"),n.alias("brf","notch"),n.alias("apf","allpass")}(timbre),function(r){"use strict";function n(t){return p.isSignalArray(t)||t instanceof Float32Array}var p=r.fn,a=r.modules.Scissor.Tape;function t(t){r.Object.call(this,1,t),p.fixAR(this);t=this._;t.pitch=r(1),t.samplerate=44100,t.channels=0,t.bufferMix=null,t.buffer=[],t.isLooped=!1,t.isReversed=!1,t.duration=0,t.currentTime=0,t.currentTimeObj=null,t.phase=0,t.phaseIncr=0,t.onended=p.make_onended(this,0),t.onlooped=e(this)}p.extend(t);function o(t){var e,i,s=this._;"object"==typeof t&&(e=[],n(t)?(e[0]=t,0):"object"==typeof t&&(t instanceof r.Object?t=t.buffer:t instanceof a&&(t=t.getBuffer()),Array.isArray(t.buffer)?n(t.buffer[0])&&(e=n(t.buffer[1])&&n(t.buffer[2])?t.buffer:[t.buffer[0]]):n(t.buffer)&&(e=[t.buffer]),"number"==typeof t.samplerate)&&(i=t.samplerate),e.length)&&(0<i&&(s.samplerate=t.samplerate),s.bufferMix=null,s.buffer=e,s.phase=0,s.phaseIncr=s.samplerate/r.samplerate,s.duration=1e3*s.buffer[0].length/s.samplerate,s.currentTime=0,s.plotFlush=!0,this.reverse(s.isReversed))}var e=function(e){return function(){var t=e._;t.phase>=t.buffer[0].length?t.phase=0:t.phase<0&&(t.phase=t.buffer[0].length+t.phaseIncr),e._.emit("looped")}},i=t.prototype,h=(Object.defineProperties(i,{buffer:{set:o,get:function(){var t=this._;return{samplerate:t.samplerate,channels:t.channels,buffer:t.buffer}}},pitch:{set:function(t){this._.pitch=r(t)},get:function(){return this._.pitch}},isLooped:{get:function(){return this._.isLooped}},isReversed:{get:function(){return this._.isReversed}},samplerate:{get:function(){return this._.samplerate}},duration:{get:function(){return this._.duration}},currentTime:{set:function(t){var e;"number"==typeof t?(e=this._,0<=t&&t<=e.duration&&(e.phase=t/1e3*e.samplerate,e.currentTime=t)):t instanceof r.Object?this._.currentTimeObj=t:null===t&&(this._.currentTimeObj=null)},get:function(){return this._.currentTimeObj||this._.currentTime}}}),i.clone=function(){var t=this._,e=p.clone(this);return t.buffer.length&&o.call(e,{buffer:t.buffer,samplerate:t.samplerate,channels:t.channels}),e.loop(t.isLooped),e.reverse(t.isReversed),e},i.slice=function(t,e){var i,s=this._,n=r(s.originkey);s.isReversed;return s.buffer.length&&(t="number"==typeof t?.001*t*s.samplerate|0:0,(e="number"==typeof e?.001*e*s.samplerate|0:s.buffer[0].length)<t&&(i=t,t=e,e=i,0),2===s.channels?o.call(n,{buffer:[p.pointer(s.buffer[0],t,e-t),p.pointer(s.buffer[1],t,e-t),p.pointer(s.buffer[2],t,e-t)],samplerate:s.samplerate}):o.call(n,{buffer:p.pointer(s.buffer[0],t,e-t),samplerate:s.samplerate}),n.playbackState=p.PLAYING_STATE),n.loop(s.isLooped),n.reverse(s.isReversed),n},i.reverse=function(t){var e=this._;return e.isReversed=!!t,e.isReversed?(0<e.phaseIncr&&(e.phaseIncr*=-1),0===e.phase&&e.buffer.length&&(e.phase=e.buffer[0].length+e.phaseIncr)):e.phaseIncr<0&&(e.phaseIncr*=-1),this},i.loop=function(t){return this._.isLooped=!!t,this},i.bang=function(t){return this.playbackState=!1===t?p.FINISHED_STATE:p.PLAYING_STATE,this._.phase=0,this._.emit("bang"),this},i.process=function(t){var e=this._;if(e.buffer.length&&this.tickID!==t){this.tickID=t;var i,s,n=this.cells[1],r=this.cells[2],a=e.phase,o=e.cellsize;if(2===e.channels?(i=e.buffer[1],s=e.buffer[2]):i=s=e.buffer[0],e.currentTimeObj){for(var h,u=e.currentTimeObj.process(t).cells[0],l=.001*e.samplerate,c=0;c<o;++c)h=u[c],n[c]=i[0|(a=h*l)]||0,r[c]=s[0|a]||0;e.phase=a,e.currentTime=h}else{var t=e.pitch.process(t).cells[0][0],f=e.phaseIncr*t;for(c=0;c<o;++c)n[c]=i[0|a]||0,r[c]=s[0|a]||0,a+=f;(a>=i.length||a<0)&&(e.isLooped?p.nextTick(e.onlooped):p.nextTick(e.onended)),e.phase=a,e.currentTime+=p.currentTimeIncr}p.outputSignalAR(this)}return this},r.Object.prototype.plot);i.plot=function(t){var e,i,s=this._;if(s.plotFlush){2===s.channels?(e=s.buffer[1],i=s.buffer[2]):e=i=s.buffer[0];for(var n=new Float32Array(2048),r=0,a=e.length/2048,o=0;o<2048;o++)n[o]=.5*(e[0|r]+i[0|r]),r+=a;s.plotData=n,s.plotFlush=null}return h.call(this,t)},p.register("buffer",t)}(timbre),function(e){"use strict";var i=e.fn,s=e.modules.Chorus;function t(t){e.Object.call(this,2,t),i.fixAR(this);t=new s(this._.samplerate);t.setDelayTime(20),t.setRate(4),t.depth=20,t.feedback=.2,t.mix=.33,this._.chorus=t}i.extend(t);var n=t.prototype;Object.defineProperties(n,{type:{set:function(t){this._.chorus.setDelayTime(t)},get:function(){return this._.chorus.wave}},delay:{set:function(t){.5<=t&&t<=80&&this._.chorus.setDelayTime(t)},get:function(){return this._.chorus.delayTime}},rate:{set:function(t){"number"==typeof t&&0<t&&this._.chorus.setRate(t)},get:function(){return this._.chorus.rate}},depth:{set:function(t){"number"==typeof t&&0<=t&&t<=100&&(t*=this._.samplerate/44100,this._.chorus.depth=t)},get:function(){return this._.chorus.depth}},fb:{set:function(t){"number"==typeof t&&-1<=t&&t<=1&&(this._.chorus.feedback=.99996*t)},get:function(){return this._.chorus.feedback}},mix:{set:function(t){this._.mix=e(t)},get:function(){return this._.mix}}}),n.process=function(t){var e=this._;return this.tickID!==t&&(this.tickID=t,i.inputSignalAR(this),e.bypassed||e.chorus.process(this.cells[1],this.cells[2]),i.outputSignalAR(this)),this},i.register("chorus",t)}(timbre),function(e){"use strict";var u=e.fn;function t(t){e.Object.call(this,2,t);t=this._;t.min=-.8,t.max=.8}u.extend(t);var i=t.prototype;Object.defineProperties(i,{minmax:{set:function(t){var e=this._;"number"==typeof t&&(e.min=-Math.abs(t),e.max=-e.min)},get:function(){return this._.max}},min:{set:function(t){var e=this._;"number"==typeof t&&(e.max<t?e.max=t:e.min=t)},get:function(){return this._.min}},max:{set:function(t){var e=this._;"number"==typeof t&&(t<e.min?e.min=t:e.max=t)},get:function(){return this._.max}}}),i.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var i,s,n=this.cells[1],r=this.cells[2],a=n.length,o=e.min,h=e.max;if(e.ar){for(u.inputSignalAR(this),i=0;i<a;++i)(s=n[i])<o?s=o:h<s&&(s=h),n[i]=s,(s=r[i])<o?s=o:h<s&&(s=h),r[i]=s;u.outputSignalAR(this)}else(s=u.inputSignalKR(this))<o?s=o:h<s&&(s=h),this.cells[0][0]=s,u.outputSignalKR(this)}return this},u.register("clip",t)}(timbre),function(e){"use strict";var n=e.fn,i=e.timevalue,s=e.modules.Compressor;function t(t){e.Object.call(this,2,t),n.fixAR(this);t=this._;t.prevThresh=-24,t.prevKnee=30,t.prevRatio=12,t.thresh=e(t.prevThresh),t.knee=e(t.prevKnee),t.ratio=e(t.prevRatio),t.postGain=6,t.reduction=0,t.attack=3,t.release=25,t.comp=new s(t.samplerate),t.comp.dbPostGain=t.postGain,t.comp.setAttackTime(.001*t.attack),t.comp.setReleaseTime(.001*t.release),t.comp.setPreDelayTime(6),t.comp.setParams(t.prevThresh,t.prevKnee,t.prevRatio)}n.extend(t);var r=t.prototype;Object.defineProperties(r,{thresh:{set:function(t){this._.thresh=e(t)},get:function(){return this._.thresh}},thre:{set:function(t){this._.thresh=e(t)},get:function(){return this._.thre}},knee:{set:function(t){this._.kne=e(t)},get:function(){return this._.knee}},ratio:{set:function(t){this._.ratio=e(t)},get:function(){return this._.ratio}},gain:{set:function(t){"number"==typeof t&&(this._.comp.dbPostGain=t)},get:function(){return this._.comp.dbPostGain}},attack:{set:function(t){"number"==typeof(t="string"==typeof t?i(t):t)&&(this._.attack=t=t<0?0:1e3<t?1e3:t,this._.comp.setAttackTime(.001*t))},get:function(){return this._.attack}},release:{set:function(t){"number"==typeof(t="string"==typeof t?i(t):t)&&(this._.release=t=t<0?0:1e3<t?1e3:t,this._.comp.setReleaseTime(.001*t))},get:function(){return this._.release}},reduction:{get:function(){return this._.reduction}}}),r.process=function(t){var e,i,s=this._;return this.tickID!==t&&(this.tickID=t,n.inputSignalAR(this),e=s.thresh.process(t).cells[0][0],i=s.knee.process(t).cells[0][0],t=s.ratio.process(t).cells[0][0],s.prevThresh===e&&s.prevKnee===i&&s.prevRatio===t||(s.prevThresh=e,s.prevKnee=i,s.prevRatio=t,s.comp.setParams(e,i,t)),s.bypassed||(s.comp.process(this.cells[1],this.cells[2]),s.reduction=s.comp.meteringGain),n.outputSignalAR(this)),this},n.register("comp",t)}(timbre),function(e){"use strict";var r=e.fn,i=e.timevalue,s=e.modules.StereoDelay;function t(t){e.Object.call(this,2,t),r.fixAR(this);t=this._;t.time=e(100),t.fb=e(.2),t.cross=e(!1),t.mix=.33,t.delay=new s(t.samplerate)}r.extend(t);var n=t.prototype;Object.defineProperties(n,{time:{set:function(t){"string"==typeof t&&(t=i(t)),this._.time=e(t)},get:function(){return this._.time}},fb:{set:function(t){this._.fb=e(t)},get:function(){return this._.fb}},cross:{set:function(t){this._.cross=e(t)},get:function(){return this._.cross}},mix:{set:function(t){"number"==typeof t&&(this._.mix=t=1<t?1:t<0?0:t)},get:function(){return this._.mix}}}),n.process=function(t){var e,i,s,n=this._;return this.tickID!==t&&(this.tickID=t,e=n.time.process(t).cells[0][0],i=n.fb.process(t).cells[0][0],t=0!==n.cross.process(t).cells[0][0],s=n.mix,n.prevTime===e&&n.prevFb===i&&n.prevCross===t&&n.prevMix===s||(n.prevTime=e,n.prevFb=i,n.prevCross=t,n.prevMix=s,n.delay.setParams(e,i,t,s)),r.inputSignalAR(this),n.bypassed||n.delay.process(this.cells[1],this.cells[2]),r.outputSignalAR(this)),this},r.register("delay",t)}(timbre),function(e){"use strict";var S=e.fn;function t(t){e.Object.call(this,2,t),S.fixAR(this);t=this._;t.pre=e(60),t.post=e(-18),t.x1L=t.x2L=t.y1L=t.y2L=0,t.x1R=t.x2R=t.y1R=t.y2R=0,t.b0=t.b1=t.b2=t.a1=t.a2=0,t.cutoff=0,t.Q=1,t.preScale=0,t.postScale=0}S.extend(t);var i=t.prototype,T=(Object.defineProperties(i,{cutoff:{set:function(t){"number"==typeof t&&0<t&&(this._.cutoff=t)},get:function(){return this._.cutoff}},pre:{set:function(t){this._.pre=e(t)},get:function(){return this._.pre}},post:{set:function(t){this._.post=e(t)},get:function(){return this._.post}}}),i.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t,S.inputSignalAR(this);var i=-e.pre.process(t).cells[0][0],t=-e.post.process(t).cells[0][0];if(e.prevPreGain===i&&e.prevPostGain===t||(e.prevPreGain=i,e.prevPostGain=t,e.preScale=Math.pow(10,.05*-i),e.postScale=Math.pow(10,.05*-t)),!e.bypassed){var s,n,r,a=this.cells[1],o=this.cells[2],h=e.preScale,u=e.postScale;if(e.cutoff){e.prevCutoff!==e.cutoff&&(e.prevCutoff=e.cutoff,T(e));for(var l=e.x1L,c=e.x2L,f=e.y1L,p=e.y2L,d=e.x1R,m=e.x2R,v=e.y1R,g=e.y2R,b=e.b0,_=e.b1,y=e.b2,w=e.a1,x=e.a2,k=0,A=a.length;k<A;++k)(s=(r=b*(n=a[k]*h)+_*l+y*c-w*f-x*p)*u)<-1?s=-1:1<s&&(s=1),a[k]=s,c=l,l=n,p=f,f=r,(s=(r=b*(n=o[k]*h)+_*d+y*m-w*v-x*g)*u)<-1?s=-1:1<s&&(s=1),o[k]=s,m=d,d=n,g=v,v=r;e.x1L=l,e.x2L=c,e.y1L=f,e.y2L=p,e.x1R=d,e.x2R=m,e.y1R=v,e.y2R=g}else for(k=0,A=a.length;k<A;++k)(s=a[k]*h*u)<-1?s=-1:1<s&&(s=1),a[k]=s,(s=o[k]*h*u)<-1?s=-1:1<s&&(s=1),o[k]=s}S.outputSignalAR(this)}return this},function(t){var e=2*Math.PI*t.cutoff/t.samplerate,i=Math.cos(e),e=Math.sin(e)/(2*t.Q),s=1/(1+e);t.b0=.5*(1-i)*s,t.b1=1-i*s,t.b2=.5*(1-i)*s,t.a1=-2*i*s,t.a2=1-e*s});S.register("dist",t)}(timbre),function(e){"use strict";var d=e.fn;function t(t){e.Object.call(this,2,t),this._.ar=!1}d.extend(t),t.prototype.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var i,s,n,r,a,o,h=this.nodes,u=this.cells[0],l=this.cells[1],c=this.cells[2],f=h.length,p=u.length;if(e.ar){if(0<h.length)for(h[0].process(t),r=h[0].cells[1],a=h[0].cells[2],l.set(r),c.set(a),i=1;i<f;++i)for(h[i].process(t),r=h[i].cells[1],a=h[i].cells[2],s=0;s<p;++s)o=r[s],l[s]=0===o?0:l[s]/o,o=a[s],c[s]=0===o?0:c[s]/o;else for(s=0;s<p;++s)l[s]=c[i]=0;d.outputSignalAR(this)}else{if(0<h.length)for(n=h[0].process(t).cells[0][0],i=1;i<f;++i)n=0===(o=h[i].process(t).cells[0][0])?0:n/o;else n=0;u[0]=n,d.outputSignalKR(this)}}return this},d.register("/",t)}(timbre),function(e){"use strict";var h=e.fn,u=e.timevalue,d=e.modules.Envelope,l=h.isDictionary;function c(t){e.Object.call(this,2,t);t=this._;t.env=new d(t.samplerate),t.env.setStep(t.cellsize),t.tmp=new h.SignalArray(t.cellsize),t.ar=!1,t.plotFlush=!0,t.onended=s(this),this.on("ar",i)}h.extend(c);var i=function(t){this._.env.setStep(t?1:this._.cellsize)},s=function(t){return function(){t._.emit("ended")}},t=c.prototype,n=(Object.defineProperties(t,{table:{set:function(t){Array.isArray(t)&&(n.call(this,t),this._.plotFlush=!0)},get:function(){return this._.env.table}},curve:{set:function(t){this._.env.setCurve(t)},get:function(){return this._.env.curve}},releaseNode:{set:function(t){this._.env.setReleaseNode(t),this._.plotFlush=!0},get:function(){return this._.env.releaseNode+1}},loopNode:{set:function(t){this._.env.setLoopNode(t),this._.plotFlush=!0},get:function(){return this._.env.loopNode+1}}}),t.clone=function(){var t=h.clone(this);return t._.env=this._.env.clone(),t},t.reset=function(){return this._.env.reset(),this},t.release=function(){var t=this._;return t.env.release(),t.emit("released"),this},t.bang=function(){var t=this._;return t.env.reset(),t.env.status=d.StatusGate,t.emit("bang"),this},t.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var i,s=this.cells[1],n=this.cells[2],r=e.cellsize;if(this.nodes.length)h.inputSignalAR(this);else for(i=0;i<r;++i)s[i]=n[i]=1;var a,t=null;if(e.ar){var o=e.tmp;for(e.env.process(o),i=0;i<r;++i)s[i]*=o[i],n[i]*=o[i]}else for(a=e.env.next(),i=0;i<r;++i)s[i]*=a,n[i]*=a;t=e.env.emit,h.outputSignalAR(this),t&&("ended"===t?h.nextTick(e.onended):this._.emit(t,e.value))}return this},function(t){for(var e,i,s,n,r=this._.env,a=[t[0]||p],o=1,h=t.length;o<h;++o)e=t[o][0]||p,i=t[o][1],s=t[o][2],(i="number"!=typeof i?"string"==typeof i?u(i):10:i)<10&&(i=10),"number"==typeof s?(n=s,s=d.CurveTypeCurve):(s=d.CurveTypeDict[s]||null,n=0),a.push([e,i,s,n]);r.setTable(a)}),m=e.Object.prototype.plot;function f(t,e,i,s,n,r){return"number"==typeof t[s]?i=t[s]:"number"==typeof t[n]?i=t[n]:r&&("string"==typeof t[s]?i=r(t[s]):"string"==typeof t[n]&&(i=r(t[n]))),i=i<e?e:i}t.plot=function(t){if(this._.plotFlush){var e,i=this._.env.clone(),s=i.getInfo(1e3),o=s.totalDuration,h=s.loopBeginTime,u=s.releaseBeginTime,n=new Float32Array(256),r=0,a=o/n.length,l=!1,s=.001*o*this._.samplerate|0;for(s/=n.length,i.setStep(s),i.status=d.StatusGate,p=0,e=n.length;p<e;++p)n[p]=i.next(),r+=a,!l&&u<=r&&(i.release(),l=!0);this._.plotData=n,this._.plotBefore=function(t,e,i,s,n){var r,a;h!==1/0&&u!==1/0&&(a=e+s*(u/o),a-=r=e+s*(h/o),t.fillStyle="rgba(224, 224, 224, 0.8)",t.fillRect(r,0,a,n)),u!==1/0&&(a=s-(r=e+s*(u/o)),t.fillStyle="rgba(212, 212, 212, 0.8)",t.fillRect(r,0,a,n))};for(var c=1/0,f=-1/0,p=0;p<e;++p)n[p]<c?c=n[p]:n[p]>f&&(f=n[p]);this._.plotRange=[c,f=f<1?1:f],this._.plotData=n,this._.plotFlush=null}return m.call(this,t)},h.register("env",c);var p=d.ZERO;h.register("perc",function(t){l(t[0])||t.unshift({});var e=t[0],i=f(e,10,10,"a","attackTime",u),s=f(e,10,1e3,"r","releaseTime",u),n=f(e,p,1,"lv","level");return e.table=[p,[n,i],[p,s]],new c(t)}),h.register("adsr",function(t){l(t[0])||t.unshift({});var e=t[0],i=f(e,10,10,"a","attackTime",u),s=f(e,10,300,"d","decayTime",u),n=f(e,p,.5,"s","sustainLevel"),r=f(e,10,1e3,"r","decayTime",u),a=f(e,p,1,"lv","level");return e.table=[p,[a,i],[n,s],[p,r]],e.releaseNode=3,new c(t)}),h.register("adshr",function(t){l(t[0])||t.unshift({});var e=t[0],i=f(e,10,10,"a","attackTime",u),s=f(e,10,300,"d","decayTime",u),n=f(e,p,.5,"s","sustainLevel"),r=f(e,10,500,"h","holdTime",u),a=f(e,10,1e3,"r","decayTime",u),o=f(e,p,1,"lv","level");return e.table=[p,[o,i],[n,s],[n,r],[p,a]],new c(t)}),h.register("asr",function(t){l(t[0])||t.unshift({});var e=t[0],i=f(e,10,10,"a","attackTime",u),s=f(e,p,.5,"s","sustainLevel"),n=f(e,10,1e3,"r","releaseTime",u);return e.table=[p,[s,i],[p,n]],e.releaseNode=2,new c(t)}),h.register("dadsr",function(t){l(t[0])||t.unshift({});var e=t[0],i=f(e,10,100,"dl","delayTime",u),s=f(e,10,10,"a","attackTime",u),n=f(e,10,300,"d","decayTime",u),r=f(e,p,.5,"s","sustainLevel"),a=f(e,10,1e3,"r","relaseTime",u),o=f(e,p,1,"lv","level");return e.table=[p,[p,i],[o,s],[r,n],[p,a]],e.releaseNode=4,new c(t)}),h.register("ahdsfr",function(t){l(t[0])||t.unshift({});var e=t[0],i=f(e,10,10,"a","attackTime",u),s=f(e,10,10,"h","holdTime",u),n=f(e,10,300,"d","decayTime",u),r=f(e,p,.5,"s","sustainLevel"),a=f(e,10,5e3,"f","fadeTime",u),o=f(e,10,1e3,"r","relaseTime",u),h=f(e,p,1,"lv","level");return e.table=[p,[h,i],[h,s],[r,n],[p,a],[p,o]],e.releaseNode=5,new c(t)}),h.register("linen",function(t){l(t[0])||t.unshift({});var e=t[0],i=f(e,10,10,"a","attackTime",u),s=f(e,10,1e3,"s","sustainTime",u),n=f(e,10,1e3,"r","releaseTime",u),r=f(e,p,1,"lv","level");return e.table=[p,[r,i],[r,s],[p,n]],new c(t)}),h.register("env.tri",function(t){l(t[0])||t.unshift({});var e=t[0],i=f(e,20,1e3,"dur","duration",u),s=f(e,p,1,"lv","level");return e.table=[p,[s,i*=.5],[p,i]],new c(t)}),h.register("env.cutoff",function(t){l(t[0])||t.unshift({});var e=t[0],i=f(e,10,100,"r","relaseTime",u),s=f(e,p,1,"lv","level");return e.table=[s,[p,i]],new c(t)})}(timbre),function(e){"use strict";var o=e.fn,t=e.modules.FFT,p=e.modules.Biquad,a={hpf:0,lf:1,lmf:2,mf:3,hmf:4,hf:5,lpf:6};function i(t){e.Object.call(this,2,t),o.fixAR(this);t=this._;t.biquads=new Array(7),t.plotBefore=s,t.plotRange=[-18,18],t.plotFlush=!0}o.extend(i);var s=function(t,e,i,s,n){t.lineWidth=1,t.strokeStyle="rgb(192, 192, 192)";for(var r=.5*this._.samplerate,a=1;a<=10;++a)for(var o=1;o<=4;o++){var h=a*Math.pow(10,o);h<=20||r<=h||(t.beginPath(),h=Math.log(h/20)/Math.log(r/20),t.moveTo(h=.5+(h*s+e|0),i),t.lineTo(h,i+n),t.stroke())}for(var u=n/6,a=1;a<6;a++){t.beginPath();var l=.5+(i+a*u|0);t.moveTo(e,l),t.lineTo(e+s,l),t.stroke()}},n=i.prototype,d=(Object.defineProperties(n,{params:{set:function(t){if("object"==typeof t)for(var e=Object.keys(t),i=0,s=e.length;i<s;++i){var n=t[e[i]];Array.isArray(n)?this.setParams(e[i],n[0],n[1],n[2]):this.setParams(e[i])}}}}),n.setParams=function(t,e,i,s){var n=this._;if(0<=(t="string"==typeof t?a[t]:t)&&t<n.biquads.length){if(t|=0,"number"==typeof e&&"number"==typeof i){"number"!=typeof s&&(s=0);var r=n.biquads[t];if(!r)switch(r=n.biquads[t]=new p(n.samplerate),t){case 0:r.setType("highpass");break;case n.biquads.length-1:r.setType("lowpass");break;default:r.setType("peaking")}r.setParams(e,i,s)}else n.biquads[t]=void 0;n.plotFlush=!0}return this},n.getParams=function(t){t=this._.biquads[0|t];if(t)return{freq:t.frequency,Q:t.Q,gain:t.gain}},n.process=function(t){var e=this._;if(this.tickID!==t){if(this.tickID=t,o.inputSignalAR(this),!e.bypassed)for(var i=this.cells[1],s=this.cells[2],n=e.biquads,r=0,a=n.length;r<a;++r)n[r]&&n[r].process(i,s);o.outputSignalAR(this)}return this},new t(2048)),m=e.Object.prototype.plot;n.plot=function(t){if(this._.plotFlush){var e=this._,i=new Float32Array(d.length);i[0]=1;for(var s=0,n=e.biquads.length;s<n;++s){var r,a=this.getParams(s);a&&(r=new p(e.samplerate),0===s?r.setType("highpass"):s===n-1?r.setType("lowpass"):r.setType("peaking"),r.setParams(a.freq,a.Q,a.gain),r.process(i,i))}d.forward(i);var o,h,u,l=new Float32Array(512),c=.5*e.samplerate,f=new Float32Array(512);for(d.getFrequencyData(f),s=0;s<512;++s)h=(o=20*Math.pow(c/20,s/512)/(c/f.length))-(o=0|o),0==o?u=f[o]:u=(1-h)*f[o-1]+h*f[o],l[s]=u;this._.plotData=l,this._.plotFlush=null}return m.call(this,t)},o.register("eq",i)}(timbre),function(e){"use strict";var s=e.fn,i=e.modules.FFT;function t(t){e.Object.call(this,2,t),s.listener(this),s.fixAR(this),this.real=new e.ChannelObject(this),this.imag=new e.ChannelObject(this),this.cells[3]=this.real.cell,this.cells[4]=this.imag.cell;t=this._;t.fft=new i(2*t.cellsize),t.fftCell=new s.SignalArray(t.fft.length),t.prevCell=new s.SignalArray(t.cellsize),t.freqs=new s.SignalArray(t.fft.length>>1),t.plotFlush=!0,t.plotRange=[0,32],t.plotBarStyle=!0}s.extend(t);var n=t.prototype,r=(Object.defineProperties(n,{window:{set:function(t){this._.fft.setWindow(t)},get:function(){return this._.fft.windowName}},spectrum:{get:function(){return this._.fft.getFrequencyData(this._.freqs)}}}),n.process=function(t){var e,i=this._;return this.tickID!==t&&(this.tickID=t,s.inputSignalAR(this),s.outputSignalAR(this),t=this.cells[0],e=i.cellsize,i.fftCell.set(i.prevCell),i.fftCell.set(t,e),i.fft.forward(i.fftCell),i.prevCell.set(t),i.plotFlush=!0,this.cells[3].set(i.fft.real.subarray(0,e)),this.cells[4].set(i.fft.imag.subarray(0,e))),this},e.Object.prototype.plot);n.plot=function(t){return this._.plotFlush&&(this._.plotData=this.spectrum,this._.plotFlush=null),r.call(this,t)},s.register("fft",t)}(timbre),function(e){"use strict";var i=e.fn;function t(t){e.Object.call(this,1,t),i.fixAR(this);t=this._;t.freq=e(440),t.reg=32768,t.shortFlag=!1,t.phase=0,t.lastValue=0}i.extend(t);var s=t.prototype;Object.defineProperties(s,{shortFlag:{set:function(t){this._.shortFlag=!!t},get:function(){return this._.shortFlag}},freq:{set:function(t){this._.freq=e(t)},get:function(){return this._.freq}}}),s.process=function(t){var e=this._,i=this.cells[0];if(this.tickID!==t){this.tickID=t;var s,n,r=e.lastValue,a=e.phase,o=e.freq.process(t).cells[0][0]/e.samplerate,h=e.reg,u=e.mul,l=e.add;if(e.shortFlag)for(s=0,n=i.length;s<n;++s)1<=a&&(r=(1&(h=(h>>=1)|(1&(h^h>>6))<<15))-.5,--a),i[s]=r*u+l,a+=o;else for(s=0,n=i.length;s<n;++s)1<=a&&(r=(1&(h=(h>>=1)|(1&(h^h>>1))<<15))-.5,--a),i[s]=r*u+l,a+=o;e.reg=h,e.phase=a,e.lastValue=r}return this},i.register("fnoise",t)}(timbre),function(e){"use strict";var r=e.fn,s=(r.extend(t),t.prototype.process=function(t){return this.tickID!==t&&(this.tickID=t,this._.parent.process(t)),this},t);function t(t){e.Object.call(this,2,[]),r.fixAR(this),this._.parent=t}function i(t){e.Object.call(this,2,t),r.fixAR(this),this._.selected=0,this._.outputs=[]}r.extend(i);var n=i.prototype;Object.defineProperties(n,{selected:{set:function(t){var e=this._;if("number"==typeof t){e.selected=t;for(var i=e.outputs,s=0,n=i.length;s<n;++s)i[s]&&(i[s].cells[0].set(r.emptycell),i[s].cells[1].set(r.emptycell),i[s].cells[2].set(r.emptycell))}},get:function(){return this._.selected}}}),n.at=function(t){var e=this._,i=e.outputs[t];return i||(e.outputs[t]=i=new s(this)),i},n.process=function(t){var e=this._;return this.tickID!==t&&(this.tickID=t,r.inputSignalAR(this),r.outputSignalAR(this),t=e.outputs[e.selected])&&(t.cells[0].set(this.cells[0]),t.cells[1].set(this.cells[1]),t.cells[2].set(this.cells[2])),this},r.register("gate",i)}(timbre),function(e){"use strict";var a=e.fn,i=e.modules.FFT;function t(t){e.Object.call(this,1,t),a.fixAR(this);t=this._;t.fft=new i(2*t.cellsize),t.fftCell=new a.SignalArray(this._.fft.length),t.realBuffer=new a.SignalArray(this._.fft.length),t.imagBuffer=new a.SignalArray(this._.fft.length)}a.extend(t);var s=t.prototype;Object.defineProperties(s,{real:{set:function(t){this._.real=e(t)},get:function(){return this._.real}},imag:{set:function(t){this._.imag=e(t)},get:function(){return this._.imag}}}),s.process=function(t){var e,i,s,n,r=this._;return this.tickID!==t&&(this.tickID=t,r.real)&&r.imag&&(e=this.cells[0],i=r.realBuffer,s=r.imagBuffer,n=r.real.process(t).cells[0],t=r.imag.process(t).cells[0],i.set(n),s.set(t),e.set(r.fft.inverse(i,s).subarray(0,r.cellsize)),a.outputSignalAR(this)),this},a.register("ifft",t)}(timbre),function(e){"use strict";var l=e.fn,i=e.timevalue;function t(t){e.Object.call(this,1,t),l.timer(this),l.fixKR(this);t=this._;t.interval=e(1e3),t.count=0,t.delay=0,t.timeout=1/0,t.currentTime=0,t.delaySamples=0,t.countSamples=0,t.onended=l.make_onended(this),this.on("start",s)}l.extend(t);var s=function(){var t=this._;this.playbackState=l.PLAYING_STATE,t.delaySamples=t.samplerate*(.001*t.delay)|0,t.countSamples=t.count=t.currentTime=0},n=(Object.defineProperty(s,"unremovable",{value:!0,writable:!1}),t.prototype);Object.defineProperties(n,{interval:{set:function(t){"string"==typeof t&&(t=i(t))<=0&&(t=0),this._.interval=e(t)},get:function(){return this._.interval}},delay:{set:function(t){"number"==typeof(t="string"==typeof t?i(t):t)&&0<=t&&(this._.delay=t,this._.delaySamples=this._.samplerate*(.001*t)|0)},get:function(){return this._.delay}},count:{set:function(t){"number"==typeof t&&(this._.count=t)},get:function(){return this._.count}},timeout:{set:function(t){"number"==typeof(t="string"==typeof t?i(t):t)&&0<=t&&(this._.timeout=t)},get:function(){return this._.timeout}},currentTime:{get:function(){return this._.currentTime}}}),n.bang=function(){var t=this._;return this.playbackState=l.PLAYING_STATE,t.delaySamples=t.samplerate*(.001*t.delay)|0,t.countSamples=t.count=t.currentTime=0,t.emit("bang"),this},n.process=function(t){var e=this.cells[0],i=this._;if(this.tickID!==t){this.tickID=t,0<i.delaySamples&&(i.delaySamples-=e.length);t=i.interval.process(t).cells[0][0];if(i.delaySamples<=0&&(i.countSamples-=e.length,i.countSamples<=0)){i.countSamples+=i.samplerate*t*.001|0;for(var s=this.nodes,n=i.count,r=n*i.mul+i.add,a=0,o=e.length;a<o;++a)e[a]=r;for(var h=0,u=s.length;h<u;++h)s[h].bang(n);i.count+=1}i.currentTime+=l.currentTimeIncr,i.currentTime>=i.timeout&&l.nextTick(i.onended)}return this},l.register("interval",t)}(timbre),function(i){"use strict";var u=i.fn,s=i.timevalue;function t(t){i.Object.call(this,1,t),u.fixAR(this);var t=this._,e=Math.ceil(Math.log(t.samplerate)*Math.LOG2E);t.buffersize=1<<e,t.buffermask=t.buffersize-1,t.buffer=new u.SignalArray(t.buffersize),t.time=0,t.readIndex=0,t.writeIndex=0}u.extend(t);var e=t.prototype;Object.defineProperties(e,{time:{set:function(t){var e;"number"==typeof(t="string"==typeof t?s(t):t)&&0<t&&((t=.001*((e=this._).time=t)*e.samplerate|0)>e.buffermask&&(t=e.buffermask),e.writeIndex=e.readIndex+t&e.buffermask)},get:function(){return this._.time}}}),e.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t,u.inputSignalAR(this);for(var i=this.cells[0],s=e.buffer,n=e.buffermask,r=e.readIndex,a=e.writeIndex,o=i.length,h=0;h<o;++h)s[a]=i[h],i[h]=s[r],r+=1,a=a+1&n;e.readIndex=r&n,e.writeIndex=a,u.outputSignalAR(this)}return this},u.register("lag",t)}(timbre),function(e){"use strict";var o=e.fn;function t(t){e.Object.call(this,1,t);t=this._;t.input=0,t.value=0,t.prev=null,t.ar=!1,t.map=i}o.extend(t);var i=function(t){return t},s=t.prototype;Object.defineProperties(s,{input:{set:function(t){"number"==typeof t&&(this._.input=t)},get:function(){return this._.input}},map:{set:function(t){"function"==typeof t&&(this._.map=t)},get:function(){return this._.map}}}),s.bang=function(){return this._.prev=null,this._.emit("bang"),this},s.at=function(t){return this._.map?this._.map(t):0},s.process=function(t){var e=this.cells[0],i=this._;if(this.tickID!==t){this.tickID=t;var t=this.nodes.length,s=e.length;if(i.ar&&t){o.inputSignalAR(this);var n=i.map;if(n)for(a=0;a<s;++a)e[a]=n(e[a]);i.value=e[s-1],o.outputSignalAR(this)}else for(var t=t?o.inputSignalKR(this):i.input,r=(i.map&&i.prev!==t&&(i.prev=t,i.value=i.map(t)),i.value*i.mul+i.add),a=0;a<s;++a)e[a]=r}return this},o.register("map",t)}(timbre),function(e){"use strict";var l=e.fn;function t(t){e.Object.call(this,1,t)}l.extend(t),t.prototype.process=function(t){var e=this.cells[0],i=this._;if(this.tickID!==t){this.tickID=t;var s,n,r,a,o=this.nodes,h=o.length,u=e.length;if(i.ar){if(0<o.length)for(r=o[0].process(t).cells[0],e.set(r),s=1;s<h;++s)for(r=o[s].process(t).cells[0],n=0;n<u;++n)a=r[n],e[n]<a&&(e[n]=a);else for(n=0;n<u;++n)e[n]=0;l.outputSignalAR(this)}else{if(0<o.length)for(r=o[0].process(t).cells[0][0],s=1;s<h;++s)r<(a=o[s].process(t).cells[0][0])&&(r=a);else r=0;e[0]=r,l.outputSignalKR(this)}}return this},l.register("max",t)}(timbre),function(r){"use strict";var a,t,o,i;function e(t){r.Object.call(this,2,t),a.fixAR(this);t=this._;t.src=t.func=null,t.bufferL=new a.SignalArray(4096),t.bufferR=new a.SignalArray(4096),t.readIndex=0,t.writeIndex=0,t.totalRead=0,t.totalWrite=0}"browser"===r.envtype&&(a=r.fn,a.extend(e),(t=e.prototype).listen=function(t){var e=o[r.env];e&&(e.set.call(this,t),e.listen.call(this))},t.unlisten=function(){for(var t=o[r.env],t=(t&&t.unlisten.call(this),this.cells[0].set(a.emptycell),this.cells[1].set(a.emptycell),this.cells[2].set(a.emptycell),this._),e=t.bufferL,i=t.bufferR,s=0,n=e.length;s<n;++s)e[s]=i[s]=0},t.process=function(t){var e,i,s=this._;return null!==s.src&&this.tickID!==t&&(this.tickID=t,t=s.cellsize,s.totalWrite>s.totalRead+t&&(e=s.readIndex,this.cells[1].set(s.bufferL.subarray(e,i=e+t)),this.cells[2].set(s.bufferR.subarray(e,i)),s.readIndex=4095&i,s.totalRead+=t),a.outputSignalAR(this)),this},(o={}).webkit={set:function(t){var e,i=this._;t instanceof HTMLMediaElement&&(e=a._audioContext,i.src=e.createMediaElementSource(t))},listen:function(){var t=this._,e=a._audioContext;t.gain=e.createGainNode(),t.gain.gain.value=0,t.node=e.createJavaScriptNode(1024,2,2),t.node.onaudioprocess=i(this),t.src.connect(t.node),t.node.connect(t.gain),t.gain.connect(e.destination)},unlisten:function(){var t=this._;t.src&&t.src.disconnect(),t.gain&&t.gain.disconnect(),t.node&&t.node.disconnect()}},i=function(n){return function(t){var e=n._,t=t.inputBuffer,i=t.length,s=e.writeIndex;e.bufferL.set(t.getChannelData(0),s),e.bufferR.set(t.getChannelData(1),s),e.writeIndex=s+i&4095,e.totalWrite+=i}},o.moz={set:function(t){var e=this._;t instanceof HTMLAudioElement&&(e.src=t,e.istep=e.samplerate/t.mozSampleRate)},listen:function(){var h=this._,u=h.bufferL,l=h.bufferR,c=0,f=0;2===h.src.mozChannels?(h.x=0,h.func=function(t){for(var e=h.writeIndex,i=h.totalWrite,s=t.frameBuffer,n=h.istep,r=s.length,a=h.x,o=0;o<r;o+=2){for(a+=n;0<a;)u[e]=.5*(s[o]+c),l[e]=.5*(s[o+1]+f),e=e+1&4095,++i,--a;c=s[o],f=s[o+1]}h.x=a,h.writeIndex=e,h.totalWrite=i}):(h.x=0,h.func=function(t){for(var e=h.writeIndex,i=h.totalWrite,s=t.frameBuffer,n=h.istep,r=s.length,a=h.x,o=0;o<r;++o){for(a+=n;0<=a;)u[e]=l[e]=.5*(s[o]+c),e=e+1&4095,++i,--a;c=s[o]}h.x=a,h.writeIndex=e,h.totalWrite=i}),h.src.addEventListener("MozAudioAvailable",h.func)},unlisten:function(){var t=this._;t.func&&(t.src.removeEventListener("MozAudioAvailable",t.func),t.func=null)}},a.register("mediastream",e))}(timbre),function(e){"use strict";var a=e.fn;function t(t){e.Object.call(this,1,t);t=this._;t.midi=0,t.value=0,t.prev=null,t.a4=440,t.ar=!1}a.extend(t);var i=t.prototype;Object.defineProperties(i,{midi:{set:function(t){"number"==typeof t&&(this._.midi=t)},get:function(){return this._.midi}},a4:{set:function(t){"number"==typeof t&&(this._.a4=t,this._.prev=null)},get:function(){return this._.a4}}}),i.bang=function(){return this._.prev=null,this._.emit("bang"),this},i.at=function(t){return this._.a4*Math.pow(2,(t-69)/12)},i.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var i=this.cells[0],t=this.nodes.length,s=i.length;if(e.ar&&t){a.inputSignalAR(this);for(var n=e.a4,r=0;r<s;++r)i[r]=n*Math.pow(2,(i[r]-69)/12);e.value=i[s-1],a.outputSignalAR(this)}else{t=t?a.inputSignalKR(this):e.midi;e.prev!==t&&(e.prev=t,e.value=e.a4*Math.pow(2,(t-69)/12)),i[0]=e.value,a.outputSignalKR(this)}}return this},a.register("midicps",t)}(timbre),function(e){"use strict";var o=e.fn;function t(t){e.Object.call(this,1,t);t=this._;t.midi=0,t.value=0,t.prev=null,t.range=12,t.ar=!1}o.extend(t);var i=t.prototype;Object.defineProperties(i,{midi:{set:function(t){"number"==typeof t&&(this._.midi=t)},get:function(){return this._.midi}},range:{set:function(t){"number"==typeof t&&0<t&&(this._.range=t)},get:function(){return this._.range}}}),i.bang=function(){return this._.prev=null,this._.emit("bang"),this},i.at=function(t){var e=this._;return Math.pow(2,t/e.range)},i.process=function(t){var e=this.cells[0],i=this._;if(this.tickID!==t){this.tickID=t;var t=this.nodes.length,s=e.length;if(i.ar&&t){o.inputSignalAR(this);for(var n=i.range,r=0;r<s;++r)e[r]=Math.pow(2,e[r]/n);i.value=e[s-1],o.outputSignalAR(this)}else{var t=this.nodes.length?o.inputSignalKR(this):i.midi,a=(i.prev!==t&&(i.prev=t,i.value=Math.pow(2,t/i.range)),i.value*i.mul+i.add);for(r=0;r<s;++r)e[r]=a}}return this},o.register("midiratio",t)}(timbre),function(e){"use strict";var l=e.fn;function t(t){e.Object.call(this,1,t)}l.extend(t),t.prototype.process=function(t){var e=this.cells[0],i=this._;if(this.tickID!==t){this.tickID=t;var s,n,r,a,o=this.nodes,h=o.length,u=e.length;if(i.ar){if(0<o.length)for(r=o[0].process(t).cells[0],e.set(r),s=1;s<h;++s)for(r=o[s].process(t).cells[0],n=0;n<u;++n)a=r[n],e[n]>a&&(e[n]=a);else for(n=0;n<u;++n)e[n]=0;l.outputSignalAR(this)}else{if(0<o.length)for(r=o[0].process(t).cells[0][0],s=1;s<h;++s)(a=o[s].process(t).cells[0][0])<r&&(r=a);else r=0;e[0]=r,l.outputSignalKR(this)}}return this},l.register("min",t)}(timbre),function(e){"use strict";var a=e.fn;function t(t){e.Object.call(this,0,t),a.timer(this),a.fixKR(this);t=this._;t.tracks=[],t.onended=a.make_onended(this),t.currentTime=0,this.on("start",i)}a.extend(t);var o,h,u,l,n,c,i=function(){var i=this,t=this._,e=t.mml;t.tracks=(e="string"==typeof e?[e]:e).map(function(t,e){return new r(i,e,t)}),t.currentTime=0,this.playbackState=a.PLAYING_STATE},s=(Object.defineProperty(i,"unremoved",{value:!0,writable:!1}),t.prototype),r=(Object.defineProperties(s,{mml:{set:function(t){var e=this._;"string"!=typeof t&&!Array.isArray(t)||(e.mml=t)},get:function(){return this._.mml}},currentTime:{get:function(){return this._.currentTime}}}),s.on=s.addListener=function(t,e){return"mml"===t&&(t="data",console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener.")),this._.events.on(t,e),this},s.once=function(t,e){return"mml"===t&&(t="data",console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener.")),this._.events.once(t,e),this},s.off=s.removeListener=function(t,e){return"mml"===t&&(t="data",console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener.")),this._.events.off(t,e),this},s.removeAllListeners=function(t){return"mml"===t&&(console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener."),t="data"),this._.events.removeAllListeners(t),this},s.listeners=function(t){return"mml"===t&&(console.warn("A 'mml' event listener was deprecated in ~v13.03.01. use 'data' event listener."),t="data"),this._.events.listeners(t)},s.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;for(var i=e.tracks,s=0,n=i.length;s<n;++s)i[s].process();for(;s--;)i[s].ended&&i.splice(s,1);0===i.length&&a.nextTick(e.onended),e.currentTime+=a.currentTimeIncr}return this},a.register("mml",t),f.prototype.process=function(){var t=this._,e=t.sequencer,i=t.trackNum,s=t.queue,n=!1;if(s.length)for(;s[0][0]<=t.currentTime;){var r=t.queue.shift();switch(r[1]){case 1:o(e,i,r[2],r[3]),t.remain=r[4],l(this);break;case 2:h(e,i,r[2],r[3]);break;case 3:u(e,r[2]);break;case 0:n=!0}if(0===s.length)break}t.remain-=a.currentTimeIncr,n&&(this.ended=!0),t.currentTime+=a.currentTimeIncr},o=function(t,e,i,s){for(var n,r=t.nodes,a=0,o=r.length;a<o;++a)(n=r[a]).noteOn?n.noteOn(i,s):n.bang();t._.emit("data","noteOn",{trackNum:e,noteNum:i,velocity:s})},h=function(t,e,i,s){for(var n,r=t.nodes,a=0,o=r.length;a<o;++a)(n=r[a]).noteOff?n.noteOff(i,s):n.release&&n.release();t._.emit("data","noteOff",{trackNum:e,noteNum:i,velocity:s})},u=function(t,e){t._.emit("data","command",{command:e})},l=function(t){var e,i,s,n,r,a,o,h,u,l,c,f,p=t._,d=(p.sequencer,p.commands),m=p.queue,v=p.index,g=p.status,b=p.queueTime,_=p.loopStack,y=[];t:for(;;){if(d.length<=v){if(!(0<=p.segnoIndex))break;v=p.segnoIndex}switch((e=d[v++]).name){case"@":m.push([b,3,e.val]);break;case"n":if(i=g.t||120,r=null!==e.len?(n=e.len,e.dot||0):(n=g.l,e.dot||g.dot),o=60/i*(4/n)*1e3,o*=[1,1.5,1.75,1.875][r]||1,a=g.v<<3,g.tie){for(c=m.length;c--;)if(m[c][2]){m.splice(c,1);break}s=p.prevNote}else s=p.prevNote=e.val+12*(g.o+1),m.push([b,1,s,a,o]);if(0<n){if((h=g.q/8)<1)for(m.push([u=b+o*h,2,s,a]),c=0,f=y.length;c<f;++c)m.push([u,2,y[c],a]);if(y=[],b+=o,!g.tie)break t}else y.push(s);g.tie=!1;break;case"r":i=g.t||120,r=null!==e.len?(n=e.len,e.dot||0):(n=g.l,e.dot||g.dot),0<n&&(o=60/i*(4/n)*1e3,b+=o*=[1,1.5,1.75,1.875][r]||1);break;case"l":g.l=e.val,g.dot=e.dot;break;case"o":g.o=e.val;break;case"<":g.o<9&&(g.o+=1);break;case">":0<g.o&&--g.o;break;case"v":g.v=e.val;break;case"(":g.v<15&&(g.v+=1);break;case")":0<g.v&&--g.v;break;case"q":g.q=e.val;break;case"&":g.tie=!0;break;case"$":p.segnoIndex=v;break;case"[":_.push([v,null,null]);break;case"|":(l=_[_.length-1])&&1===l[1]&&(_.pop(),v=l[2]);break;case"]":(l=_[_.length-1])&&(null===l[1]&&(l[1]=e.count,l[2]=v),--l[1],0===l[1]?_.pop():v=l[0]);break;case"t":g.t=null===e.val?120:e.val;break;case"EOF":m.push([b,0])}}p.index=v,p.queueTime=b},n=function(t){for(var e,i,s,n,r,a,o=new Array(t.length),h=[],u=0,l=c.length;u<l;++u)for(i=(e=c[u]).re;s=i.exec(t);){if(!o[s.index]){for(a=s[r=0].length;r<a;++r)o[s.index+r]=!0;(n=e.func?e.func(s):{name:s[0]})&&(n.index=s.index,n.origin=s[0],h.push(n))}for(;i.lastIndex<t.length&&o[i.lastIndex];)++i.lastIndex}return h.sort(function(t,e){return t.index-e.index}),h.push({name:"EOF"}),h},c=[{re:/@(\d*)/g,func:function(t){return{name:"@",val:t[1]||null}}},{re:/([cdefgab])([\-+]?)(\d*)(\.*)/g,func:function(t){return{name:"n",val:{c:0,d:2,e:4,f:5,g:7,a:9,b:11}[t[1]]+({"-":-1,"+":1}[t[2]]||0),len:""===t[3]?null:Math.min(0|t[3],64),dot:t[4].length}}},{re:/r(\d*)(\.*)/g,func:function(t){return{name:"r",len:""===t[1]?null:Math.max(1,Math.min(0|t[1],64)),dot:t[2].length}}},{re:/&/g},{re:/l(\d*)(\.*)/g,func:function(t){return{name:"l",val:""===t[1]?4:Math.min(0|t[1],64),dot:t[2].length}}},{re:/o([0-9])/g,func:function(t){return{name:"o",val:""===t[1]?4:0|t[1]}}},{re:/[<>]/g},{re:/v(\d*)/g,func:function(t){return{name:"v",val:""===t[1]?12:Math.min(0|t[1],15)}}},{re:/[()]/g},{re:/q([0-8])/g,func:function(t){return{name:"q",val:""===t[1]?6:Math.min(0|t[1],8)}}},{re:/\[/g},{re:/\|/g},{re:/\](\d*)/g,func:function(t){return{name:"]",count:0|t[1]||2}}},{re:/t(\d*)/g,func:function(t){return{name:"t",val:""===t[1]?null:Math.max(5,Math.min(0|t[1],300))}}},{re:/\$/g}],f);function f(t,e,i){var s=this._={};s.sequencer=t,s.trackNum=e,s.commands=n(i),s.status={t:120,l:4,o:4,v:12,q:6,dot:0,tie:!1},s.index=0,s.queue=[],s.currentTime=0,s.queueTime=0,s.segnoIndex=-1,s.loopStack=[],s.prevNote=0,s.remain=1/0,this.ended=!1,l(this)}}(timbre),function(e){"use strict";var i=e.fn;function t(t){e.Object.call(this,1,t)}i.extend(t),t.prototype.process=function(t){var e=this._;return this.tickID!==t&&(this.tickID=t,e.ar?(i.inputSignalAR(this),i.outputSignalAR(this)):(this.cells[0][0]=i.inputSignalKR(this),i.outputSignalKR(this))),this},i.register("mono",t)}(timbre),function(e){"use strict";var p=e.fn;function t(t){e.Object.call(this,2,t)}p.extend(t),t.prototype.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var i,s,n,r,a,o=this.nodes,h=this.cells[0],u=this.cells[1],l=this.cells[2],c=o.length,f=h.length;if(e.ar){if(0<o.length)for(o[0].process(t),r=o[0].cells[1],a=o[0].cells[2],u.set(r),l.set(a),i=1;i<c;++i)for(o[i].process(t),r=o[i].cells[1],a=o[i].cells[2],s=0;s<f;++s)u[s]*=r[s],l[s]*=a[s];else for(s=0;s<f;++s)u[s]=l[s]=0;p.outputSignalAR(this)}else{if(0<o.length)for(n=o[0].process(t).cells[0][0],i=1;i<c;++i)n*=o[i].process(t).cells[0][0];else n=0;h[0]=n,p.outputSignalKR(this)}}return this},p.register("*",t)}(timbre),function(e){"use strict";var c=e.fn;function t(t){e.Object.call(this,1,t);t=this._;t.defaultValue=0,t.index=0,t.dict={},t.ar=!1}c.extend(t);var i=t.prototype;Object.defineProperties(i,{dict:{set:function(t){if("object"==typeof t)this._.dict=t;else if("function"==typeof t){for(var e={},i=0;i<128;++i)e[i]=t(i);this._.dict=e}},get:function(){return this._.dict}},defaultValue:{set:function(t){"number"==typeof t&&(this._.defaultValue=t)},get:function(){return this._.defaultValue}},index:{set:function(t){"number"==typeof t&&(this._.index=t)},get:function(){return this._.index}}}),i.at=function(t){var e=this._;return(e.dict[0|t]||e.defaultValue)*e.mul+e.add},i.clear=function(){return this._.dict={},this},i.process=function(t){var e=this.cells[0],i=this._;if(this.tickID!==t){this.tickID=t;var s,n,r,t=this.nodes.length,a=i.dict,o=i.defaultValue,h=i.mul,u=i.add,l=e.length;if(i.ar&&t){for(c.inputSignalAR(this),r=0;r<l;++r)s=e[r],e[r]=(a[s=s<0?s-.5|0:s+.5|0]||o)*h+u;c.outputSignalAR(this)}else for(n=(a[s=(s=this.nodes.length?c.inputSignalKR(this):i.index)<0?s-.5|0:s+.5|0]||o)*h+u,r=0;r<l;++r)e[r]=n}return this},c.register("ndict",t)}(timbre),function(e){"use strict";var t=e.fn;function i(t){e.Object.call(this,1,t)}t.extend(i),i.prototype.process=function(t){var e=this.cells[0],i=this._;if(this.tickID!==t){this.tickID=t;var s,n,r,a=i.mul,o=i.add;if(i.ar)for(s=0,n=e.length;s<n;++s)e[s]=(2*Math.random()-1)*a+o;else for(r=(2*Math.random()+1)*a+o,s=0,n=e.length;s<n;++s)e[s]=r}return this},t.register("noise",i)}(timbre),function(e){"use strict";var l=e.fn,i=e.timevalue,s=e.modules.Oscillator;function n(t){e.Object.call(this,2,t);t=this._;t.freq=e(440),t.phase=e(0),t.osc=new s(t.samplerate),t.tmp=new l.SignalArray(t.cellsize),t.osc.step=t.cellsize,this.once("init",a)}l.extend(n);var r,a=function(){var t=this._;this.wave||(this.wave="sin"),t.plotData=t.osc.wave,t.plotLineWidth=2,t.plotCyclic=!0,t.plotBefore=r},t=n.prototype;Object.defineProperties(t,{wave:{set:function(t){this._.osc.setWave(t)},get:function(){return this._.osc.wave}},freq:{set:function(t){"string"==typeof t&&(t=(t=i(t))<=0?0:1e3/t),this._.freq=e(t)},get:function(){return this._.freq}},phase:{set:function(t){this._.phase=e(t),this._.osc.feedback=!1},get:function(){return this._.phase}},fb:{set:function(t){this._.phase=e(t),this._.osc.feedback=!0},get:function(){return this._.phase}}}),t.clone=function(){var t=l.clone(this);return t._.osc=this._.osc.clone(),t._.freq=this._.freq,t._.phase=this._.phase,t},t.bang=function(){return this._.osc.reset(),this._.emit("bang"),this},t.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var i=this.cells[1],s=this.cells[2],n=e.cellsize;if(this.nodes.length)l.inputSignalAR(this);else for(u=0;u<n;++u)i[u]=s[u]=1;var r=e.osc,a=e.freq.process(t).cells[0],t=e.phase.process(t).cells[0];if(r.frequency=a[0],r.phase=t[0],e.ar){var o=e.tmp;for(e.freq.isAr?e.phase.isAr?r.processWithFreqAndPhaseArray(o,a,t):r.processWithFreqArray(o,a):e.phase.isAr?r.processWithPhaseArray(o,t):r.process(o),u=0;u<n;++u)i[u]*=o[u],s[u]*=o[u]}else for(var h=r.next(),u=0;u<n;++u)i[u]*=h,s[u]*=h;l.outputSignalAR(this)}return this},"browser"===e.envtype&&(r=function(t,e,i,s,n){n=.5+(n>>1);t.strokeStyle="#ccc",t.lineWidth=1,t.beginPath(),t.moveTo(e,n+i),t.lineTo(e+s,n+i),t.stroke()}),l.register("osc",n),l.register("sin",function(t){return new n(t).set("wave","sin")}),l.register("cos",function(t){return new n(t).set("wave","cos")}),l.register("pulse",function(t){return new n(t).set("wave","pulse")}),l.register("tri",function(t){return new n(t).set("wave","tri")}),l.register("saw",function(t){return new n(t).set("wave","saw")}),l.register("fami",function(t){return new n(t).set("wave","fami")}),l.register("konami",function(t){return new n(t).set("wave","konami")}),l.register("+sin",function(t){return new n(t).set("wave","+sin").kr()}),l.register("+pulse",function(t){return new n(t).set("wave","+pulse").kr()}),l.register("+tri",function(t){return new n(t).set("wave","+tri").kr()}),l.register("+saw",function(t){return new n(t).set("wave","+saw").kr()}),l.alias("square","pulse")}(timbre),function(e){"use strict";var p=e.fn;function t(t){e.Object.call(this,2,t),p.fixAR(this);t=this._;t.pos=e(0),t.panL=.5,t.panR=.5}p.extend(t);var i=t.prototype;Object.defineProperties(i,{pos:{set:function(t){this._.pos=e(t)},get:function(){return this._.pos}}}),i.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var i,s,n=e.pos.process(t).cells[0][0],r=(e.prevPos!==n&&(e.panL=1-n,e.panR=e.prevPos=n),this.nodes),a=this.cells[1],o=this.cells[2],h=r.length,u=a.length;if(h){for(s=r[0].process(t).cells[0],f=0;f<u;++f)a[f]=o[f]=s[f];for(i=1;i<h;++i)for(s=r[i].process(t).cells[0],f=0;f<u;++f)a[f]=o[f]+=s[f];for(var l=e.panL,c=e.panR,f=0;f<u;++f)a[f]=a[f]*l,o[f]=o[f]*c}else a.set(p.emptycell),o.set(p.emptycell);p.outputSignalAR(this)}return this},p.register("pan",t)}(timbre),function(e){"use strict";var h=e.fn,a=e.timevalue,u=e.modules.Envelope,o=e.modules.EnvelopeValue;function t(t){e.Object.call(this,2,t);t=this._;t.value=0,t.env=new o(t.samplerate),t.env.step=t.cellsize,t.curve="lin",t.counter=0,t.ar=!1,t.onended=i(this),this.on("ar",s)}h.extend(t);var i=function(a,o){return function(){if("number"==typeof o)for(var t=a.cells[0],e=a.cells[1],i=a.cells[2],s=a._.env.value,n=0,r=e.length;n<r;++n)t[0]=e[n]=i[n]=s;a._.emit("ended")}},s=function(t){this._.env.step=t?1:this._.cellsize},n=t.prototype,l=(Object.defineProperties(n,{value:{set:function(t){"number"==typeof t&&(this._.env.value=t)},get:function(){return this._.env.value}}}),n.to=function(t,e,i){var s,n=this._,r=n.env;return"string"==typeof e?e=a(e):void 0===e&&(e=0),void 0===i?(n.counter=r.setNext(t,e,u.CurveTypeLin),n.curve="lin"):(s=u.CurveTypeDict[i],n.counter=void 0===s?r.setNext(t,e,u.CurveTypeCurve,i):r.setNext(t,e,s),n.curve=i),n.plotFlush=!0,this},n.setAt=function(t,e){var i=this._;return this.to(i.env.value,e,"set"),i.atValue=t,this},n.linTo=function(t,e){return this.to(t,e,"lin")},n.expTo=function(t,e){return this.to(t,e,"exp")},n.sinTo=function(t,e){return this.to(t,e,"sin")},n.welTo=function(t,e){return this.to(t,e,"wel")},n.sqrTo=function(t,e){return this.to(t,e,"sqr")},n.cubTo=function(t,e){return this.to(t,e,"cub")},n.cancel=function(){var t=this._;return t.counter=t.env.setNext(t.env.value,0,u.CurveTypeSet),this},n.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var i,s,n=this.cells[1],r=this.cells[2],a=e.cellsize,o=e.env,t=e.counter;if(this.nodes.length)h.inputSignalAR(this);else for(i=0;i<a;++i)n[i]=r[i]=1;if(t<=0&&("set"===e.curve?o.setNext(e.atValue,0,u.CurveTypeSet):o.setNext(o.value,0,u.CurveTypeSet),h.nextTick(e.onended),e.counter=1/0),e.ar){for(i=0;i<a;++i)s=o.next(),n[i]*=s,r[i]*=s;e.counter-=e.cellsize}else{for(s=o.next(),i=0;i<a;++i)n[i]*=s,r[i]*=s;--e.counter}h.outputSignalAR(this),e.value=s}return this},e.Object.prototype.plot);n.plot=function(t){var e=this._;if(e.plotFlush){var i,s,n,r=new o(128),a=new Float32Array(128);if("set"===e.curve)for(s=100,n=a.length;s<n;++s)a[s]=1;else for(void 0===(i=u.CurveTypeDict[e.curve])?r.setNext(1,1e3,u.CurveTypeCurve,e.curve):r.setNext(1,1e3,i),s=0,n=a.length;s<n;++s)a[s]=r.next();e.plotData=a,e.plotRange=[0,1],e.plotFlush=null}return l.call(this,t)},h.register("param",t)}(timbre),function(e){"use strict";var h=e.fn,s=e.modules.Biquad;function t(t){e.Object.call(this,2,t),h.fixAR(this);t=this._;t.freq=e("sin",{freq:1,add:1e3,mul:250}).kr(),t.Q=e(1),t.allpass=[],this.steps=2}h.extend(t);var i=t.prototype;Object.defineProperties(i,{freq:{set:function(t){this._.freq=t},get:function(){return this._.freq}},Q:{set:function(t){this._.Q=e(t)},get:function(){return this._.Q}},steps:{set:function(t){if("number"==typeof t){if(2===(t|=0)||4===t||8===t||12===t){var e=this._.allpass;if(e.length<t)for(var i=e.length;i<t;++i)e[i]=new s(this._.samplerate),e[i].setType("allpass")}this._.steps=t}},get:function(){return this._.steps}}}),i.process=function(t){var e=this._;if(this.tickID!==t){if(this.tickID=t,h.inputSignalAR(this),!e.bypassed)for(var i=this.cells[1],s=this.cells[2],n=e.freq.process(t).cells[0][0],r=e.Q.process(t).cells[0][0],a=e.steps,o=0;o<a;o+=2)e.allpass[o].setParams(n,r,0),e.allpass[o].process(i,s),e.allpass[o+1].setParams(n,r,0),e.allpass[o+1].process(i,s);h.outputSignalAR(this)}return this},h.register("phaser",t)}(timbre),function(s){"use strict";var n=s.fn;function t(t){s.Object.call(this,1,t),n.fixAR(this);for(var e=new Uint8Array(5),i=0;i<5;++i)e[i]=(Math.random()*(1<<30)|0)%25;this._.whites=e,this._.key=0}n.extend(t),t.prototype.process=function(t){var e=this.cells[0],i=this._;if(this.tickID!==t){this.tickID=t;for(var s,n,r,a=i.key,o=i.whites,h=i.mul,u=i.add,l=0,c=e.length;l<c;++l){for(r=a++^(a=31<a?0:a),s=n=0;s<5;++s)r&1<<s&&(o[s]=(Math.random()*(1<<30)|0)%25),n+=o[s];e[l]=(.01666666*n-1)*h+u}i.key=a}return this},n.register("pink",t)}(timbre),function(e){"use strict";var r=e.fn;function t(t){e.Object.call(this,1,t),this._.freq=440,this._.buffer=null,this._.index=0}r.extend(t);var i=t.prototype;Object.defineProperties(i,{freq:{set:function(t){"number"==typeof t&&(this._.freq=t=t<0?0:t)},get:function(){return this._.freq}}}),i.bang=function(){for(var t=this._,e=t.freq,i=t.samplerate/e+.5|0,s=t.buffer=new r.SignalArray(i),n=0;n<i;++n)s[n]=2*Math.random()-1;return t.index=0,t.emit("bang"),this},i.process=function(t){var e=this.cells[0],i=this._;if(this.tickID!==t){this.tickID=t;var s=i.buffer;if(s){for(var n,r,a=s.length,o=i.index,h=i.mul,u=i.add,l=e.length,c=0;c<l;++c)n=o,r=.5*(s[o++]+s[o=a<=o?0:o]),s[n]=r,e[c]=r*h+u;i.index=o}}return this},r.register("pluck",t)}(timbre),function(i){"use strict";var c=i.fn,e=i.timevalue;function t(t){i.Object.call(this,1,t),c.listener(this),c.fixAR(this);t=this._;t.timeout=5e3,t.status=0,t.writeIndex=0,t.writeIndexIncr=1,t.currentTime=0,t.currentTimeIncr=1e3/t.samplerate,t.onended=s(this)}c.extend(t);var s=function(i){return function(){var t=i._,e=new c.SignalArray(t.buffer.subarray(0,0|t.writeIndex));t.status=0,t.writeIndex=0,t.currentTime=0,t.emit("ended",{buffer:e,samplerate:t.samplerate})}},n=t.prototype;Object.defineProperties(n,{timeout:{set:function(t){"number"==typeof(t="string"==typeof t?e(t):t)&&0<t&&(this._.timeout=t)},get:function(){return this._.timeout}},samplerate:{set:function(t){"number"==typeof t&&0<t&&t<=this._.samplerate&&(this._.samplerate=t)},get:function(){return this._.samplerate}},currentTime:{get:function(){return this._.currentTime}}}),n.start=function(){var t,e=this._;return 0===e.status&&(t=.01*e.timeout*e.samplerate|0,(!e.buffer||e.buffer.length<t)&&(e.buffer=new c.SignalArray(t)),e.writeIndex=0,e.writeIndexIncr=e.samplerate/i.samplerate,e.currentTime=0,e.status=1,e.emit("start"),this.listen()),this},n.stop=function(){var t=this._;return 1===t.status&&(t.status=0,t.emit("stop"),c.nextTick(t.onended),this.unlisten()),this},n.bang=function(){return 0===this._.status?this.srart():1===this._.status&&this.stop(),this._.emit("bang"),this},n.process=function(t){var e=this._,i=this.cells[0];if(this.tickID!==t){if(this.tickID=t,c.inputSignalAR(this),1===e.status){for(var s=i.length,n=e.buffer,r=e.timeout,a=e.writeIndex,o=e.writeIndexIncr,h=e.currentTime,u=e.currentTimeIncr,l=0;l<s;++l)n[0|a]=i[l],a+=o,r<=(h+=u)&&c.nextTick(e.onended);e.writeIndex=a,e.currentTime=h}c.outputSignalAR(this)}return this},c.register("record",t),c.alias("rec","record")}(timbre),function(e){"use strict";var i=e.fn,s=e.modules.Reverb;function t(t){e.Object.call(this,2,t),i.fixAR(this),this._.reverb=new s(this._.samplerate,this._.cellsize)}i.extend(t);var n=t.prototype;Object.defineProperties(n,{room:{set:function(t){"number"==typeof t&&this._.reverb.setRoomSize(t=1<t?1:t<0?0:t)},get:function(){return this._.reverb.roomsize}},damp:{set:function(t){"number"==typeof t&&this._.reverb.setDamp(t=1<t?1:t<0?0:t)},get:function(){return this._.reverb.damp}},mix:{set:function(t){"number"==typeof t&&(this._.reverb.wet=t=1<t?1:t<0?0:t)},get:function(){return this._.reverb.wet}}}),n.process=function(t){var e=this._;return this.tickID!==t&&(this.tickID=t,i.inputSignalAR(this),e.bypassed||e.reverb.process(this.cells[1],this.cells[2]),i.outputSignalAR(this)),this},i.register("reverb",t)}(timbre),function(a){"use strict";var r=a.fn,o=a.timevalue;function t(t){a.Object.call(this,0,t),r.timer(this),r.fixKR(this);t=this._;t.queue=[],t.currentTime=0,t.maxRemain=1e3}r.extend(t);var e=t.prototype;Object.defineProperties(e,{queue:{get:function(){return this._.queue}},remain:{get:function(){return this._.queue.length}},maxRemain:{set:function(t){"number"==typeof t&&0<t&&(this._.maxRemain=t)},get:function(){return this._.maxRemain}},isEmpty:{get:function(){return 0===this._.queue.length}},currentTime:{get:function(){return this._.currentTime}}}),e.sched=function(t,e,i){return"number"==typeof(t="string"==typeof t?o(t):t)&&this.schedAbs(this._.currentTime+t,e,i),this},e.schedAbs=function(t,e,i){if("number"==typeof(t="string"==typeof t?o(t):t)){var s=this._,n=s.queue;if(n.length>=s.maxRemain)return this;for(var r=n.length;r--&&!(n[r][0]<t););n.splice(r+1,0,[t,a(e),i])}return this},e.advance=function(t){return"number"==typeof(t="string"==typeof t?o(t):t)&&(this._.currentTime+=t),this},e.clear=function(){return this._.queue.splice(0),this},e.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var i=null,s=e.queue;if(s.length)for(;s[0][0]<e.currentTime;){var n=e.queue.shift();if(n[1].bang(n[2]),i="sched",0===s.length){i="empty";break}}e.currentTime+=r.currentTimeIncr,i&&e.emit(i)}return this},r.register("schedule",t),r.alias("sched","schedule")}(timbre),function(e){"use strict";var c=e.fn,i=e.timevalue;function t(t){e.Object.call(this,2,t),c.listener(this),c.fixAR(this);t=this._;t.samples=0,t.writeIndex=0,t.plotFlush=!0,this.once("init",s)}c.extend(t);var s=function(){this._.buffer||(this.size=1024),this._.interval||(this.interval=1e3)},n=t.prototype,h=(Object.defineProperties(n,{size:{set:function(t){var e=this._;e.buffer||"number"==typeof t&&(e.buffer=new c.SignalArray(t<64?64:2048<t?2048:t),e.reservedinterval)&&(this.interval=e.reservedinterval,e.reservedinterval=null)},get:function(){return this._.buffer.length}},interval:{set:function(t){var e=this._;"number"==typeof(t="string"==typeof t?i(t):t)&&0<t&&(e.buffer?(e.interval=t,e.samplesIncr=.001*t*e.samplerate/e.buffer.length,e.samplesIncr<1&&(e.samplesIncr=1)):e.reservedinterval=t)},get:function(){return this._.interval}},buffer:{get:function(){return this._.buffer}}}),n.bang=function(){for(var t=this._,e=t.buffer,i=0,s=e.length;i<s;++i)e[i]=0;return t.samples=0,t.writeIndex=0,this._.emit("bang"),this},n.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t,c.inputSignalAR(this),c.outputSignalAR(this);for(var i=this.cells[0],s=e.cellsize,n=e.samples,r=e.samplesIncr,a=e.buffer,o=e.writeIndex,h=!1,u=a.length,l=0;l<s;++l)n<=0&&(a[o++]=i[l],u<=o&&(o=0),h=e.plotFlush=!0,n+=r),--n;e.samples=n,e.writeIndex=o,h&&this._.emit("data")}return this},e.Object.prototype.plot);n.plot=function(t){var e=this._;if(e.plotFlush){for(var i=e.buffer,s=i.length-1,n=new Float32Array(i.length),r=e.writeIndex,a=0,o=i.length;a<o;a++)n[a]=i[++r&s];e.plotData=n,e.plotFlush=null}return h.call(this,t)},c.register("scope",t)}(timbre),function(i){"use strict";var u=i.fn;function t(t){i.Object.call(this,2,t),u.fixAR(this);t=this._;t.numberOfInputs=0,t.numberOfOutputs=0,t.bufferSize=0,t.bufferMask=0,t.duration=0,t.inputBufferL=null,t.inputBufferR=null,t.outputBufferL=null,t.outputBufferR=null,t.onaudioprocess=null,t.index=0,this.once("init",e)}u.extend(t);var e=function(){var t=this._;0===t.numberOfInputs&&(this.numberOfInputs=1),0===t.numberOfOutputs&&(this.numberOfOutputs=1),0===t.bufferSize&&(this.bufferSize=1024)},s=t.prototype;function n(t,e){this.samplerate=t._.samplerate,this.length=t._.bufferSize,this.duration=t._.duration,this.numberOfChannels=e.length,this.getChannelData=function(t){return e[t]}}function l(t){var e=t._;this.node=t,this.playbackTime=i.currentTime,2===e.numberOfInputs?this.inputBuffer=new n(t,[e.inputBufferL,e.inputBufferR]):this.inputBuffer=new n(t,[e.inputBufferL]),2===e.numberOfOutputs?this.outputBuffer=new n(t,[e.outputBufferL,e.outputBufferR]):this.outputBuffer=new n(t,[e.outputBufferL])}Object.defineProperties(s,{numberOfInputs:{set:function(t){var e=this._;0===e.numberOfInputs&&(e.numberOfInputs=2===t?2:1)},get:function(){return this._.numberOfInputs}},numberOfOutputs:{set:function(t){var e=this._;0===e.numberOfOutputs&&(e.numberOfOutputs=2===t?2:1)},get:function(){return this._.numberOfOutputs}},bufferSize:{set:function(t){var e=this._;0===e.bufferSize&&-1!==[256,512,1024,2048,4096,8192,16384].indexOf(t)&&(e.bufferSize=t,e.bufferMask=t-1,e.duration=t/e.samplerate,e.inputBufferL=new u.SignalArray(t),e.inputBufferR=new u.SignalArray(t),e.outputBufferL=new u.SignalArray(t),e.outputBufferR=new u.SignalArray(t))},get:function(){return this._.bufferSize}},onaudioprocess:{set:function(t){"function"==typeof t&&(this._.onaudioprocess=t)},get:function(){return this._.onaudioprocess}}}),s.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var i=e.cellsize,t=e.bufferMask,s=e.index,n=s+i,r=this.cells[1],a=this.cells[2];if(u.inputSignalAR(this),2===e.numberOfInputs)e.inputBufferL.set(r,s),e.inputBufferR.set(a,s);else for(var o=e.inputBufferL,h=0;h<i;h++)o[s+h]=.5*(r[h]+a[h]);r.set(e.outputBufferL.subarray(s,n)),a.set(e.outputBufferR.subarray(s,n)),e.index=n&t,0===e.index&&e.onaudioprocess&&(e.onaudioprocess(new l(this)),1===e.numberOfOutputs)&&e.outputBufferR.set(e.outputBufferL),u.outputSignalAR(this)}return this},u.register("script",t)}(timbre),function(e){"use strict";var a=e.fn;function t(t){e.Object.call(this,2,t),this._.selected=0,this._.background=!1}a.extend(t);var i=t.prototype;Object.defineProperties(i,{selected:{set:function(t){"number"==typeof t&&(this._.selected=t,this.cells[1].set(a.emptycell),this.cells[2].set(a.emptycell))},get:function(){return this._.selected}},background:{set:function(t){this._.background=!!t},get:function(){return this._.background}}}),i.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var i,s=this.nodes,n=s.length;if(e.background)for(i=0;i<n;++i)s[i].process(t);var r=s[e.selected];r&&(e.background||r.process(t),this.cells[1].set(r.cells[1]),this.cells[2].set(r.cells[2])),a.outputSignalAR(this)}return this},a.register("selector",t)}(timbre),function(e){"use strict";var f=e.fn,i=e.timevalue,s=e.modules.FFT;function t(t){e.Object.call(this,2,t),f.listener(this),f.fixAR(this);t=this._;t.status=0,t.samples=0,t.samplesIncr=0,t.writeIndex=0,t.plotFlush=!0,t.plotRange=[0,32],t.plotBarStyle=!0,this.once("init",n)}f.extend(t);var n=function(){var t=this._;t.fft||(this.size=512),t.interval||(this.interval=500)},r=t.prototype,a=(Object.defineProperties(r,{size:{set:function(t){var e=this._;e.fft||"number"==typeof t&&(e.fft=new s(t<256?256:2048<t?2048:t),e.buffer=new f.SignalArray(e.fft.length),e.freqs=new f.SignalArray(e.fft.length>>1),e.reservedwindow&&(e.fft.setWindow(e.reservedwindow),e.reservedwindow=null),e.reservedinterval)&&(this.interval=e.reservedinterval,e.reservedinterval=null)},get:function(){return this._.buffer.length}},window:{set:function(t){this._.fft.setWindow(t)},get:function(){return this._.fft.windowName}},interval:{set:function(t){var e=this._;"number"==typeof(t="string"==typeof t?i(t):t)&&0<t&&(e.buffer?(e.interval=t,e.samplesIncr=.001*t*e.samplerate,e.samplesIncr<e.buffer.length&&(e.samplesIncr=e.buffer.length,e.interval=1e3*e.samplesIncr/e.samplerate)):e.reservedinterval=t)},get:function(){return this._.interval}},spectrum:{get:function(){return this._.fft.getFrequencyData(this._.freqs)}},real:{get:function(){return this._.fft.real}},imag:{get:function(){return this._.fft.imag}}}),r.bang=function(){return this._.samples=0,this._.writeIndex=0,this._.emit("bang"),this},r.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t,f.inputSignalAR(this),f.outputSignalAR(this);for(var i,s=this.cells[0],n=s.length,r=e.status,a=e.samples,o=e.samplesIncr,h=e.writeIndex,u=e.buffer,l=u.length,c=0;c<n;++c)a<=0&&0===r&&(r=1,h=0,a+=o),1===r&&(u[h++]=s[c],l<=h)&&(e.fft.forward(u),i=e.plotFlush=!0,r=0),--a;e.samples=a,e.status=r,e.writeIndex=h,i&&this._.emit("data")}return this},e.Object.prototype.plot);r.plot=function(t){return this._.plotFlush&&(this._.plotData=this.spectrum,this._.plotFlush=null),a.call(this,t)},f.register("spectrum",t)}(timbre),function(e){"use strict";var p=e.fn;function t(t){e.Object.call(this,2,t),this._.ar=!1}p.extend(t),t.prototype.process=function(t){var e=this._;if(this.tickID!==t){this.tickID=t;var i,s,n,r,a,o=this.nodes,h=this.cells[0],u=this.cells[1],l=this.cells[2],c=o.length,f=h.length;if(e.ar){if(0<o.length)for(o[0].process(t),r=o[0].cells[1],a=o[0].cells[2],u.set(r),l.set(a),i=1;i<c;++i)for(o[i].process(t),r=o[i].cells[1],a=o[i].cells[2],s=0;s<f;++s)u[s]-=r[s],l[s]-=a[s];else for(s=0;s<f;++s)u[s]=l[i]=0;p.outputSignalAR(this)}else{if(0<o.length)for(n=o[0].process(t).cells[0][0],i=1;i<c;++i)n-=o[i].process(t).cells[0][0];else n=0;h[0]=n,p.outputSignalKR(this)}}return this},p.register("-",t)}(timbre),function(l){"use strict";var p=l.fn;function e(t){l.Object.call(this,2,t),p.fixAR(this);t=this._;this.playbackState=p.FINISHED_STATE,t.poly=4,t.genList=[],t.genDict={},t.synthdef=null,t.remGen=a(this),t.onended=p.make_onended(this)}p.extend(e);function c(t,e){return function(){t._.remGen(e.gen)}}function n(t,e,i,s){(i|=0)<=0?this.noteOff(this,t):127<i&&(i=127);var n=this._,r=n.genList,a=n.genDict,o=a[t],h=(o&&n.remGen(o),{freq:e,noteNum:t,velocity:i,mul:.0078125*i});if(s)for(var u in s)h[u]=s[u];h.doneAction=c(this,h),(o=n.synthdef.call(this,h))instanceof l.Object&&(o.noteNum=t,r.push(o),a[t]=h.gen=o,this.playbackState=p.PLAYING_STATE,r.length>n.poly)&&n.remGen(r[0])}function r(t){return 0<t?Math.log(+t/440)*Math.LOG2E*12+69:0}var i,s,t=e.prototype,a=(Object.defineProperties(t,{def:{set:function(t){"function"==typeof t&&(this._.synthdef=t)},get:function(){return this._.synthdef}},poly:{set:function(t){"number"==typeof t&&0<t&&t<=64&&(this._.poly=t)},get:function(){return this._.poly}}}),function(s){return function(t){var e=s._,i=e.genList.indexOf(t);-1!==i&&e.genList.splice(i,1),void 0!==t.noteNum&&(e.genDict[t.noteNum]=null)}}),o=function(){for(var t=new Float32Array(128),e=0;e<128;++e)t[e]=440*Math.pow(2,(e-69)/12);return t}(),h=(t.noteOn=function(t,e,i){var s=o[t]||440*Math.pow(2,(t-69)/12);return n.call(this,t+.5|0,s,e,i),this},t.noteOff=function(t){t=this._.genDict[t];return t&&t.release&&t.release(),this},t.noteOnWithFreq=function(t,e,i){var s=r(t);return n.call(this,s+.5|0,t,e,i),this},t.noteOffWithFreq=function(t){t=r(t);return this.noteOff(t+.5|0)},t.allNoteOff=function(){for(var t=this._.genList,e=0,i=t.length;e<i;++e)t[e].release&&t[e].release()},t.allSoundOff=function(){for(var t=this._,e=t.genList,i=t.genDict;e.length;)delete i[e.shift().noteNum]},t.synth=function(t){var e,i=this._,s=i.genList,n={};if(t)for(var r in t)n[r]=t[r];return n.doneAction=c(this,n),(e=i.synthdef.call(this,n))instanceof l.Object&&(s.push(e),n.gen=e,this.playbackState=p.PLAYING_STATE,s.length>i.poly)&&i.remGen(s[0]),this},t.process=function(t){var e=this.cells[0],i=this._;if(this.tickID!==t){if(this.tickID=t,this.playbackState===p.PLAYING_STATE){var s,n,r,a,o,h,u=i.genList,l=this.cells[1],c=this.cells[2],f=e.length;if(u.length)for((s=u[0]).process(t),l.set(s.cells[1]),c.set(s.cells[2]),n=1,r=u.length;n<r;++n)for((s=u[n]).process(t),o=s.cells[1],h=s.cells[2],a=0;a<f;++a)l[a]+=o[a],c[a]+=h[a];else p.nextTick(i.onended)}p.outputSignalAR(this)}return this},p.register("SynthDef",e),{set:function(t){p.isDictionary(t)?"string"==typeof t.type&&(this._.env=t):t instanceof l.Object&&(this._.env=t)},get:function(){return this._.env}});function u(t){var e=this._,i=e.osc||null,s=e.env||{},n=s.type||"perc";return(i=(i=i instanceof l.Object&&"function"==typeof i.clone?i.clone():i)||l("osc",{wave:e.wave})).freq=t.freq,i.mul=i.mul*t.velocity/128,e=i,s instanceof l.Object?"function"==typeof s.clone&&(e=s.clone().append(e)):e=l(n,s,e),e.on("ended",t.doneAction).bang(),e}function f(t){var e=this._.env||{},i=e.type||"perc",s=l("pluck",{freq:t.freq,mul:t.velocity/128}).bang();return e instanceof l.Object?"function"==typeof e.clone&&(s=e.clone().append(s)):s=l(i,e,s),s.on("ended",t.doneAction).bang(),s}p.register("OscGen",(i={set:function(t){t instanceof l.Object&&(this._.osc=t)},get:function(){return this._.osc}},s={set:function(t){"string"==typeof t&&(this._.wave=t)},get:function(){return this._.wave}},function(t){t=new e(t);return t._.wave="sin",Object.defineProperties(t,{env:h,osc:i,wave:s}),t.def=u,t})),p.register("PluckGen",function(t){t=new e(t);return Object.defineProperties(t,{env:h}),t.def=f,t})}(timbre),function(e){"use strict";var r=e.fn,i=e.modules.Scissor,s=i.Tape,n=i.TapeStream,a=r.isSignalArray;function t(t){e.Object.call(this,2,t),r.fixAR(this);t=this._;t.isLooped=!1,t.onended=r.make_onended(this,0)}r.extend(t);var o=t.prototype;Object.defineProperties(o,{tape:{set:function(t){t instanceof s?(this.playbackState=r.PLAYING_STATE,this._.tape=t,this._.tapeStream=new n(t,this._.samplerate),this._.tapeStream.isLooped=this._.isLooped):"object"==typeof(t=t instanceof e.Object&&t.buffer?t.buffer:t)&&Array.isArray(t.buffer)&&a(t.buffer[0])&&(this.playbackState=r.PLAYING_STATE,this._.tape=new i(t),this._.tapeStream=new n(this._.tape,this._.samplerate),this._.tapeStream.isLooped=this._.isLooped)},get:function(){return this._.tape}},isLooped:{get:function(){return this._.isLooped}},buffer:{get:function(){if(this._.tape)return this._.tape.getBuffer()}}}),o.loop=function(t){return this._.isLooped=!!t,this._.tapeStream&&(this._.tapeStream.isLooped=this._.isLooped),this},o.bang=function(){return this.playbackState=r.PLAYING_STATE,this._.tapeStream&&this._.tapeStream.reset(),this._.emit("bang"),this},o.getBuffer=function(){if(this._.tape)return this._.tape.getBuffer()},o.process=function(t){var e,i,s,n=this._;return this.tickID!==t&&(this.tickID=t,(t=n.tapeStream)&&(e=this.cells[1],i=this.cells[2],s=t.fetch(e.length),e.set(s[0]),i.set(s[1]),this.playbackState===r.PLAYING_STATE)&&t.isEnded&&r.nextTick(n.onended),r.outputSignalAR(this)),this},r.register("tape",t)}(timbre),function(e){"use strict";var h=e.fn,i=e.timevalue,s=e(function(){}).constructor;function t(t){e.Object.call(this,1,t),h.timer(this);t=this._;this.playbackState=h.FINISHED_STATE,t.task=[],t.i=0,t.j=0,t.imax=0,t.jmax=0,t.wait=0,t.count=0,t.args={},t.doNum=1,t.initFunc=h.nop,t.onended=r(this),this.on("start",n)}h.extend(t);var n=function(){var t,e=this._;this.playbackState=h.PLAYING_STATE,e.task=this.nodes.map(function(t){return t instanceof s&&t.func}).filter(function(t){return!!t}),e.i=e.j=0,e.imax=e.doNum,e.jmax=e.task.length,t=e.initFunc(),h.isDictionary(t)||(t={param:t}),e.args=t},r=function(o){return function(){o.playbackState=h.FINISHED_STATE;var t=o._,e=o.cells[0],i=o.cells[1],s=o.cells[2],n=t.args;if("number"==typeof n)for(var r=0,a=i.length;r<a;++r)e[0]=i[r]=s[r]=n;t.emit("ended",t.args)}},a=t.prototype;Object.defineProperties(a,{do:{set:function(t){"number"==typeof t&&0<t&&(this._.doNum=t===1/0?1/0:0|t)},get:function(){return this._.doNum}},init:{set:function(t){"function"==typeof t&&(this._.initFunc=t)},get:function(){return this._.initFunc}}}),a.bang=function(){var t=this._;return t.count=0,t.emit("bang"),this},a.wait=function(t){return"number"==typeof(t="string"==typeof t?i(t):t)&&0<t&&(this._.count+=this._.samplerate*t*.001|0),this},a.process=function(t){var e,i=this.cells[0],s=this._;if(this.tickID!==t&&(this.tickID=t,s.i<s.imax)){for(;s.count<=0;){if(s.j>=s.jmax){if(++s.i,s.i>=s.imax){h.nextTick(s.onended);break}s.j=0}(e=s.task[s.j++])&&e.call(this,s.i,s.args)}s.count-=i.length}return this},h.register("task",t)}(timbre),function(e){"use strict";var a=e.fn,i=e.timevalue;function t(t){e.Object.call(this,0,t),a.timer(this),a.fixKR(this);t=this._;this.playbackState=a.FINISHED_STATE,t.currentTime=0,t.samplesMax=0,t.samples=0,t.onended=a.make_onended(this),this.once("init",s),this.on("start",n)}a.extend(t);var s=function(){this._.timeout||(this.timeout=1e3)},n=function(){this.playbackState=a.PLAYING_STATE},r=(Object.defineProperty(n,"unremovable",{value:!0,writable:!1}),t.prototype);Object.defineProperties(r,{timeout:{set:function(t){var e=this._;"number"==typeof(t="string"==typeof t?i(t):t)&&0<=t&&(this.playbackState=a.PLAYING_STATE,e.timeout=t,e.samplesMax=e.samplerate*(.001*t)|0,e.samples=e.samplesMax)},get:function(){return this._.timeout}},currentTime:{get:function(){return this._.currentTime}}}),r.bang=function(){var t=this._;return this.playbackState=a.PLAYING_STATE,t.samples=t.samplesMax,t.currentTime=0,t.emit("bang"),this},r.process=function(t){var e=this.cells[0],i=this._;if(this.tickID!==t){if(this.tickID=t,0<i.samples&&(i.samples-=e.length),i.samples<=0){for(var s=this.nodes,n=0,r=s.length;n<r;++n)s[n].bang();a.nextTick(i.onended)}i.currentTime+=a.currentTimeIncr}return this},a.register("timeout",t)}(timbre),function(e){"use strict";var h=e.fn;function t(t){e.Object.call(this,1,t),h.fixAR(this),this._.curve=null}h.extend(t);var i=t.prototype;Object.defineProperties(i,{curve:{set:function(t){h.isSignalArray(t)&&(this._.curve=t)},get:function(){return this._.curve}}}),i.process=function(t){var e=this._;if(this.tickID!==t){if(this.tickID=t,h.inputSignalAR(this),e.curve)for(var i,s=this.cells[0],n=e.curve,r=n.length,a=e.cellsize,o=0;o<a;++o)(i=.5*(s[o]+1)*r+.5|0)<0?i=0:r-1<=i&&(i=r-1),s[o]=n[i];h.outputSignalAR(this)}return this},h.register("waveshaper",t)}(timbre),function(e){"use strict";var p=e.fn;function t(t){e.Object.call(this,1,t);t=this._;t.inMin=0,t.inMax=1,t.outMin=0,t.outMax=1,t.ar=!1,this.once("init",i)}p.extend(t);var i=function(){this._.warp||(this.warp="linlin")},s=t.prototype,n=(Object.defineProperties(s,{inMin:{set:function(t){"number"==typeof t&&(this._.inMin=t)},get:function(){return this._.inMin}},inMax:{set:function(t){"number"==typeof t&&(this._.inMax=t)},get:function(){return this._.inMax}},outMin:{set:function(t){"number"==typeof t&&(this._.outMin=t)},get:function(){return this._.outMin}},outMax:{set:function(t){"number"==typeof t&&(this._.outMax=t)},get:function(){return this._.outMax}},warp:{set:function(t){var e;"string"==typeof t&&(e=n[t])&&(this._.warp=e,this._.warpName=t)},get:function(){return this._.warpName}}}),s.process=function(t){var e=this._,i=this.cells[0];if(this.tickID!==t){this.tickID=t;var s=e.inMin,n=e.inMax,r=e.outMin,a=e.outMax,o=e.warp,t=this.nodes.length,h=e.mul,u=e.add,l=i.length;if(e.ar&&t){for(p.inputSignalAR(this),f=0;f<l;++f)i[f]=o(i[f],s,n,r,a)*h+u;p.outputSignalAR(this)}else for(var c=o(this.nodes.length?p.inputSignalKR(this):0,s,n,r,a)*h+u,f=0;f<l;++f)i[f]=c}return this},{linlin:function(t,e,i,s,n){return t<e?s:i<t?n:i===e?s:(t-e)/(i-e)*(n-s)+s},linexp:function(t,e,i,s,n){return t<e?s:i<t?n:0===s?0:i===e?n:Math.pow(n/s,(t-e)/(i-e))*s},explin:function(t,e,i,s,n){return t<e?s:i<t||0===e?n:Math.log(t/e)/Math.log(i/e)*(n-s)+s},expexp:function(t,e,i,s,n){return t<e?s:i<t?n:0===e||0===s?0:Math.pow(n/s,Math.log(t/e)/Math.log(i/e))*s}});p.register("zmap",t)}(timbre);