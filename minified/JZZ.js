!function(){function a(){this._orig=this,this._ready=!1,this._queue=[],this._err=[]}function b(a,b){setTimeout(function(){a._resume()},b)}function c(a){a instanceof Function?a.apply(this):console.log(a)}function d(a){a instanceof Function?a.apply(this):console.log(a)}function e(a){this._break("closed"),a._resume()}function f(a){if(!a.length)return void this._break();var b=a.shift();if(a.length){var c=this;this._slip(d,[function(){f.apply(c,[a])}])}try{this._repair(),b.apply(this)}catch(e){this._break(e.toString())}}function g(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return;a.push(b)}function h(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return void a.splice(c,1)}function i(){a.apply(this)}function j(){i.prototype._time||(i.prototype._time=function(){return Date.now()}),i.prototype._startTime=i.prototype._time(),i.prototype.time=function(){return i.prototype._time()-i.prototype._startTime}}function k(a,b,c){if("undefined"==typeof b)return k(a,[],[]);if(a instanceof Object){for(var d=0;d<b.length;d++)if(b[d]===a)return c[d];var e;e=a instanceof Array?[]:{},b.push(a),c.push(e);for(var f in a)a.hasOwnProperty(f)&&(e[f]=k(a[f],b,c));return e}return a}function l(){this._info.engine=ba._type,this._info.version=ba._version,this._info.sysex=ba._sysex,this._info.inputs=[],this._info.outputs=[],$=[],_=[],ba._allOuts={},ba._allIns={};var a,b;for(a=0;a<ba._outs.length;a++)b=ba._outs[a],b.engine=ba,ba._allOuts[b.name]=b,this._info.outputs.push({name:b.name,manufacturer:b.manufacturer,version:b.version,engine:ba._type}),$.push(b);for(a=0;a<ca._outs.length;a++)b=ca._outs[a],this._info.outputs.push({name:b.name,manufacturer:b.manufacturer,version:b.version,engine:b.type}),$.push(b);for(a=0;a<ba._ins.length;a++)b=ba._ins[a],b.engine=ba,ba._allIns[b.name]=b,this._info.inputs.push({name:b.name,manufacturer:b.manufacturer,version:b.version,engine:ba._type}),_.push(b);for(a=0;a<ca._ins.length;a++)b=ca._ins[a],this._info.inputs.push({name:b.name,manufacturer:b.manufacturer,version:b.version,engine:b.type}),_.push(b)}function m(){this._slip(l,[]),ba._refresh()}function n(a,b){if("undefined"==typeof a)return b.slice();var c,d,e=[];if(a instanceof RegExp){for(d=0;d<b.length;d++)a.test(b[d].name)&&e.push(b[d]);return e}for(a instanceof Function&&(a=a(b)),a instanceof Array||(a=[a]),c=0;c<a.length;c++)for(d=0;d<b.length;d++)(a[c]+""==d+""||a[c]===b[d].name||a[c]instanceof Object&&a[c].name===b[d].name)&&e.push(b[d]);return e}function o(a,b){var c;c=b instanceof RegExp?"Port matching "+b+" not found":b instanceof Object||"undefined"==typeof b?"Port not found":'Port "'+b+'" not found',a._crash(c)}function p(a,b){function c(a){return function(){a.engine._openOut(this,a.name)}}var d=n(b,$);if(!d.length)return void o(a,b);for(var e=0;e<d.length;e++)d[e]=c(d[e]);a._slip(f,[d]),a._resume()}function q(a,b){function c(a){return function(){a.engine._openIn(this,a.name)}}var d=n(b,_);if(!d.length)return void o(a,b);for(var e=0;e<d.length;e++)d[e]=c(d[e]);a._slip(f,[d]),a._resume()}function r(){a.apply(this),this._handles=[],this._outs=[]}function s(a){this._receive(a)}function t(a){this._emit(a)}function u(a){a instanceof Function?g(this._orig._handles,a):g(this._orig._outs,a)}function v(a){a instanceof Function?h(this._orig._handles,a):h(this._orig._outs,a)}function w(){return"undefined"!=typeof module&&module.exports?void H(require("jazz-midi")):void this._break()}function x(){var a=document.createElement("div");a.style.visibility="hidden",document.body.appendChild(a);var b=document.createElement("object");return b.style.visibility="hidden",b.style.width="0px",b.style.height="0px",b.classid="CLSID:1ACE1618-1C7D-4561-AEE1-34842AA85E90",b.type="audio/x-jazz",document.body.appendChild(b),b.isJazz?void I(b):void this._break()}function y(){function a(a){J(a),c._resume()}function b(a){c._crash(a)}if(navigator.requestMIDIAccess){var c=this,d={};return navigator.requestMIDIAccess(d).then(a,b),void this._pause()}this._break()}function z(){function a(a){J(a,!0),c._resume()}function b(a){c._crash(a)}if(navigator.requestMIDIAccess){var c=this,d={sysex:!0};return navigator.requestMIDIAccess(d).then(a,b),void this._pause()}this._break()}function A(){function a(e){if(b=!0,c||(c=document.getElementById("jazz-midi-msg")),c){var f=[];try{f=JSON.parse(c.innerText)}catch(e){}c.innerText="",document.removeEventListener("jazz-midi-msg",a),"version"===f[0]?(K(c,f[2]),d._resume()):d._crash()}}var b,c,d=this;this._pause(),document.addEventListener("jazz-midi-msg",a);try{document.dispatchEvent(new Event("jazz-midi"))}catch(e){}window.setTimeout(function(){b||d._crash()},0)}function B(){this._pause();var a=this;setTimeout(function(){a._crash()},0)}function C(a){for(var b=[w,B],c=D(a),d=0;d<c.length;d++)"webmidi"==c[d]?(a&&a.sysex===!0&&b.push(z),a&&a.sysex===!0&&a.degrade!==!0||b.push(y)):"extension"==c[d]?b.push(A):"plugin"==c[d]&&b.push(x);return b.push(F),b}function D(a){var b=["extension","webmidi","plugin"];if(!a||!a.engine)return b;for(var c,d,e=a.engine instanceof Array?a.engine:[a.engine],f={},g=[],i=[],j=0;j<e.length;j++){var k=e[j].toString().toLowerCase();f[k]||(f[k]=!0,"none"===k&&(c=!0),"etc"===k&&(d=!0),d?i.push(k):g.push(k),h(b,k))}return(d||g.length||i.length)&&(c=!1),c?[]:g.concat(d?b:i)}function E(a){aa=new i,aa._options=a,aa._push(f,[C(a)]),aa.refresh(),aa._push(j,[]),aa._push(function(){$.length||_.length||this._break()},[]),aa._resume()}function F(){ba._type="none",ba._sysex=!0,ba._refresh=function(){ba._outs=[],ba._ins=[]}}function G(){ba._inArr=[],ba._outArr=[],ba._inMap={},ba._outMap={},ba._version=ba._main.version,ba._sysex=!0,ba._refresh=function(){ba._outs=[],ba._ins=[];var a,b;for(a=0;(b=ba._main.MidiOutInfo(a)).length;a++)ba._outs.push({type:ba._type,name:b[0],manufacturer:b[1],version:b[2]});for(a=0;(b=ba._main.MidiInInfo(a)).length;a++)ba._ins.push({type:ba._type,name:b[0],manufacturer:b[1],version:b[2]})},ba._openOut=function(a,b){var c=ba._outMap[b];if(!c){ba._pool.length<=ba._outArr.length&&ba._pool.push(ba._newPlugin()),c={name:b,clients:[],info:{name:b,manufacturer:ba._allOuts[b].manufacturer,version:ba._allOuts[b].version,type:"MIDI-out",sysex:ba._sysex,engine:ba._type},_close:function(a){ba._closeOut(a)},_receive:function(a){this.plugin.MidiOutRaw(a.slice())}};var d=ba._pool[ba._outArr.length];c.plugin=d,ba._outArr.push(c),ba._outMap[b]=c}if(!c.open){var e=c.plugin.MidiOutOpen(b);if(e!==b)return e&&c.plugin.MidiOutClose(),void a._break();c.open=!0}a._orig._impl=c,g(c.clients,a._orig),a._info=c.info,a._receive=function(a){c._receive(a)},a._close=function(){c._close(this)}},ba._openIn=function(a,b){function c(a){return function(b,c){a.handle(b,c)}}var d=ba._inMap[b];if(!d){ba._pool.length<=ba._inArr.length&&ba._pool.push(ba._newPlugin()),d={name:b,clients:[],info:{name:b,manufacturer:ba._allIns[b].manufacturer,version:ba._allIns[b].version,type:"MIDI-in",sysex:ba._sysex,engine:ba._type},_close:function(a){ba._closeIn(a)},handle:function(a,b){for(var c=0;c<this.clients.length;c++){var d=R(b);this.clients[c]._emit(d)}}},d.onmidi=c(d);var e=ba._pool[ba._inArr.length];d.plugin=e,ba._inArr.push(d),ba._inMap[b]=d}if(!d.open){var f=d.plugin.MidiInOpen(b,d.onmidi);if(f!==b)return f&&d.plugin.MidiInClose(),void a._break();d.open=!0}a._orig._impl=d,g(d.clients,a._orig),a._info=d.info,a._close=function(){d._close(this)}},ba._closeOut=function(a){var b=a._impl;h(b.clients,a._orig),b.clients.length||(b.open=!1,b.plugin.MidiOutClose())},ba._closeIn=function(a){var b=a._impl;h(b.clients,a._orig),b.clients.length||(b.open=!1,b.plugin.MidiInClose())},ba._close=function(){for(var a=0;a<ba._inArr.length;a++)ba._inArr[a].open&&ba._inArr[a].plugin.MidiInClose()},i.prototype._time=function(){return ba._main.Time()}}function H(a){ba._type="node",ba._main=a,ba._pool=[],ba._newPlugin=function(){return new a.MIDI},G()}function I(a){ba._type="plugin",ba._main=a,ba._pool=[a],ba._newPlugin=function(){var b=document.createElement("object");return b.style.visibility="hidden",b.style.width="0px",a.style.height="0px",b.classid="CLSID:1ACE1618-1C7D-4561-AEE1-34842AA85E90",b.type="audio/x-jazz",document.body.appendChild(b),b.isJazz?b:void 0},G()}function J(a,b){ba._type="webmidi",ba._version=43,ba._sysex=!!b,ba._access=a,ba._inMap={},ba._outMap={},ba._refresh=function(){ba._outs=[],ba._ins=[],ba._access.outputs.forEach(function(a,b){ba._outs.push({type:ba._type,name:a.name,manufacturer:a.manufacturer,version:a.version})}),ba._access.inputs.forEach(function(a,b){ba._ins.push({type:ba._type,name:a.name,manufacturer:a.manufacturer,version:a.version})})},ba._openOut=function(a,b){var c=ba._outMap[b];if(!c){c={name:b,clients:[],info:{name:b,manufacturer:ba._allOuts[b].manufacturer,version:ba._allOuts[b].version,type:"MIDI-out",sysex:ba._sysex,engine:ba._type},_close:function(a){ba._closeOut(a)},_receive:function(a){this.dev.send(a.slice())}};ba._access.outputs.forEach(function(a,d){a.name===b&&(c.dev=a)}),c.dev?ba._outMap[b]=c:c=void 0}c?(c.dev.open&&c.dev.open(),a._orig._impl=c,g(c.clients,a._orig),a._info=c.info,a._receive=function(a){c._receive(a)},a._close=function(){c._close(this)}):a._break()},ba._openIn=function(a,b){function c(a){return function(b){a.handle(b)}}var d=ba._inMap[b];if(!d){d={name:b,clients:[],info:{name:b,manufacturer:ba._allIns[b].manufacturer,version:ba._allIns[b].version,type:"MIDI-in",sysex:ba._sysex,engine:ba._type},_close:function(a){ba._closeIn(a)},handle:function(a){for(var b=0;b<this.clients.length;b++){var c=R([].slice.call(a.data));this.clients[b]._emit(c)}}};ba._access.inputs.forEach(function(a,c){a.name===b&&(d.dev=a)}),d.dev?(d.dev.onmidimessage=c(d),ba._inMap[b]=d):d=void 0}d?(d.dev.open&&d.dev.open(),a._orig._impl=d,g(d.clients,a._orig),a._info=d.info,a._close=function(){d._close(this)}):a._break()},ba._closeOut=function(a){var b=a._impl;b.clients.length||b.dev.close&&b.dev.close(),h(b.clients,a._orig)},ba._closeIn=function(a){var b=a._impl;h(b.clients,a._orig),b.clients.length||b.dev.close&&b.dev.close()},ba._close=function(){}}function K(a,b){ba._type="extension",ba._version=b,ba._sysex=!0,ba._pool=[],ba._inArr=[],ba._outArr=[],ba._inMap={},ba._outMap={},ba._msg=a,ba._newPlugin=function(){var a={id:ba._pool.length};a.id?document.dispatchEvent(new CustomEvent("jazz-midi",{detail:["new"]})):a.ready=!0,ba._pool.push(a)},ba._newPlugin(),ba._refresh=function(){ba._outs=[],ba._ins=[],aa._pause(),document.dispatchEvent(new CustomEvent("jazz-midi",{detail:["refresh"]}))},ba._openOut=function(a,b){var c=ba._outMap[b];if(!c){ba._pool.length<=ba._outArr.length&&ba._newPlugin();var d=ba._pool[ba._outArr.length];c={name:b,clients:[],info:{name:b,manufacturer:ba._allOuts[b].manufacturer,version:ba._allOuts[b].version,type:"MIDI-out",sysex:ba._sysex,engine:ba._type},_start:function(){document.dispatchEvent(new CustomEvent("jazz-midi",{detail:["openout",d.id,b]}))},_close:function(a){ba._closeOut(a)},_receive:function(a){var b=a.slice();b.splice(0,0,"play",d.id),document.dispatchEvent(new CustomEvent("jazz-midi",{detail:b}))}},c.plugin=d,d.output=c,ba._outArr.push(c),ba._outMap[b]=c}a._orig._impl=c,g(c.clients,a._orig),a._info=c.info,a._receive=function(a){c._receive(a)},a._close=function(){c._close(this)},c.open||(c.plugin.ready&&c._start(),a._pause())},ba._openIn=function(a,b){var c=ba._inMap[b];if(!c){ba._pool.length<=ba._inArr.length&&ba._newPlugin();var d=ba._pool[ba._inArr.length];c={name:b,clients:[],info:{name:b,manufacturer:ba._allIns[b].manufacturer,version:ba._allIns[b].version,type:"MIDI-in",sysex:ba._sysex,engine:ba._type},_start:function(){document.dispatchEvent(new CustomEvent("jazz-midi",{detail:["openin",d.id,b]}))},_close:function(a){ba._closeIn(a)}},c.plugin=d,d.input=c,ba._inArr.push(c),ba._inMap[b]=c}a._orig._impl=c,g(c.clients,a._orig),a._info=c.info,a._close=function(){c._close(this)},c.open||(c.plugin.ready&&c._start(),a._pause())},ba._closeOut=function(a){var b=a._impl;h(b.clients,a._orig),b.clients.length||(b.open=!1,document.dispatchEvent(new CustomEvent("jazz-midi",{detail:["closeout",b.plugin.id]})))},ba._closeIn=function(a){var b=a._impl;h(b.clients,a._orig),b.clients.length||(b.open=!1,document.dispatchEvent(new CustomEvent("jazz-midi",{detail:["closein",b.plugin.id]})))},ba._close=function(){},document.addEventListener("jazz-midi-msg",function(a){var b=ba._msg.innerText.split("\n");ba._msg.innerText="";for(var c=0;c<b.length;c++){var d=[];try{d=JSON.parse(b[c])}catch(a){}if(d.length)if("refresh"===d[0]){if(d[1].ins){for(var e=0;c<d[1].ins;c++)d[1].ins[e].type=ba._type;ba._ins=d[1].ins}if(d[1].outs){for(var e=0;c<d[1].outs;c++)d[1].outs[e].type=ba._type;ba._outs=d[1].outs}aa._resume()}else if("version"===d[0]){var f=ba._pool[d[1]];f&&(f.ready=!0,f.input&&f.input._start(),f.output&&f.output._start())}else if("openout"===d[0]){var g=ba._pool[d[1]].output;if(g)if(d[2]==g.name){if(g.open=!0,g.clients)for(var c=0;c<g.clients.length;c++)g.clients[c]._resume()}else if(g.clients)for(var c=0;c<g.clients.length;c++)g.clients[c]._crash()}else if("openin"===d[0]){var g=ba._pool[d[1]].input;if(g)if(d[2]==g.name){if(g.open=!0,g.clients)for(var c=0;c<g.clients.length;c++)g.clients[c]._resume()}else if(g.clients)for(var c=0;c<g.clients.length;c++)g.clients[c]._crash()}else if("midi"===d[0]){var g=ba._pool[d[1]].input;if(g&&g.clients)for(var c=0;c<g.clients.length;c++){var h=R(d.slice(3));g.clients[c]._emit(h)}}}})}function L(){var a=this instanceof L?this:a=new L;return L.prototype.reset.apply(a,arguments),a}function M(){29.97==this.type&&!this.second&&this.frame<2&&this.minute%10&&(this.frame=2)}function N(a){return[[24,25,29.97,30][a[7]>>1&3],(1&a[7])<<4|a[6],a[5]<<4|a[4],a[3]<<4|a[2],a[1]<<4|a[0]]}function O(a){!a.backwards&&a.quarter>=4?a.decrFrame():a.backwards&&a.quarter<4&&a.incrFrame();var b;switch(a.quarter>>1){case 0:b=a.frame;break;case 1:b=a.second;break;case 2:b=a.minute;break;default:b=a.hour}return 1&a.quarter?b>>=4:b&=15,7==a.quarter&&(25==a.type?b|=2:29.97==a.type?b|=4:30==a.type&&(b|=6)),!a.backwards&&a.quarter>=4?a.incrFrame():a.backwards&&a.quarter<4&&a.decrFrame(),b|a.quarter<<4}function P(a){return 25==a.type?32|a.hour:29.97==a.type?64|a.hour:30==a.type?96|a.hour:a.hour}function Q(a){return 10>a?"0"+a:a}function R(a){var b=this instanceof R?this:b=new R;if(b._from=a instanceof R?a._from.slice():[],!arguments.length)return b;for(var c=a instanceof Array?a:arguments,d=0;d<c.length;d++){var e=c[d];1==d&&b[0]>=128&&b[0]<=175&&(e=R.noteValue(e)),(e!=parseInt(e)||0>e||e>255)&&S(c[d]),b.push(e)}return b}function S(a){throw RangeError("Bad MIDI value: "+a)}function T(a){return(a!=parseInt(a)||0>a||a>15)&&S(a),a}function U(a){return(a!=parseInt(a)||0>a||a>127)&&S(a),a}function V(a){return(a!=parseInt(a)||0>a||a>16383)&&S(a),127&a}function W(a){return(a!=parseInt(a)||0>a||a>16383)&&S(a),a>>7}function X(a,b){R[a]=function(){return new R(b.apply(0,arguments))},r.prototype[a]=function(){return this.send(b.apply(0,arguments)),this}}function Y(a){for(var b=[],c=0;c<a.length;c++)b[c]=(a[c]<16?"0":"")+a[c].toString(16);return b.join(" ")}var Z="0.4.0";a.prototype._exec=function(){for(;this._ready&&this._queue.length;){var a=this._queue.shift();this._orig._bad?this._orig._hope&&a[0]==d?(this._orig._hope=!1,a[0].apply(this,a[1])):(this._queue=[],this._orig._hope=!1):a[0]!=d&&a[0].apply(this,a[1])}},a.prototype._push=function(b,c){this._queue.push([b,c]),a.prototype._exec.apply(this)},a.prototype._slip=function(a,b){this._queue.unshift([a,b])},a.prototype._pause=function(){this._ready=!1},a.prototype._resume=function(){this._ready=!0,a.prototype._exec.apply(this)},a.prototype._break=function(a){this._orig._bad=!0,this._orig._hope=!0,a&&this._orig._err.push(a)},a.prototype._repair=function(){this._orig._bad=!1},a.prototype._crash=function(a){this._break(a),this._resume()},a.prototype.err=function(){return k(this._err)},a.prototype.wait=function(a){function c(){}if(!a)return this;c.prototype=this._orig;var d=new c;return d._ready=!1,d._queue=[],this._push(b,[d,a]),d},a.prototype.and=function(a){return this._push(c,[a]),this},a.prototype.or=function(a){return this._push(d,[a]),this},a.prototype._info={},a.prototype.info=function(){var a=k(this._orig._info);return"undefined"==typeof a.engine&&(a.engine="none"),"undefined"==typeof a.sysex&&(a.sysex=!0),a},a.prototype.name=function(){return this.info().name},a.prototype.close=function(){var b=new a;return this._close&&this._push(this._close,[]),this._push(e,[b]),b},i.prototype=new a,i.prototype.time=function(){return 0},"undefined"!=typeof performance&&performance.now&&(i.prototype._time=function(){return performance.now()}),i.prototype._info={name:"JZZ.js",ver:Z,version:Z};var $=[],_=[];i.prototype.refresh=function(){return this._push(m,[]),this},i.prototype.openMidiOut=function(a){var b=new r;return this._push(m,[]),this._push(p,[b,a]),b},i.prototype.openMidiIn=function(a){var b=new r;return this._push(m,[]),this._push(q,[b,a]),b},i.prototype._close=function(){ba._close()},r.prototype=new a,r.prototype._receive=function(a){this._emit(a)},r.prototype.send=function(){return this._push(s,[R.apply(null,arguments)]),this},r.prototype.note=function(a,b,c,d){return this.noteOn(a,b,c),d&&this.wait(d).noteOff(a,b),this},r.prototype._emit=function(a){for(var b=0;b<this._handles.length;b++)this._handles[b].apply(this,[R(a)._stamp(this)]);for(var b=0;b<this._outs.length;b++){var c=R(a);c._stamped(this._outs[b])||this._outs[b].send(c._stamp(this))}},r.prototype.emit=function(a){return this._push(t,[a]),this},r.prototype.connect=function(a){return this._push(u,[a]),this},r.prototype.disconnect=function(a){return this._push(v,[a]),this};var aa,ba={},ca={_outs:[],_ins:[]};JZZ=function(a){return aa||E(a),aa},JZZ.info=function(){return i.prototype.info()},JZZ.createNew=function(a){var b=new r;if(a instanceof Object)for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b._resume(),b},i.prototype.createNew=JZZ.createNew,L.prototype.reset=function(a){if(a instanceof L)return this.setType(a.getType()),this.setHour(a.getHour()),this.setMinute(a.getMinute()),this.setSecond(a.getSecond()),this.setFrame(a.getFrame()),this.setQuarter(a.getQuarter()),this;var b=a instanceof Array?a:arguments;return this.setType(b[0]),this.setHour(b[1]),this.setMinute(b[2]),this.setSecond(b[3]),this.setFrame(b[4]),this.setQuarter(b[5]),this},L.prototype.isFullFrame=function(){return 0==this.quarter||4==this.quarter},L.prototype.getType=function(){return this.type},L.prototype.getHour=function(){return this.hour},L.prototype.getMinute=function(){return this.minute},L.prototype.getSecond=function(){return this.second},L.prototype.getFrame=function(){return this.frame},L.prototype.getQuarter=function(){return this.quarter},L.prototype.setType=function(a){if("undefined"==typeof a||24==a)this.type=24;else if(25==a)this.type=25;else if(29.97==a)this.type=29.97,M.apply(this);else{if(30!=a)throw RangeError("Bad SMPTE frame rate: "+a);this.type=30}return this.frame>=this.type&&(this.frame=29.97==this.type?29:this.type-1),this},L.prototype.setHour=function(a){if("undefined"==typeof a&&(a=0),a!=parseInt(a)||0>a||a>=24)throw RangeError("Bad SMPTE hours value: "+a);return this.hour=a,this},L.prototype.setMinute=function(a){if("undefined"==typeof a&&(a=0),a!=parseInt(a)||0>a||a>=60)throw RangeError("Bad SMPTE minutes value: "+a);return this.minute=a,M.apply(this),this},L.prototype.setSecond=function(a){if("undefined"==typeof a&&(a=0),a!=parseInt(a)||0>a||a>=60)throw RangeError("Bad SMPTE seconds value: "+a);return this.second=a,M.apply(this),this},L.prototype.setFrame=function(a){if("undefined"==typeof a&&(a=0),a!=parseInt(a)||0>a||a>=this.type)throw RangeError("Bad SMPTE frame number: "+a);return this.frame=a,M.apply(this),this},L.prototype.setQuarter=function(a){if("undefined"==typeof a&&(a=0),a!=parseInt(a)||0>a||a>=8)throw RangeError("Bad SMPTE quarter frame: "+a);return this.quarter=a,this},L.prototype.incrFrame=function(){return this.frame++,this.frame>=this.type&&(this.frame=0,this.second++,this.second>=60&&(this.second=0,this.minute++,this.minute>=60&&(this.minute=0,this.hour=this.hour>=23?0:this.hour+1))),M.apply(this),this},L.prototype.decrFrame=function(){return!this.second&&2==this.frame&&29.97==this.type&&this.minute%10&&(this.frame=0),this.frame--,this.frame<0&&(this.frame=29.97==this.type?29:this.type-1,this.second--,this.second<0&&(this.second=59,this.minute--,this.minute<0&&(this.minute=59,this.hour=this.hour?this.hour-1:23))),this},L.prototype.incrQF=function(){return this.backwards=!1,this.quarter=this.quarter+1&7,0!=this.quarter&&4!=this.quarter||this.incrFrame(),this},L.prototype.decrQF=function(){return this.backwards=!0,this.quarter=this.quarter+7&7,3!=this.quarter&&7!=this.quarter||this.decrFrame(),this},L.prototype.read=function(a){if(a instanceof R||(a=R.apply(null,arguments)),240==a[0]&&127==a[1]&&1==a[3]&&1==a[4]&&247==a[9])return this.type=[24,25,29.97,30][a[5]>>5&3],this.hour=31&a[5],this.minute=a[6],this.second=a[7],this.frame=a[8],this.quarter=0,this._=void 0,this._b=void 0,this._f=void 0,!0;if(241==a[0]&&"undefined"!=typeof a[1]){var b=a[1]>>4,c=15&a[1];return 0==b?7==this._&&(7==this._f&&(this.reset(N(this._a)),this.incrFrame()),this.incrFrame()):3==b?4==this._&&this.decrFrame():4==b?3==this._&&this.incrFrame():7==b&&0===this._&&(0===this._b&&(this.reset(N(this._a)),this.decrFrame()),this.decrFrame()),this._a||(this._a=[]),this._a[b]=c,this._f=this._f===b-1||0==b?b:void 0,this._b=this._b===b+1||7==b?b:void 0,this._=b,this.quarter=b,!0}return!1},L.prototype.toString=function(){return[Q(this.hour),Q(this.minute),Q(this.second),Q(this.frame)].join(":")},JZZ.SMPTE=L,R.prototype=[],R.prototype.constructor=R;var da={};R.noteValue=function(a){return da[a.toString().toLowerCase()]};var ea={c:0,d:2,e:4,f:5,g:7,a:9,b:11,h:11};for(var fa in ea)if(ea.hasOwnProperty(fa))for(var ga=0;12>ga;ga++){var ha=ea[fa]+12*ga;if(ha>127)break;da[fa+ga]=ha,ha>0&&(da[fa+"b"+ga]=ha-1,da[fa+"bb"+ga]=ha-2),127>ha&&(da[fa+"#"+ga]=ha+1,da[fa+"##"+ga]=ha+2)}for(var ga=0;128>ga;ga++)da[ga]=ga;var ia={noteOff:function(a,b){return[128+T(a),U(R.noteValue(b)),0]},noteOn:function(a,b,c){return[144+T(a),U(R.noteValue(b)),U(c)]},aftertouch:function(a,b,c){return[160+T(a),U(R.noteValue(b)),U(c)]},control:function(a,b,c){return[176+T(a),U(b),U(c)]},program:function(a,b){return[192+T(a),U(b)]},pressure:function(a,b){return[208+T(a),U(b)]},pitchBend:function(a,b){return[224+T(a),V(b),W(b)]},bankMSB:function(a,b){return[176+T(a),0,U(b)]},bankLSB:function(a,b){return[176+T(a),32,U(b)]},modMSB:function(a,b){return[176+T(a),1,U(b)]},modLSB:function(a,b){return[176+T(a),33,U(b)]},breathMSB:function(a,b){return[176+T(a),2,U(b)]},breathLSB:function(a,b){return[176+T(a),34,U(b)]},footMSB:function(a,b){return[176+T(a),4,U(b)]},footLSB:function(a,b){return[176+T(a),36,U(b)]},portamentoMSB:function(a,b){return[176+T(a),5,U(b)]},portamentoLSB:function(a,b){return[176+T(a),37,U(b)]},volumeMSB:function(a,b){return[176+T(a),7,U(b)]},volumeLSB:function(a,b){return[176+T(a),39,U(b)]},balanceMSB:function(a,b){return[176+T(a),8,U(b)]},balanceLSB:function(a,b){return[176+T(a),40,U(b)]},panMSB:function(a,b){return[176+T(a),10,U(b)]},panLSB:function(a,b){return[176+T(a),42,U(b)]},expressionMSB:function(a,b){return[176+T(a),11,U(b)]},expressionLSB:function(a,b){return[176+T(a),43,U(b)]},damper:function(a,b){return[176+T(a),64,b?127:0]},portamento:function(a,b){return[176+T(a),65,b?127:0]},sostenuto:function(a,b){return[176+T(a),66,b?127:0]},soft:function(a,b){return[176+T(a),67,b?127:0]},allSoundOff:function(a){return[176+T(a),120,0]},allNotesOff:function(a){return[176+T(a),123,0]},mtc:function(a){return[241,O(a)]},songPosition:function(a){return[242,V(a),W(a)]},songSelect:function(a){return[243,U(a)]},tune:function(){return[246]},clock:function(){return[248]},start:function(){return[250]},"continue":function(){return[251]},stop:function(){return[252]},active:function(){return[254]},sxIdRequest:function(){return[240,126,127,6,1,247]},sxFullFrame:function(a){return[240,127,127,1,1,P(a),a.getMinute(),a.getSecond(),a.getFrame(),247]},reset:function(){return[255]}};for(var fa in ia)ia.hasOwnProperty(fa)&&X(fa,ia[fa]);for(var ja={a:10,b:11,c:12,d:13,e:14,f:15,A:10,B:11,C:12,D:13,E:14,F:15},fa=0;16>fa;fa++)ja[fa]=fa;R.prototype.getChannel=function(){var a=this[0];if(!("undefined"==typeof a||128>a||a>239))return 15&a},R.prototype.setChannel=function(a){var b=this[0];return"undefined"==typeof b||128>b||b>239?this:(a=ja[a],"undefined"!=typeof a&&(this[0]=240&b|a),this)},R.prototype.getNote=function(){var a=this[0];if(!("undefined"==typeof a||128>a||a>175))return this[1]},R.prototype.setNote=function(a){var b=this[0];return"undefined"==typeof b||128>b||b>175?this:(a=R.noteValue(a),"undefined"!=typeof a&&(this[1]=a),this)},R.prototype.getVelocity=function(){var a=this[0];if(!("undefined"==typeof a||144>a||a>159))return this[2]},R.prototype.setVelocity=function(a){var b=this[0];return"undefined"==typeof b||144>b||b>159?this:(a=parseInt(a),a>=0&&128>a&&(this[2]=a),this)},R.prototype.getSysExChannel=function(){return 240==this[0]?this[2]:void 0},R.prototype.setSysExChannel=function(a){return 240==this[0]&&this.length>2&&(a=parseInt(a),a>=0&&128>a&&(this[2]=a)),this},R.prototype.isNoteOn=function(){var a=this[0];return"undefined"==typeof a||144>a||a>159?!1:this[2]>0},R.prototype.isNoteOff=function(){var a=this[0];return"undefined"==typeof a||128>a||a>159?!1:144>a?!0:0==this[2]},R.prototype.isSysEx=function(){return 240==this[0]},R.prototype.isFullSysEx=function(){return 240==this[0]&&247==this[this.length-1]},R.prototype.toString=function(){if(!this.length)return"empty";var a=Y(this);if(this[0]<128)return a;var b={241:"MIDI Time Code",242:"Song Position",243:"Song Select",244:"Undefined",245:"Undefined",246:"Tune request",248:"Timing clock",249:"Undefined",250:"Start",251:"Continue",252:"Stop",253:"Undefined",254:"Active Sensing",255:"Reset"}[this[0]];if(b)return a+" -- "+b;var c=this[0]>>4;return(b={8:"Note Off",10:"Aftertouch",12:"Program Change",13:"Channel Aftertouch",14:"Pitch Wheel"}[c])?a+" -- "+b:9==c?a+" -- "+(this[2]?"Note On":"Note Off"):11!=c?a:(b={0:"Bank Select MSB",1:"Modulation Wheel MSB",2:"Breath Controller MSB",4:"Foot Controller MSB",5:"Portamento Time MSB",6:"Data Entry MSB",7:"Channel Volume MSB",8:"Balance MSB",10:"Pan MSB",11:"Expression Controller MSB",12:"Effect Control 1 MSB",13:"Effect Control 2 MSB",16:"General Purpose Controller 1 MSB",17:"General Purpose Controller 2 MSB",18:"General Purpose Controller 3 MSB",19:"General Purpose Controller 4 MSB",32:"Bank Select LSB",33:"Modulation Wheel LSB",34:"Breath Controller LSB",36:"Foot Controller LSB",37:"Portamento Time LSB",38:"Data Entry LSB",39:"Channel Volume LSB",40:"Balance LSB",42:"Pan LSB",43:"Expression Controller LSB",44:"Effect control 1 LSB",45:"Effect control 2 LSB",48:"General Purpose Controller 1 LSB",49:"General Purpose Controller 2 LSB",50:"General Purpose Controller 3 LSB",51:"General Purpose Controller 4 LSB",64:"Damper Pedal On/Off",65:"Portamento On/Off",66:"Sostenuto On/Off",67:"Soft Pedal On/Off",68:"Legato Footswitch",69:"Hold 2",70:"Sound Controller 1",71:"Sound Controller 2",72:"Sound Controller 3",73:"Sound Controller 4",74:"Sound Controller 5",75:"Sound Controller 6",76:"Sound Controller 7",77:"Sound Controller 8",78:"Sound Controller 9",79:"Sound Controller 10",80:"General Purpose Controller 5",81:"General Purpose Controller 6",82:"General Purpose Controller 7",83:"General Purpose Controller 8",84:"Portamento Control",88:"High Resolution Velocity Prefix",91:"Effects 1 Depth",92:"Effects 2 Depth",93:"Effects 3 Depth",94:"Effects 4 Depth",95:"Effects 5 Depth",96:"Data Increment",97:"Data Decrement",98:"Non-Registered Parameter Number LSB",99:"Non-Registered Parameter Number MSB",100:"Registered Parameter Number LSB",101:"Registered Parameter Number MSB",120:"All Sound Off",121:"Reset All Controllers",122:"Local Control On/Off",123:"All Notes Off",124:"Omni Mode Off",125:"Omni Mode On",126:"Mono Mode On",127:"Poly Mode On"}[this[1]],b||(b="Undefined"),a+" -- "+b)},R.prototype._stamp=function(a){return this._from.push(a._orig?a._orig:a),this},R.prototype._unstamp=function(a){if("undefined"==typeof a)this._from=[];else{a._orig&&(a=a._orig);var b=this._from.indexOf(a);b>-1&&this._from.splice(b,1)}return this},R.prototype._stamped=function(a){a._orig&&(a=a._orig);for(var b=0;b<this._from.length;b++)if(this._from[b]==a)return!0;return!1},JZZ.MIDI=R,JZZ.lib={},JZZ.lib.openMidiOut=function(a,b){var c=new r;return b._openOut(c,a),c},JZZ.lib.openMidiIn=function(a,b){var c=new r;return b._openIn(c,a),c},JZZ.lib.registerMidiOut=function(a,b){for(var c=b._info(a),d=0;d<ca._outs.length;d++)if(ca._outs[d].name==c.name)return!1;return c.engine=b,ca._outs.push(c),aa&&aa._bad&&(aa._repair(),aa._resume()),!0},JZZ.lib.registerMidiIn=function(a,b){for(var c=b._info(a),d=0;d<ca._ins.length;d++)if(ca._ins[d].name==c.name)return!1;return c.engine=b,ca._ins.push(c),aa&&aa._bad&&(aa._repair(),aa._resume()),!0},JZZ.util={},JZZ.util.iosSound=function(){if(JZZ.util.iosSound=function(){},window){var a=window.AudioContext||window.webkitAudioContext;if(a){var b=new a;b.createGain||(b.createGain=b.createGainNode);var c=b.createOscillator(),d=b.createGain();d.gain.value=0,c.connect(d),d.connect(b.destination),c.start||(c.start=c.noteOn),c.stop||(c.stop=c.noteOff),c.start(0),c.stop(1)}}}}();